<html><head><link rel="import" href="../../polymer-element.html"><link rel="import" href="../utils/mixin.html"><link rel="import" href="../utils/array-splice.html"><script>(function(){'use strict';var a=Polymer.dedupingMixin(function(a){var b=Polymer.ElementMixin(a),c=function(a){function b(){babelHelpers.classCallCheck(this,b);var a=babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a.__lastItems=null,a.__lastMulti=null,a.__selectedMap=null,a}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,null,[{key:'properties',get:function(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}},{key:'observers',get:function(){return['__updateSelection(multi, items.*)']}}]),babelHelpers.createClass(b,[{key:'__updateSelection',value:function(a,b){var c=b.path;if('items'==c){var d=b.base||[],e=this.__lastItems,f=this.__lastMulti;if(a!==f&&this.clearSelection(),e){var g=Polymer.ArraySplice.calculateSplices(d,e);this.__applySplices(g)}this.__lastItems=d,this.__lastMulti=a}else if('items.splices'==b.path)this.__applySplices(b.value.indexSplices);else{var h=c.slice(6),i=parseInt(h,10);0>h.indexOf('.')&&h==i&&this.__deselectChangedIdx(i)}}},{key:'__applySplices',value:function(a){for(var b=this,c=this.__selectedMap,d=function(d){var e=a[d];c.forEach(function(a,b){a<e.index||(a>=e.index+e.removed.length?c.set(b,a+e.addedCount-e.removed.length):c.set(b,-1))});for(var f,g=0;g<e.addedCount;g++)f=e.index+g,c.has(b.items[f])&&c.set(b.items[f],f)},e=0;e<a.length;e++)d(e);this.__updateLinks();var f=0;c.forEach(function(a,d){0>a?(b.multi?b.splice('selected',f,1):b.selected=b.selectedItem=null,c.delete(d)):f++})}},{key:'__updateLinks',value:function(){var a=this;if(this.__dataLinkedPaths={},this.multi){var b=0;this.__selectedMap.forEach(function(c){0<=c&&a.linkPaths('items.'+c,'selected.'+b++)})}else this.__selectedMap.forEach(function(b){a.linkPaths('selected','items.'+b),a.linkPaths('selectedItem','items.'+b)})}},{key:'clearSelection',value:function(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}},{key:'isSelected',value:function(a){return this.__selectedMap.has(a)}},{key:'isIndexSelected',value:function(a){return this.isSelected(this.items[a])}},{key:'__deselectChangedIdx',value:function(a){var b=this,c=this.__selectedIndexForItemIndex(a);if(0<=c){var d=0;this.__selectedMap.forEach(function(a,e){c==d++&&b.deselect(e)})}}},{key:'__selectedIndexForItemIndex',value:function(a){var b=this.__dataLinkedPaths['items.'+a];if(b)return parseInt(b.slice(9),10)}},{key:'deselect',value:function(a){var b=this.__selectedMap.get(a);if(0<=b){this.__selectedMap.delete(a);var c;this.multi&&(c=this.__selectedIndexForItemIndex(b)),this.__updateLinks(),this.multi?this.splice('selected',c,1):this.selected=this.selectedItem=null}}},{key:'deselectIndex',value:function(a){this.deselect(this.items[a])}},{key:'select',value:function(a){this.selectIndex(this.items.indexOf(a))}},{key:'selectIndex',value:function(a){var b=this.items[a];this.isSelected(b)?this.toggle&&this.deselectIndex(a):(!this.multi&&this.__selectedMap.clear(),this.__selectedMap.set(b,a),this.__updateLinks(),this.multi?this.push('selected',b):this.selected=this.selectedItem=b)}}]),b}(b);return c});Polymer.ArraySelectorMixin=a;var b=a(Polymer.Element),c=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,null,[{key:'is',get:function(){return'array-selector'}}]),b}(b);customElements.define(c.is,c),Polymer.ArraySelector=c})();</script></head><body></body></html>