(function(e,t){'object'===typeof exports&&'undefined'!==typeof module?t(exports):'function'===typeof define&&define.amd?define(['exports'],t):t(e.vega=e.vega||{})})(this,function(e){'use strict';function t(e){var t=e.maxbins||20,a=e.base||10,d=av(a),r=e.divide||[5,2],o=e.extent[0],l=e.extent[1],s=l-o,f,c,p,u,g,h,i,n;if(e.step)f=e.step;else if(e.steps){for(g=s/t,h=0,i=e.steps.length;h<i&&e.steps[h]<g;++h);f=e.steps[nv(0,h-1)]}else{for(c=tv(av(t)/d),p=e.minstep||0,f=nv(p,Qx(a,ev(av(s)/d)-c));tv(s/f)>t;)f*=a;for(h=0,i=r.length;h<i;++h)g=f/r[h],g>=p&&s/g<=t&&(f=g)}return g=av(f),u=0<=g?0:~~(-g/d)+1,n=Qx(a,-u-1),(e.nice||void 0===e.nice)&&(o=Zx(o,Kx(o/f+n)*f),l=tv(l/f)*f),{start:o,stop:l,step:f}}function d(e,t){var d=[],o=e.length,n=-1,i;if(null==t)for(;++n<o;)isNaN(i=r(e[n]))||d.push(i);else for(;++n<o;)isNaN(i=r(t(e[n],n,e)))||d.push(i);return d}function r(e){return null===e?NaN:+e}function o(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function n(e){return 1===e.length&&(e=a(e)),{left:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0>e(t[d],n)?a=d+1:i=d}return a},right:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0<e(t[d],n)?i=d:a=d+1}return a}}}function a(e){return function(t,n){return o(e(t),n)}}function l(e){return null===e?NaN:+e}function i(e,t){var a=e.length,n=0,d=-1,i=0,r=0,o,s;if(null==t)for(;++d<a;)isNaN(o=l(e[d]))||(s=o-i,i+=s/++n,r+=s*(o-i));else for(;++d<a;)isNaN(o=l(t(e[d],d,e)))||(s=o-i,i+=s/++n,r+=s*(o-i));return 1<n?r/(n-1):void 0}function s(e,t){var a=e.length,n=-1,i,d,r;if(null==t){for(;++n<a;)if(null!=(i=e[n])&&i>=i)for(d=r=i;++n<a;)null!=(i=e[n])&&(d>i&&(d=i),r<i&&(r=i));}else for(;++n<a;)if(null!=(i=t(e[n],n,e))&&i>=i)for(d=r=i;++n<a;)null!=(i=t(e[n],n,e))&&(d>i&&(d=i),r<i&&(r=i));return[d,r]}function f(e,t,a){e=+e,t=+t,a=2>(i=arguments.length)?(t=e,e=0,1):3>i?1:+a;for(var d=-1,i=0|nv(0,tv((t-e)/a)),n=Array(i);++d<i;)n[d]=e+d*a;return n}function c(e,t,a){var d=t<e,r=-1,i,n,o;if(d&&(i=e,e=t,t=i),0===(o=p(e,t,a))||!isFinite(o))return[];if(0<o)for(e=tv(e/o),t=Kx(t/o),n=Array(i=tv(t-e+1));++r<i;)n[r]=(e+r)*o;else for(e=Kx(e*o),t=tv(t*o),n=Array(i=tv(e-t+1));++r<i;)n[r]=(e-r)/o;return d&&n.reverse(),n}function p(e,t,n){var a=(t-e)/nv(0,n),i=Kx(av(a)/Jx),d=a/Qx(10,i);return 0<=i?(d>=ov?10:d>=lv?5:d>=sv?2:1)*Qx(10,i):-Qx(10,-i)/(d>=ov?10:d>=lv?5:d>=sv?2:1)}function u(e,t,n){var a=Vx(t-e)/nv(0,n),i=Qx(10,Kx(av(a)/Jx)),d=a/i;return d>=ov?i*=10:d>=lv?i*=5:d>=sv&&(i*=2),t<e?-i:i}function g(e){return tv(av(e.length)/Xx)+1}function h(e,t,a){if(null==a&&(a=l),!!(s=e.length)){if(0>=(t=+t)||2>s)return+a(e[0],0,e);if(1<=t)return+a(e[s-1],s-1,e);var d=(s-1)*t,i=Kx(d),r=+a(e[i],i,e),o=+a(e[i+1],i+1,e),s;return r+(o-r)*(d-i)}}function m(e,t){var a=e.length,n=-1,i,d;if(null==t){for(;++n<a;)if(null!=(i=e[n])&&i>=i)for(d=i;++n<a;)null!=(i=e[n])&&i>d&&(d=i);}else for(;++n<a;)if(null!=(i=t(e[n],n,e))&&i>=i)for(d=i;++n<a;)null!=(i=t(e[n],n,e))&&i>d&&(d=i);return d}function b(e){for(var t=e.length,n=-1,a=0,i,d,r;++n<t;)a+=e[n].length;for(d=Array(a);0<=--t;)for(r=e[t],i=r.length;0<=--i;)d[--a]=r[i];return d}function v(e,t){var a=e.length,n=-1,i,d;if(null==t){for(;++n<a;)if(null!=(i=e[n])&&i>=i)for(d=i;++n<a;)null!=(i=e[n])&&d>i&&(d=i);}else for(;++n<a;)if(null!=(i=t(e[n],n,e))&&i>=i)for(d=i;++n<a;)null!=(i=t(e[n],n,e))&&d>i&&(d=i);return d}function k(e,t){for(var n=t.length,a=Array(n);n--;)a[n]=e[t[n]];return a}function w(e,t){var a=e.length,n=-1,i=0,d;if(null==t)for(;++n<a;)(d=+e[n])&&(i+=d);else for(;++n<a;)(d=+t(e[n],n,e))&&(i+=d);return i}function S(e,t,r,l){var s=d(e,l),f=s.length,n=t,c,a,i,p;for(i=0,p=Array(n);i<n;++i){for(c=0,a=0;a<f;++a)c+=s[~~(Math.random()*f)];p[i]=c/f}return[h(p.sort(o),r/2),h(p,1-r/2)]}function z(e,t){var n=NaN,a={},i,d;return a.mean=function(e){return arguments.length?(i=e||0,n=NaN,a):i},a.stdev=function(e){return arguments.length?(d=null==e?1:e,n=NaN,a):d},a.sample=function(){var e=0,t=0,a,r;if(n===n)return e=n,n=NaN,e;do e=2*Math.random()-1,t=2*Math.random()-1,a=e*e+t*t;while(0===a||1<a);return r=Hx(-2*av(a)/a),n=i+t*r*d,i+e*r*d},a.pdf=function(e){var t=Wx(Qx(e-i,2)/(-2*Qx(d,2)));return 1/(d*Hx(2*Gx))*t},a.cdf=function(e){var t=(e-i)/d,n=Vx(t),a;if(37<n)a=0;else{var r=Wx(-n*n/2),o;7.07106781186547>n?(o=0.0352624965998911*n+0.700383064443688,o=o*n+6.37396220353165,o=o*n+33.912866078383,o=o*n+112.079291497871,o=o*n+221.213596169931,o=o*n+220.206867912376,a=r*o,o=0.0883883476483184*n+1.75566716318264,o=o*n+16.064177579207,o=o*n+86.7807322029461,o=o*n+296.564248779674,o=o*n+637.333633378831,o=o*n+793.826512519948,o=o*n+440.413735824752,a/=o):(o=n+0.65,o=n+4/o,o=n+3/o,o=n+2/o,o=n+1/o,a=r/o/2.506628274631)}return 0<t?1-a:a},a.icdf=function(e){if(0>=e||1<=e)return NaN;var t=2*e-1,n=8*(Gx-3)/(3*Gx*(4-Gx)),r=2/(Gx*n)+av(1-Qx(t,2))/2,a=av(1-t*t)/n,o=(0<t?1:-1)*Hx(Hx(r*r-a)-r);return i+d*Yx*o},a.mean(e).stdev(t)}function T(e,t){var n=d(e,t);return[h(n.sort(o),0.25),h(n,0.5),h(n,0.75)]}function R(e,t){var a=z(),i={},d=0;return i.data=function(n){return arguments.length?(e=n,d=n?n.length:0,i.bandwidth(t)):e},i.bandwidth=function(n){return arguments.length?(t=n,!t&&e&&(t=O(e)),i):t},i.sample=function(){return e[~~(Math.random()*d)]+t*a.sample()},i.pdf=function(n){for(var r=0,o=0;o<d;++o)r+=a.pdf((n-e[o])/t);return r/t/d},i.cdf=function(n){for(var r=0,o=0;o<d;++o)r+=a.cdf((n-e[o])/t);return r/d},i.icdf=function(){throw Error('KDE icdf not supported.')},i.data(e)}function O(e){var t=e.length,n=T(e),a=(n[2]-n[0])/1.34;return 1.06*Zx(Hx(i(e)),a)*Qx(t,-0.2)}function P(e,t){function n(e){var t=[],n=0,a;for(a=0;a<o;++a)n+=t[a]=null==e[a]?1:+e[a];for(a=0;a<o;++a)t[a]/=n;return t}var a={},o=0,l;return a.weights=function(e){return arguments.length?(l=n(t=e||[]),a):t},a.distributions=function(n){return arguments.length?(n?(o=n.length,e=n):(o=0,e=[]),a.weights(t)):e},a.sample=function(){for(var t=Math.random(),n=e[o-1],a=l[0],d=0;d<o-1;a+=l[++d])if(t<a){n=e[d];break}return n.sample()},a.pdf=function(t){for(var n=0,a=0;a<o;++a)n+=l[a]*e[a].pdf(t);return n},a.cdf=function(t){for(var n=0,a=0;a<o;++a)n+=l[a]*e[a].cdf(t);return n},a.icdf=function(){throw Error('Mixture icdf not supported.')},a.distributions(e).weights(t)}function M(e,t){null==t&&(t=null==e?1:e,e=0);var n={},i,a,r;return n.min=function(e){return arguments.length?(i=e||0,r=a-i,n):i},n.max=function(e){return arguments.length?(a=e||0,r=a-i,n):a},n.sample=function(){return i+r*Math.random()},n.pdf=function(e){return e>=i&&e<=a?1/r:0},n.cdf=function(e){return e<i?0:e>a?1:(e-i)/r},n.icdf=function(e){return 0<=e&&1>=e?i+e*r:NaN},n.min(e).max(t)}function L(e,t,n){return e.fields=t||[],e.fname=n,e}function q(e){return null==e?null:e.fname}function U(e){return null==e?null:e.fields}function F(e){throw Error(e)}function j(e){function t(){a.push(n+e.substring(l,i)),n='',l=i+1}var a=[],d=null,r=0,o=e.length,n='',l,i,s;for(e+='',l=i=0;i<o;++i)if(s=e[i],'\\'===s)n+=e.substring(l,i),l=++i;else if(s===d)t(),d=null,r=-1;else if(d)continue;else l===r&&'"'===s?(l=i+1,d=s):l===r&&'\''===s?(l=i+1,d=s):'.'!==s||r?'['===s?(i>l&&t(),r=l=i+1):']'===s&&(r||F('Access path missing open bracket: '+e),0<r&&t(),r=0,l=i+1):i>l?t():l=i+1;return r&&F('Access path missing closing bracket: '+e),d&&F('Access path missing closing quote: '+e),i>l&&(++i,t()),a}function N(e){return e===Object(e)}function I(e){return'string'===typeof e}function Y(e){return fv(e)?'['+e.map(Y)+']':N(e)||I(e)?JSON.stringify(e).replace('\u2028','\\u2028').replace('\u2029','\\u2029'):e}function $(e,t){var n=j(e),a='return _['+n.map(Y).join('][')+'];';return L(Function('_',a),[e=1===n.length?n[0]:e],t||e)}function G(e,t,n){var a=[t].concat([].slice.call(n));console[e].apply(console,a)}function W(e){var t=e||yv;return{level:function(e){return arguments.length?(t=+e,this):t},warn:function(){return t>=bv&&G('warn','WARN',arguments),this},info:function(){return t>=_v&&G('log','INFO',arguments),this},debug:function(){return t>=xv&&G('log','DEBUG',arguments),this}}}function H(e){return null==e?[]:fv(e)?e:[e]}function X(e,t){var a=[],r=(e=H(e)).map(function(e,t){return null==e?null:(a.push(t),j(e).map(Y).join(']['))}),o=a.length-1,n=H(t),l='var u,v;return ',s,i,c,f,p,u,d,g;if(0>o)return null;for(i=0;i<=o;++i)s=a[i],c=r[s],f='(u=a['+c+'])',p='(v=b['+c+'])',u='((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))',d='descending'===n[s]?(g=-1,1):(g=1,-1),l+='('+f+'<'+p+'||u==null)&&v!=null?'+d+':(u>v||v==null)&&u!=null?'+g+':'+u+'!==u&&v===v?'+d+':v!==v&&u===u?'+g+(s<o?':':':0');return L(Function('a','b',l+';'),e.filter(function(e){return null!=e}))}function V(e){return'function'===typeof e}function J(e){return V(e)?e:function(){return e}}function Z(e){for(var t=1,n=arguments.length,a,i;t<n;++t)for(i in a=arguments[t],a)e[i]=a[i];return e}function K(e,t){var d=-1,i=e.length,n,a,r,o,l;if(null==t){for(;++d<i;)if(null!=(a=e[d])&&a>=a){n=r=a;break}for(o=l=d;++d<i;)null!=(a=e[d])&&(n>a&&(n=a,o=d),r<a&&(r=a,l=d))}else{for(;++d<i;)if(null!=(a=t(e[d],d,e))&&a>=a){n=r=a;break}for(o=l=d;++d<i;)null!=(a=t(e[d],d,e))&&(n>a&&(n=a,o=d),r<a&&(r=a,l=d))}return[o,l]}function Q(e){function t(e){return n.hasOwnProperty(e)&&n[e]!==vv}var n={},a,i;return a={size:0,empty:0,object:n,has:t,get:function(e){return t(e)?n[e]:void 0},set:function(e,i){return t(e)||(++a.size,n[e]===vv&&--a.empty),n[e]=i,this},delete:function(e){return t(e)&&(--a.size,++a.empty,n[e]=vv),this},clear:function(){a.size=a.empty=0,a.object=n={}},test:function(e){return arguments.length?(i=e,a):i},clean:function(){var e={},t=0,d,r;for(d in n)r=n[d],r===vv||i&&i(r)||(e[d]=r,++t);a.size=t,a.empty=0,a.object=n=e}},e&&Object.keys(e).forEach(function(t){a.set(t,e[t])}),a}function ee(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n}function te(e){return'boolean'===typeof e}function ne(e){return'[object Date]'===Object.prototype.toString.call(e)}function ae(e){return'number'===typeof e}function ie(e){return'[object RegExp]'===Object.prototype.toString.call(e)}function de(e){e=e?H(e):e;var t=e&&e.length?Function('_','return \'\'+'+e.map(function(e){return'_['+j(e).map(Y).join('][')+']'}).join('+\'|\'+')+';'):function(){return''};return L(t,e,'key')}function oe(e,t,n,a){var d=t.length,r=n.length;if(!r)return t;if(!d)return n;for(var o=a||new t.constructor(d+r),l=0,s=0,f=0;l<d&&s<r;++f)o[f]=0<e(t[l],n[s])?n[s++]:t[l++];for(;l<d;++l,++f)o[f]=t[l];for(;s<r;++s,++f)o[f]=n[s];return o}function le(e,t){for(var n='';0<=--t;)n+=e;return n}function se(e,t,a,i){var d=a||' ',r=e+'',o=t-r.length;return 0>=o?r:'left'===i?le(d,o)+r:'center'===i?le(d,~~(o/2))+r+le(d,tv(o/2)):r+le(d,o)}function fe(e){return e[e.length-1]}function ce(e){return null==e||''===e?null:e&&'false'!==e&&!!e}function pe(e,t){return null==e||''===e?null:t?t(e):Date.parse(e)}function ue(e){return null==e||''===e?null:+e}function ge(e){return null==e||''===e?null:e+''}function he(e){for(var t={},a=0,i=e.length;a<i;++a)t[e[a]]=1;return t}function me(t,a,i,d){var r=null==d?'\u2026':d,e=t+'',o=e.length,n=nv(0,a-r.length);return o<=a?e:'left'===i?r+e.slice(o-n):'center'===i?e.slice(0,tv(n/2))+r+e.slice(o-~~(n/2)):e.slice(0,n)+r}function ye(e,a,d){if(e){var r=0,i=e.length,n;if(a)for(;r<i;++r)(n=a(e[r]))&&d(n,r,e);else e.forEach(d)}}function be(){}function _e(e,t){var a=new be;if(e instanceof be)e.each(function(e,t){a.set(t,e)});else if(Array.isArray(e)){var d=-1,i=e.length,n;if(null==t)for(;++d<i;)a.set(d,e[d]);else for(;++d<i;)a.set(t(n=e[d],d,e),n)}else if(e)for(var r in e)a.set(r,e[r]);return a}function xe(){function e(t,o,l,s){if(o>=a.length)return null==r?null==d?t:t.sort(d):r(t);for(var f=-1,i=t.length,n=a[o++],c=_e(),p=l(),u,g,h;++f<i;)(h=c.get(u=n(g=t[f])+''))?h.push(g):c.set(u,[g]);return c.each(function(t,n){s(p,n,e(t,o,l,s))}),p}function t(e,i){if(++i>a.length)return e;var d=n[i-1],o;return null!=r&&i>=a.length?o=e.entries():(o=[],e.each(function(e,n){o.push({key:n,values:t(e,i)})})),null==d?o:o.sort(function(e,t){return d(e.key,t.key)})}var a=[],n=[],d,r,i;return i={object:function(t){return e(t,0,ve,ke)},map:function(t){return e(t,0,we,Se)},entries:function(n){return t(e(n,0,we,Se),0)},key:function(e){return a.push(e),i},sortKeys:function(e){return n[a.length-1]=e,i},sortValues:function(e){return d=e,i},rollup:function(e){return r=e,i}}}function ve(){return{}}function ke(e,t,n){e[t]=n}function we(){return _e()}function Se(e,t,n){e.set(t,n)}function Ee(){for(var e=0,a=arguments.length,n={},i;e<a;++e){if(!(i=arguments[e]+'')||i in n)throw new Error('illegal type: '+i);n[i]=[]}return new Ce(n)}function Ce(e){this._=e}function ze(e,n){return e.trim().split(/^|\s+/).map(function(e){var a='',d=e.indexOf('.');if(0<=d&&(a=e.slice(d+1),e=e.slice(0,d)),e&&!n.hasOwnProperty(e))throw new Error('unknown type: '+e);return{type:e,name:a}})}function Te(e,t){for(var a=0,i=e.length,n;a<i;++a)if((n=e[a]).name===t)return n.value}function Re(e,t,a){for(var d=0,i=e.length;d<i;++d)if(e[d].name===t){e[d]=Sv,e=e.slice(0,d).concat(e.slice(d+1));break}return null!=a&&e.push({name:t,value:a}),e}function Ae(e,t){function n(e){var t=d.status,n;if(!t&&Pe(d)||200<=t&&300>t||304===t){if(c)try{n=c.call(s,d)}catch(t){return void a.call('error',s,t)}else n=d;a.call('load',s,n)}else a.call('error',s,e)}var a=Ee('beforesend','progress','load','error'),i=_e(),d=new XMLHttpRequest,r=null,o=null,l=0,s,f,c,p;if('undefined'!==typeof XDomainRequest&&!('withCredentials'in d)&&/^(http(s)?:)?\/\//.test(e)&&(d=new XDomainRequest),'onload'in d?d.onload=d.onerror=d.ontimeout=n:d.onreadystatechange=function(e){3<d.readyState&&n(e)},d.onprogress=function(t){a.call('progress',s,t)},s={header:function(e,t){return(e=(e+'').toLowerCase(),2>arguments.length)?i.get(e):(null==t?i.remove(e):i.set(e,t+''),s)},mimeType:function(e){return arguments.length?(f=null==e?null:e+'',s):f},responseType:function(e){return arguments.length?(p=e,s):p},timeout:function(e){return arguments.length?(l=+e,s):l},user:function(e){return 1>arguments.length?r:(r=null==e?null:e+'',s)},password:function(e){return 1>arguments.length?o:(o=null==e?null:e+'',s)},response:function(e){return c=e,s},get:function(e,t){return s.send('GET',e,t)},post:function(e,t){return s.send('POST',e,t)},send:function(t,n,c){return d.open(t,e,!0,r,o),null==f||i.has('accept')||i.set('accept',f+',*/*'),d.setRequestHeader&&i.each(function(e,t){d.setRequestHeader(t,e)}),null!=f&&d.overrideMimeType&&d.overrideMimeType(f),null!=p&&(d.responseType=p),0<l&&(d.timeout=l),null==c&&'function'===typeof n&&(c=n,n=null),null!=c&&1===c.length&&(c=Oe(c)),null!=c&&s.on('error',c).on('load',function(e){c(null,e)}),a.call('beforesend',s,d),d.send(null==n?null:n),s},abort:function(){return d.abort(),s},on:function(){var e=a.on.apply(a,arguments);return e===a?s:e}},null!=t){if('function'!==typeof t)throw new Error('invalid callback: '+t);return s.get(t)}return s}function Oe(e){return function(t,n){e(null==t?n:null)}}function Pe(e){var t=e.responseType;return t&&'text'!==t?e.response:e.responseText}function Me(e){return new Function('d','return {'+e.map(function(e,t){return JSON.stringify(e)+': d['+t+']'}).join(',')+'}')}function De(e,t){var n=Me(e);return function(a,d){return t(n(a),d,e)}}function Le(e){var t=Object.create(null),n=[];return e.forEach(function(e){for(var a in e)a in t||n.push(t[a]=a)}),n}function qe(e){function t(e,i){function r(){if(p>=f)return l;if(t)return t=!1,o;var n=p,a;if(34===e.charCodeAt(n)){for(var r=n;r++<f;)if(34===e.charCodeAt(r)){if(34!==e.charCodeAt(r+1))break;++r}return p=r+2,a=e.charCodeAt(r+1),13===a?(t=!0,10===e.charCodeAt(r+2)&&++p):10===a&&(t=!0),e.slice(n+1,r).replace(/""/g,'"')}for(;p<f;){var i=1;if(a=e.charCodeAt(p++),10===a)t=!0;else if(13===a)t=!0,10===e.charCodeAt(p)&&(++p,++i);else if(a!==d)continue;return e.slice(n,p-i)}return e.slice(n)}for(var o={},l={},s=[],f=e.length,p=0,c=0,n,t;(n=r())!==l;){for(var u=[];n!==o&&n!==l;)u.push(n),n=r();i&&null==(u=i(u,c++))||s.push(u)}return s}function n(t){return t.map(a).join(e)}function a(e){return null==e?'':i.test(e+='')?'"'+e.replace(/\"/g,'""')+'"':e}var i=new RegExp('["'+e+'\n\r]'),d=e.charCodeAt(0);return{parse:function(e,n){var a=t(e,function(e,t){return d?d(e,t-1):void(r=e,d=n?De(e,n):Me(e))}),d,r;return a.columns=r,a},parseRows:t,format:function(t,n){return null==n&&(n=Le(t)),[n.map(a).join(e)].concat(t.map(function(t){return n.map(function(e){return a(t[e])}).join(e)})).join('\n')},formatRows:function(e){return e.map(n).join('\n')}}}function Ue(e){return{options:e||{},sanitize:$e,load:je,file:Ie,http:Ne}}function Fe(e,t){return Z({},e.options,t)}function je(e,t){var n=this;return n.sanitize(e,t).then(function(e){var a=e.href;return Ye(a,Tv)?n.file(a.slice(Tv.length)):n.http(a,t)})}function $e(e,t){return t=Fe(this,t),new Promise(function(n,a){var i,d,r,o;return null==e||'string'!==typeof e?void a('Sanitize failure, invalid URI: '+Y(e)):void(d=zv.test(e),(o=t.baseURL)&&!d&&(!Ye(e,'/')&&'/'!==o[o.length-1]&&(e='/'+e),e=o+e),r=(i=Ye(e,Tv))||'file'===t.mode||'http'!==t.mode&&!d&&Be(),r?e=(i?'':Tv)+e:Ye(e,'//')&&(e=(t.defaultProtocol||'http')+':'+e),n({href:e}))})}function Ne(e,t){return t=Fe(this,t),new Promise(function(n,a){var i=Ae(e),d;for(d in t.headers)i.header(d,t.headers[d]);Rv.forEach(function(e){t[e]&&i[e](t[e])}),i.on('error',function(t){a(t||'Error loading URL: '+e)}).on('load',function(e){var t=e&&e.responseText;e&&0!==e.status?n(t):a(t||'Error')}).get()})}function Ie(e){return new Promise(function(t,n){var a=Be();a?a.readFile(e,function(e,a){e?n(e):t(a)}):n('No file system access for '+e)})}function Be(){var e='function'===typeof require&&require('fs');return e&&V(e.readFile)?e:null}function Ye(e,t){return null!=e&&0===e.lastIndexOf(t,0)}function Ge(e,t){var a=Ov.slice(),d,r,i,n;for(r=0,i=e.length;r<i;++r){for(d=t?e[r][t]:e[r],n=0;n<a.length;++n)He(d)&&!a[n](d)&&(a.splice(n,1),--n);if(0===a.length)return'string'}return Pv[Ov.indexOf(a[0])]}function We(e,t){return t.reduce(function(t,n){return t[n]=Ge(e,n),t},{})}function He(e){return null!=e&&e===e}function Xe(e){return!isNaN(+e)&&!(e instanceof Date)}function Ve(e){return function(t,n){var a={delimiter:e};return Je(t,n?Z(n,a):a)}}function Je(e,t){return t.header&&(e=t.header.map(Y).join(t.delimiter)+'\n'+e),qe(t.delimiter).parse(e+'')}function Ze(e){return'function'===typeof Buffer&&V(Buffer.isBuffer)&&Buffer.isBuffer(e)}function Ke(e,t){var n=t&&t.property?$(t.property):id;return N(e)&&!Ze(e)?Qe(n(e)):n(JSON.parse(e))}function Qe(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}function et(){}function tt(e){if(!e)return et;var t=e.scale[0],n=e.scale[1],a=e.translate[0],d=e.translate[1],r,o;return function(e,l){l||(r=o=0),e[0]=(r+=e[0])*t+a,e[1]=(o+=e[1])*n+d}}function nt(e,a){for(var n=e.length,d=n-a,i;d<--n;)i=e[d],e[d++]=e[n],e[n]=i}function at(e,t){return'GeometryCollection'===t.type?{type:'FeatureCollection',features:t.geometries.map(function(t){return it(e,t)})}:it(e,t)}function it(e,t){var n={type:'Feature',id:t.id,properties:t.properties||{},geometry:dt(e,t)};return null==t.id&&delete n.id,n}function dt(e,t){function a(e,t){t.length&&t.pop();for(var d=s[0>e?~e:e],a=0,r=d.length,n;a<r;++a)t.push(n=d[a].slice()),o(n,a);0>e&&nt(t,r)}function n(e){return e=e.slice(),o(e,0),e}function i(e){for(var t=[],d=0,i=e.length;d<i;++d)a(e[d],t);return 2>t.length&&t.push(t[0].slice()),t}function d(e){for(var t=i(e);4>t.length;)t.push(t[0].slice());return t}function r(e){return e.map(d)}function l(e){var n=e.type;return'GeometryCollection'===n?{type:n,geometries:e.geometries.map(l)}:n in f?{type:n,coordinates:f[n](e)}:null}var o=tt(e.transform),s=e.arcs,f={Point:function(e){return n(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(n)},LineString:function(e){return i(e.arcs)},MultiLineString:function(e){return e.arcs.map(i)},Polygon:function(e){return r(e.arcs)},MultiPolygon:function(e){return e.arcs.map(r)}};return l(t)}function rt(e,n){function t(t){var n=e.arcs[0>t?~t:t],a=n[0],d;return e.transform?(d=[0,0],n.forEach(function(e){d[0]+=e[0],d[1]+=e[1]})):d=n[n.length-1],0>t?[d,a]:[a,d]}function a(e,t){for(var n in e){var a=e[n];delete t[a.start],delete a.start,delete a.end,a.forEach(function(e){d[0>e?~e:e]=1}),l.push(a)}}var d={},r={},o={},l=[],s=-1;return n.forEach(function(a,d){var r=e.arcs[0>a?~a:a],o;!(3>r.length)||r[1][0]||r[1][1]||(o=n[++s],n[s]=a,n[d]=o)}),n.forEach(function(n){var a=t(n),e=a[0],i=a[1],d,l;if(d=o[e]){if(delete o[d.end],d.push(n),d.end=i,l=r[i]){delete r[l.start];var s=l===d?d:d.concat(l);r[s.start=d.start]=o[s.end=l.end]=s}else r[d.start]=o[d.end]=d;}else if(!(d=r[i]))d=[n],r[d.start=e]=o[d.end=i]=d;else if(delete r[d.start],d.unshift(n),d.start=e,l=o[e]){delete o[l.end];var f=l===d?d:l.concat(d);r[f.start=l.start]=o[f.end=d.end]=f}else r[d.start]=o[d.end]=d}),a(o,r),a(r,o),n.forEach(function(e){d[0>e?~e:e]||l.push([e])}),l}function ot(e){return dt(e,lt.apply(this,arguments))}function lt(e,t,a){function d(e){var t=0>e?~e:e;(f[t]||(f[t]=[])).push({i:e,g:p})}function r(e){e.forEach(d)}function o(e){e.forEach(r)}function l(e){'GeometryCollection'===e.type?e.geometries.forEach(l):e.type in c&&(p=e,c[e.type](e.arcs))}var s=[];if(1<arguments.length){var f=[],c={LineString:r,MultiLineString:o,Polygon:o,MultiPolygon:function(e){e.forEach(o)}},p;l(t),f.forEach(3>arguments.length?function(e){s.push(e[0].i)}:function(e){a(e[0].g,e[e.length-1].g)&&s.push(e[0].i)})}else for(var u=0,i=e.arcs.length;u<i;++u)s.push(u);return{type:'MultiLineString',arcs:rt(e,s)}}function st(e,t){return 1<arguments.length?(Mv[e]=t,this):Mv.hasOwnProperty(e)?Mv[e]:null}function ft(e,t,n,a){function i(t){return e(t=new Date(+t)),t}return i.floor=i,i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Kx(n)),e},i.range=function(n,a,d){var r=[];if(n=i.ceil(n),d=null==d?1:Kx(d),!(n<a)||!(0<d))return r;do r.push(new Date(+n));while((t(n,d),e(n),n<a));return r},i.filter=function(n){return ft(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,a){if(e>=e)for(;0<=--a;)for(;t(e,1),!n(e););})},n&&(i.count=function(t,a){return Dv.setTime(+t),Lv.setTime(+a),e(Dv),e(Lv),Kx(n(Dv,Lv))},i.every=function(e){return e=Kx(e),isFinite(e)&&0<e?1<e?i.filter(a?function(t){return 0===a(t)%e}:function(t){return 0===i.count(0,t)%e}):i:null}),i}function ct(e){return ft(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fv)/Nv})}function pt(e){return ft(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/Nv})}function ut(e){if(0<=e.y&&100>e.y){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function gt(e){if(0<=e.y&&100>e.y){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ht(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function mt(e){function t(e,t){return function(a){var d=[],r=-1,i=0,o=e.length,n,l,s;for(a instanceof Date||(a=new Date(+a));++r<o;)37===e.charCodeAt(r)&&(d.push(e.slice(i,r)),null==(l=ak[n=e.charAt(++r)])?l='e'===n?' ':'0':n=e.charAt(++r),(s=t[n])&&(n=s(a,l)),d.push(n),i=r+1);return d.push(e.slice(i,r)),d.join('')}}function n(e,t){return function(n){var r=ht(1900),d=a(r,e,n+='',0);if(d!=n.length)return null;if('p'in r&&(r.H=r.H%12+12*r.p),'W'in r||'U'in r){'w'in r||(r.w='W'in r?1:0);var i='Z'in r?gt(ht(r.y)).getUTCDay():t(ht(r.y)).getDay();r.m=0,r.d='W'in r?(r.w+6)%7+7*r.W-(i+5)%7:r.w+7*r.U-(i+6)%7}return'Z'in r?(r.H+=0|r.Z/100,r.M+=r.Z%100,gt(r)):t(r)}}function a(e,t,a,d){for(var r=0,i=t.length,n=a.length,o,l;r<i;){if(d>=n)return-1;if(o=t.charCodeAt(r++),37===o){if(o=t.charAt(r++),l=S[o in ak?t.charAt(r++):o],!l||0>(d=l(e,a,d)))return-1;}else if(o!=a.charCodeAt(d++))return-1}return d}var r=e.dateTime,o=e.date,l=e.time,i=e.periods,s=e.days,f=e.shortDays,c=e.months,p=e.shortMonths,u=_t(i),g=xt(i),h=_t(s),m=xt(s),y=_t(f),b=xt(f),_=_t(c),x=xt(c),v=_t(p),k=xt(p),d={a:function(e){return f[e.getDay()]},A:function(e){return s[e.getDay()]},b:function(e){return p[e.getMonth()]},B:function(e){return c[e.getMonth()]},c:null,d:Lt,e:Lt,H:qt,I:Ut,j:Ft,L:jt,m:$t,M:Nt,p:function(e){return i[+(12<=e.getHours())]},S:It,U:Bt,w:Yt,W:Gt,x:null,X:null,y:Wt,Y:Ht,Z:Xt,"%":fn},w={a:function(e){return f[e.getUTCDay()]},A:function(e){return s[e.getUTCDay()]},b:function(e){return p[e.getUTCMonth()]},B:function(e){return c[e.getUTCMonth()]},c:null,d:Vt,e:Vt,H:Jt,I:Zt,j:Kt,L:Qt,m:en,M:tn,p:function(e){return i[+(12<=e.getUTCHours())]},S:nn,U:an,w:dn,W:rn,x:null,X:null,y:on,Y:ln,Z:sn,"%":fn},S={a:function(e,t,a){var i=y.exec(t.slice(a));return i?(e.w=b[i[0].toLowerCase()],a+i[0].length):-1},A:function(e,t,a){var i=h.exec(t.slice(a));return i?(e.w=m[i[0].toLowerCase()],a+i[0].length):-1},b:function(e,t,a){var i=v.exec(t.slice(a));return i?(e.m=k[i[0].toLowerCase()],a+i[0].length):-1},B:function(e,t,a){var i=_.exec(t.slice(a));return i?(e.m=x[i[0].toLowerCase()],a+i[0].length):-1},c:function(e,t,n){return a(e,r,t,n)},d:Tt,e:Tt,H:At,I:At,j:Rt,L:Mt,m:zt,M:Ot,p:function(e,t,a){var i=u.exec(t.slice(a));return i?(e.p=g[i[0].toLowerCase()],a+i[0].length):-1},S:Pt,U:kt,w:vt,W:wt,x:function(e,t,n){return a(e,o,t,n)},X:function(e,t,n){return a(e,l,t,n)},y:Et,Y:St,Z:Ct,"%":Dt};return d.x=t(o,d),d.X=t(l,d),d.c=t(r,d),w.x=t(o,w),w.X=t(l,w),w.c=t(r,w),{format:function(e){var n=t(e+='',d);return n.toString=function(){return e},n},parse:function(e){var t=n(e+='',ut);return t.toString=function(){return e},t},utcFormat:function(e){var n=t(e+='',w);return n.toString=function(){return e},n},utcParse:function(e){var t=n(e,gt);return t.toString=function(){return e},t}}}function yt(e,t,n){var a=0>e?'-':'',i=(a?-e:e)+'',d=i.length;return a+(d<n?Array(n-d+1).join(t)+i:i)}function bt(e){return e.replace(rk,'\\$&')}function _t(e){return new RegExp('^(?:'+e.map(bt).join('|')+')','i')}function xt(e){for(var t={},a=-1,i=e.length;++a<i;)t[e[a].toLowerCase()]=a;return t}function vt(e,t,a){var i=ik.exec(t.slice(a,a+1));return i?(e.w=+i[0],a+i[0].length):-1}function kt(e,t,a){var i=ik.exec(t.slice(a));return i?(e.U=+i[0],a+i[0].length):-1}function wt(e,t,a){var i=ik.exec(t.slice(a));return i?(e.W=+i[0],a+i[0].length):-1}function St(e,t,a){var i=ik.exec(t.slice(a,a+4));return i?(e.y=+i[0],a+i[0].length):-1}function Et(e,t,a){var i=ik.exec(t.slice(a,a+2));return i?(e.y=+i[0]+(68<+i[0]?1900:2e3),a+i[0].length):-1}function Ct(e,t,a){var i=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(t.slice(a,a+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||'00')),a+i[0].length):-1}function zt(e,t,a){var i=ik.exec(t.slice(a,a+2));return i?(e.m=i[0]-1,a+i[0].length):-1}function Tt(e,t,a){var i=ik.exec(t.slice(a,a+2));return i?(e.d=+i[0],a+i[0].length):-1}function Rt(e,t,a){var i=ik.exec(t.slice(a,a+3));return i?(e.m=0,e.d=+i[0],a+i[0].length):-1}function At(e,t,a){var i=ik.exec(t.slice(a,a+2));return i?(e.H=+i[0],a+i[0].length):-1}function Ot(e,t,a){var i=ik.exec(t.slice(a,a+2));return i?(e.M=+i[0],a+i[0].length):-1}function Pt(e,t,a){var i=ik.exec(t.slice(a,a+2));return i?(e.S=+i[0],a+i[0].length):-1}function Mt(e,t,a){var i=ik.exec(t.slice(a,a+3));return i?(e.L=+i[0],a+i[0].length):-1}function Dt(e,t,a){var i=dk.exec(t.slice(a,a+1));return i?a+i[0].length:-1}function Lt(e,t){return yt(e.getDate(),t,2)}function qt(e,t){return yt(e.getHours(),t,2)}function Ut(e,t){return yt(e.getHours()%12||12,t,2)}function Ft(e,t){return yt(1+Gv.count(Vv(e),e),t,3)}function jt(e,t){return yt(e.getMilliseconds(),t,3)}function $t(e,t){return yt(e.getMonth()+1,t,2)}function Nt(e,t){return yt(e.getMinutes(),t,2)}function It(e,t){return yt(e.getSeconds(),t,2)}function Bt(e,t){return yt(Wv.count(Vv(e),e),t,2)}function Yt(e){return e.getDay()}function Gt(e,t){return yt(Hv.count(Vv(e),e),t,2)}function Wt(e,t){return yt(e.getFullYear()%100,t,2)}function Ht(e,t){return yt(e.getFullYear()%1e4,t,4)}function Xt(e){var t=e.getTimezoneOffset();return(0<t?'-':(t*=-1,'+'))+yt(0|t/60,'0',2)+yt(t%60,'0',2)}function Vt(e,t){return yt(e.getUTCDate(),t,2)}function Jt(e,t){return yt(e.getUTCHours(),t,2)}function Zt(e,t){return yt(e.getUTCHours()%12||12,t,2)}function Kt(e,t){return yt(1+Kv.count(nk(e),e),t,3)}function Qt(e,t){return yt(e.getUTCMilliseconds(),t,3)}function en(e,t){return yt(e.getUTCMonth()+1,t,2)}function tn(e,t){return yt(e.getUTCMinutes(),t,2)}function nn(e,t){return yt(e.getUTCSeconds(),t,2)}function an(e,t){return yt(Qv.count(nk(e),e),t,2)}function dn(e){return e.getUTCDay()}function rn(e,t){return yt(ek.count(nk(e),e),t,2)}function on(e,t){return yt(e.getUTCFullYear()%100,t,2)}function ln(e,t){return yt(e.getUTCFullYear()%1e4,t,4)}function sn(){return'+0000'}function fn(){return'%'}function cn(e){return ok=mt(e),lk=ok.format,sk=ok.parse,fk=ok.utcFormat,ck=ok.utcParse,ok}function pn(e,t,n){t=t||{};var a=st(t.type||'json');return a||F('Unknown data format type: '+t.type),e=a(e,t),t.parse&&un(e,t.parse,n),e.hasOwnProperty('columns')&&delete e.columns,e}function un(e,t,a){a=a||sk;var d=e.columns||Object.keys(e[0]),r,o,l,s,i,f,n;for('auto'===t&&(t=We(e,d)),d=Object.keys(t),r=d.map(function(e){var n=t[e],i,d;if(n&&(0===n.indexOf('date:')||0===n.indexOf('utc:')))return i=n.split(/:(.+)?/,2),d=i[1],('\''===d[0]&&'\''===d[d.length-1]||'"'===d[0]&&'"'===d[d.length-1])&&(d=d.slice(1,-1)),'utc'===i[0]?ck(d):a(d);if(!Av[n])throw Error('Illegal format pattern: '+e+':'+n);return Av[n]}),(s=0,f=e.length,n=d.length);s<f;++s)for(o=e[s],i=0;i<n;++i)l=d[i],o[l]=r[i](o[l])}function gn(e){this.clear(),e&&this.union(e)}function hn(e,t){var n=[],a;return a={id:'gradient_'+mk++,x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){return n.push({offset:e,color:t}),a}}}function mn(e){this.mark=e,this.bounds=this.bounds||new gn,this.bounds_prev=this.bounds_prev||new gn}function yn(e){mn.call(this,e),this.items=this.items||[]}function bn(e,t,n){return!e&&'undefined'!==typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function _n(e,t){t=t.toLowerCase();for(var a=e.childNodes,d=0,i=a.length;d<i;++d)if(a[d].tagName.toLowerCase()===t)return a[d]}function xn(e,t,n,i){var d=e.childNodes[t],a;return d&&d.tagName.toLowerCase()===n.toLowerCase()||(a=d||null,d=bn(e.ownerDocument,n,i),e.insertBefore(d,a)),d}function vn(e,t){for(var n=e.childNodes,a=n.length;a>t;)e.removeChild(n[--a]);return e}function kn(e){return'mark-'+e.marktype+(e.role?' role-'+e.role:'')+(e.name?' '+e.name:'')}function wn(e,t){var n=bn(null,'canvas');return n?(n.width=e,n.height=t):yk&&(n=new yk(e,t)),n}function Sn(e){this._pending=0,this._loader=e||Ue()}function En(e){e._pending+=1}function Cn(e){e._pending-=1}function zn(){this._x0=this._y0=this._x1=this._y1=null,this._=''}function Tn(){return new zn}function Rn(e){return function(){return e}}function An(e){return 1<e?0:-1>e?Ak:Nx(e)}function On(e){return 1<=e?Ok:-1>=e?-Ok:Fx(e)}function Pn(e){return e.innerRadius}function Mn(e){return e.outerRadius}function Dn(e){return e.startAngle}function Ln(e){return e.endAngle}function qn(e){return e&&e.padAngle}function Un(e,n,a,i,d,r,o,l){var s=a-e,f=i-n,c=o-d,p=l-r,u=(c*(n-r)-p*(e-d))/(p*s-c*f);return[e+u*s,n+u*f]}function Fn(e,t,n,a,i,o,l){var s=e-n,f=t-a,c=(l?o:-o)/Tk(s*s+f*f),p=c*f,u=-c*s,g=e+p,h=t+u,m=n+p,y=a+u,b=(g+m)/2,_=(h+y)/2,x=m-g,v=y-h,k=x*x+v*v,w=i-o,r=g*y-m*h,S=(0>v?-1:1)*Tk(Ek(0,w*w*k-r*r)),d=(r*v-x*S)/k,E=(-r*x-v*S)/k,C=(r*v+x*S)/k,z=(-r*x+v*S)/k,T=d-b,R=E-_,A=C-b,O=z-_;return T*T+R*R>A*A+O*O&&(d=C,E=z),{cx:d,cy:E,x01:-p,y01:-u,x11:d*(i/w-1),y11:E*(i/w-1)}}function jn(e){this._context=e}function $n(e){return new jn(e)}function Nn(e){return e[0]}function In(e){return e[1]}function Bn(){function e(e){var f=e.length,n=!1,c,i,d;for(null==o&&(s=l(d=Tn())),c=0;c<=f;++c)!(c<f&&r(i=e[c],c,e))===n&&((n=!n)?s.lineStart():s.lineEnd()),n&&s.point(+t(i,c,e),+a(i,c,e));if(d)return s=null,d+''||null}var t=Nn,a=In,r=Rn(!0),o=null,l=$n,s=null;return e.x=function(n){return arguments.length?(t='function'===typeof n?n:Rn(+n),e):t},e.y=function(t){return arguments.length?(a='function'===typeof t?t:Rn(+t),e):a},e.defined=function(t){return arguments.length?(r='function'===typeof t?t:Rn(!!t),e):r},e.curve=function(t){return arguments.length?(l=t,null!=o&&(s=l(o)),e):l},e.context=function(t){return arguments.length?(null==t?o=s=null:s=l(o=t),e):o},e}function Gn(){function e(e){var t=e.length,n=!1,u=Array(t),g=Array(t),h,i,m,y,d;for(null==f&&(p=c(d=Tn())),h=0;h<=t;++h){if(!(h<t&&s(y=e[h],h,e))===n)if(n=!n)i=h,p.areaStart(),p.lineStart();else{for(p.lineEnd(),p.lineStart(),m=h-1;m>=i;--m)p.point(u[m],g[m]);p.lineEnd(),p.areaEnd()}n&&(u[h]=+a(y,h,e),g[h]=+o(y,h,e),p.point(r?+r(y,h,e):u[h],l?+l(y,h,e):g[h]))}if(d)return p=null,d+''||null}function t(){return Bn().defined(s).curve(c).context(f)}var a=Nn,r=null,o=Rn(0),l=In,s=Rn(!0),f=null,c=$n,p=null;return e.x=function(t){return arguments.length?(a='function'===typeof t?t:Rn(+t),r=null,e):a},e.x0=function(t){return arguments.length?(a='function'===typeof t?t:Rn(+t),e):a},e.x1=function(t){return arguments.length?(r=null==t?null:'function'===typeof t?t:Rn(+t),e):r},e.y=function(t){return arguments.length?(o='function'===typeof t?t:Rn(+t),l=null,e):o},e.y0=function(t){return arguments.length?(o='function'===typeof t?t:Rn(+t),e):o},e.y1=function(t){return arguments.length?(l=null==t?null:'function'===typeof t?t:Rn(+t),e):l},e.lineX0=e.lineY0=function(){return t().x(a).y(o)},e.lineY1=function(){return t().x(a).y(l)},e.lineX1=function(){return t().x(r).y(o)},e.defined=function(t){return arguments.length?(s='function'===typeof t?t:Rn(!!t),e):s},e.curve=function(t){return arguments.length?(c=t,null!=f&&(p=c(f)),e):c},e.context=function(t){return arguments.length?(null==t?f=p=null:p=c(f=t),e):f},e}function Wn(){}function Hn(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Vn(e){this._context=e}function Jn(e){this._context=e}function Qn(e){this._context=e}function ea(e,t){this._basis=new Vn(e),this._beta=t}function ta(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function na(e,t){this._context=e,this._k=(1-t)/6}function aa(e,t){this._context=e,this._k=(1-t)/6}function ia(e,t){this._context=e,this._k=(1-t)/6}function da(e,t,i){var d=e._x1,r=e._y1,o=e._x2,l=e._y2;if(e._l01_a>Rk){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,a=3*e._l01_a*(e._l01_a+e._l12_a);d=(d*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/a,r=(r*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/a}if(e._l23_a>Rk){var n=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*n+e._x1*e._l23_2a-t*e._l12_2a)/f,l=(l*n+e._y1*e._l23_2a-i*e._l12_2a)/f}e._context.bezierCurveTo(d,r,o,l,e._x2,e._y2)}function ra(e,t){this._context=e,this._alpha=t}function oa(e,t){this._context=e,this._alpha=t}function la(e,t){this._context=e,this._alpha=t}function sa(e){this._context=e}function fa(e){return 0>e?-1:1}function ca(e,t,n){var a=e._x1-e._x0,i=t-e._x1,d=(e._y1-e._y0)/(a||0>i&&-0),r=(n-e._y1)/(i||0>a&&-0);return(fa(d)+fa(r))*Zx(Vx(d),Vx(r),0.5*Vx((d*i+r*a)/(a+i)))||0}function pa(e,n){var t=e._x1-e._x0;return t?(3*(e._y1-e._y0)/t-n)/2:n}function ua(e,t,n){var a=e._x0,i=e._y0,d=e._x1,r=e._y1,o=(d-a)/3;e._context.bezierCurveTo(a+o,i+o*t,d-o,r-o*n,d,r)}function ga(e){this._context=e}function ha(e){this._context=new ma(e)}function ma(e){this._context=e}function ya(e){this._context=e}function ba(e){var t=e.length-1,n=Array(t),a=Array(t),d=Array(t),r,i;for(n[0]=0,a[0]=2,d[0]=e[0]+2*e[1],r=1;r<t-1;++r)n[r]=1,a[r]=4,d[r]=4*e[r]+2*e[r+1];for(n[t-1]=2,a[t-1]=7,d[t-1]=8*e[t-1]+e[t],r=1;r<t;++r)i=n[r]/a[r-1],a[r]-=i,d[r]-=i*d[r-1];for(n[t-1]=d[t-1]/a[t-1],r=t-2;0<=r;--r)n[r]=(d[r]-n[r+1])/a[r];for(a[t-1]=(e[t]+n[t-1])/2,r=0;r<t-1;++r)a[r]=2*e[r+1]-n[r+1];return[n,a]}function _a(e,n){this._context=e,this._t=n}function xa(e,t,n){var a=Nk.hasOwnProperty(e)&&Nk[e],i=null;return a&&(i=a.curve||a[t||'vertical'],a.tension&&null!=n&&(i=i[a.tension](n))),i}function va(e){var t=[],a,d,r,o,l,s,f,c,i,p,n;for(a=e.slice().replace(Bk[0],'###$1').split(Bk[1]).slice(1),c=0,p=a.length;c<p;++c){for(d=a[c],r=d.slice(1).trim().replace(Bk[2],'$1###$2').split(Bk[3]),s=d.charAt(0),o=[s],(i=0,n=r.length);i<n;++i)(l=+r[i])===l&&o.push(l);if(f=Ik[s.toLowerCase()],o.length-1>f)for(i=1,n=o.length;i<n;i+=f)t.push([s].concat(o.slice(i,i+f)));else t.push(o)}return t}function ka(e,t,n,a,d,r,o,l,s){var f=Wk.call(arguments);if(Yk[f])return Yk[f];var c=o*(Gx/180),p=Ix(c),u=Bx(c);n=Vx(n),a=Vx(a);var g=0.5*(u*(l-e))+0.5*(p*(s-t)),h=0.5*(u*(s-t))-0.5*(p*(l-e)),m=g*g/(n*n)+h*h/(a*a);1<m&&(m=Hx(m),n*=m,a*=m);var y=u/n,b=p/n,_=-p/a,x=u/a,v=y*l+b*s,k=_*l+x*s,w=y*e+b*t,S=_*e+x*t,E=1/((w-v)*(w-v)+(S-k)*(S-k))-0.25;0>E&&(E=0);var C=Hx(E);r==d&&(C=-C);var z=0.5*(v+w)-C*(S-k),T=0.5*(k+S)+C*(w-v),R=jx(k-T,v-z),A=jx(S-T,w-z),O=A-R;0>O&&1===r?O+=2*Gx:0<O&&0===r&&(O-=2*Gx);for(var P=tv(Vx(O/(0.5*Gx+1e-3))),M=[],D=0;D<P;++D){var i=R+D*O/P,L=R+(D+1)*O/P;M[D]=[z,T,i,L,n,a,p,u]}return Yk[f]=M}function wa(e){var n=Wk.call(e);if(Gk[n])return Gk[n];var a=e[0],i=e[1],d=e[2],r=e[3],o=e[4],l=e[5],s=e[6],f=e[7],c=f*o,p=-s*l,u=s*o,g=f*l,h=Bx(d),m=Ix(d),y=Bx(r),b=Ix(r),_=0.5*(r-d),x=Ix(0.5*_),v=8/3*x*x/Ix(_),t=a+h-v*m,k=i+m+v*h,w=a+y,S=i+b,E=w+v*b,C=S-v*y;return Gk[n]=[c*t+p*k,u*t+g*k,c*E+p*C,u*E+g*C,c*w+p*S,u*w+g*S]}function Sa(e,t){var a=Hk[0]=e[0];if('a'===a||'A'===a)Hk[1]=t*e[1],Hk[2]=t*e[2],Hk[6]=t*e[6],Hk[7]=t*e[7];else for(var d=1,i=e.length;d<i;++d)Hk[d]=t*e[d];return Hk}function Ea(e,n,a,d,t){var r=null,o=0,l=0,s=0,f=0,c,p,u,g,h;null==a&&(a=0),null==d&&(d=0),null==t&&(t=1),e.beginPath&&e.beginPath();for(var m=0,i=n.length;m<i;++m){switch(c=n[m],1!==t&&(c=Sa(c,t)),c[0]){case'l':o+=c[1],l+=c[2],e.lineTo(o+a,l+d);break;case'L':o=c[1],l=c[2],e.lineTo(o+a,l+d);break;case'h':o+=c[1],e.lineTo(o+a,l+d);break;case'H':o=c[1],e.lineTo(o+a,l+d);break;case'v':l+=c[1],e.lineTo(o+a,l+d);break;case'V':l=c[1],e.lineTo(o+a,l+d);break;case'm':o+=c[1],l+=c[2],e.moveTo(o+a,l+d);break;case'M':o=c[1],l=c[2],e.moveTo(o+a,l+d);break;case'c':p=o+c[5],u=l+c[6],s=o+c[3],f=l+c[4],e.bezierCurveTo(o+c[1]+a,l+c[2]+d,s+a,f+d,p+a,u+d),o=p,l=u;break;case'C':o=c[5],l=c[6],s=c[3],f=c[4],e.bezierCurveTo(c[1]+a,c[2]+d,s+a,f+d,o+a,l+d);break;case's':p=o+c[3],u=l+c[4],s=2*o-s,f=2*l-f,e.bezierCurveTo(s+a,f+d,o+c[1]+a,l+c[2]+d,p+a,u+d),s=o+c[1],f=l+c[2],o=p,l=u;break;case'S':p=c[3],u=c[4],s=2*o-s,f=2*l-f,e.bezierCurveTo(s+a,f+d,c[1]+a,c[2]+d,p+a,u+d),o=p,l=u,s=c[1],f=c[2];break;case'q':p=o+c[3],u=l+c[4],s=o+c[1],f=l+c[2],e.quadraticCurveTo(s+a,f+d,p+a,u+d),o=p,l=u;break;case'Q':p=c[3],u=c[4],e.quadraticCurveTo(c[1]+a,c[2]+d,p+a,u+d),o=p,l=u,s=c[1],f=c[2];break;case't':p=o+c[1],u=l+c[2],null===r[0].match(/[QqTt]/)?(s=o,f=l):'t'===r[0]?(s=2*o-g,f=2*l-h):'q'===r[0]&&(s=2*o-s,f=2*l-f),g=s,h=f,e.quadraticCurveTo(s+a,f+d,p+a,u+d),o=p,l=u,s=o+c[1],f=l+c[2];break;case'T':p=c[1],u=c[2],s=2*o-s,f=2*l-f,e.quadraticCurveTo(s+a,f+d,p+a,u+d),o=p,l=u;break;case'a':Ca(e,o+a,l+d,[c[1],c[2],c[3],c[4],c[5],c[6]+o+a,c[7]+l+d]),o+=c[6],l+=c[7];break;case'A':Ca(e,o+a,l+d,[c[1],c[2],c[3],c[4],c[5],c[6]+a,c[7]+d]),o=c[6],l=c[7];break;case'z':case'Z':e.closePath();}r=c}}function Ca(e,t,n,a){for(var d=ka(a[5],a[6],a[0],a[1],a[3],a[4],a[2],t,n),r=0,i;r<d.length;++r)i=wa(d[r]),e.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5])}function za(e){return Vk.hasOwnProperty(e)?Vk[e]:Ta(e)}function Ta(e){if(!Jk.hasOwnProperty(e)){var t=va(e);Jk[e]={draw:function(e,n){Ea(e,t,0,0,Hx(n)/2)}}}return Jk[e]}function Ra(e){return e.x}function Aa(e){return e.y}function Oa(e){return e.width}function Pa(e){return e.height}function Ma(e){return function(){return e}}function Da(){function e(e,o,l){var s=null==o?+t.call(this,e):o,f=null==l?+n.call(this,e):l,c=+a.call(this,e),p=+i.call(this,e),u=+d.call(this,e),g;if(r||(r=g=Tn()),0>=u)r.rect(s,f,c,p);else{var h=s+c,m=f+p;r.moveTo(s+u,f),r.lineTo(h-u,f),r.quadraticCurveTo(h,f,h,f+u),r.lineTo(h,m-u),r.quadraticCurveTo(h,m,h-u,m),r.lineTo(s+u,m),r.quadraticCurveTo(s,m,s,m-u),r.lineTo(s,f+u),r.quadraticCurveTo(s,f,s+u,f),r.closePath()}return g?(r=null,g+''||null):void 0}var t=Ra,n=Aa,a=Oa,i=Pa,d=Ma(0),r=null;return e.x=function(n){return arguments.length?(t='function'===typeof n?n:Ma(+n),e):t},e.y=function(t){return arguments.length?(n='function'===typeof t?t:Ma(+t),e):n},e.width=function(t){return arguments.length?(a='function'===typeof t?t:Ma(+t),e):a},e.height=function(t){return arguments.length?(i='function'===typeof t?t:Ma(+t),e):i},e.cornerRadius=function(t){return arguments.length?(d='function'===typeof t?t:Ma(+t),e):d},e.context=function(t){return arguments.length?(r=null==t?null:t,e):r},e}function La(){function e(e,r,o){var l=o/2;if(f){var s=i-r,c=e-n;if(s||c){var p=Hx(s*s+c*c),u=(s/=p)*d,g=(c/=p)*d,h=jx(c,s);a.moveTo(n-u,i-g),a.lineTo(e-s*l,r-c*l),a.arc(e,r,l,h-Zk,h),a.lineTo(n+u,i+g),a.arc(n,i,d,h,h+Zk)}else a.arc(e,r,l,0,2*Zk);a.closePath()}else f=1;n=e,i=r,d=l}function t(t){var c=t.length,n=!1,p,i,d;for(null==a&&(a=d=Tn()),p=0;p<=c;++p)!(p<c&&s(i=t[p],p,t))===n&&(n=!n)&&(f=0),n&&e(+r(i,p,t),+o(i,p,t),+l(i,p,t));if(d)return a=null,d+''||null}var a=null,r,o,l,s,f,n,i,d;return t.x=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(o=e,t):o},t.size=function(e){return arguments.length?(l=e,t):l},t.defined=function(e){return arguments.length?(s=e,t):s},t.context=function(e){return arguments.length?(a=null==e?null:e,t):a},t}function qa(e){return e.x||0}function x(e){return e.y||0}function y(e){return e.cornerRadius||0}function Ua(e){return!1!==e.defined}function Fa(e){return null==e.size?64:e.size}function ja(e,t,n,a){return nw.context(e)(t,n,a)}function $a(e,t){return t.stroke&&0!==t.opacity&&0!==t.strokeOpacity&&e.expand(null==t.strokeWidth?1:+t.strokeWidth),e}function Na(e){return ow=e,Na}function Ia(){}function Ba(e,t){ow.add(e,t)}function Ya(e,t,a){for(var d=a.width(),r=a.height(),o=a.x1+t.x1*d,l=a.y1+t.y1*r,s=a.x1+t.x2*d,f=a.y1+t.y2*r,c=t.stops,p=0,i=c.length,n=e.createLinearGradient(o,l,s,f);p<i;++p)n.addColorStop(c[p].offset,c[p].color);return n}function Ga(e,t,n){return n.id?Ya(e,n,t.bounds):n}function Wa(e,t,n){return n*=null==t.fillOpacity?1:t.fillOpacity,!!(0<n)&&(e.globalAlpha=n,e.fillStyle=Ga(e,t,t.fill),!0)}function Ha(e,t,n){var a=null==(a=t.strokeWidth)?1:a;return!(0>=a)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity,!!(0<n)&&(e.globalAlpha=n,e.strokeStyle=Ga(e,t,t.stroke),e.lineWidth=a,e.lineCap=t.strokeCap||'butt',e.lineJoin=t.strokeJoin||'miter',e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||sw),e.lineDashOffset=t.strokeDashOffset||0),!0))}function Xa(e,t){return e.zindex-t.zindex||e.index-t.index}function Va(e){if(!e.zdirty)return e.zitems;var t=e.items,a=[],d,r,i;for(r=0,i=t.length;r<i;++r)d=t[r],d.index=r,d.zindex&&a.push(d);return e.zdirty=!1,e.zitems=a.sort(Xa)}function Ja(e,t){var a=e.items,d,i;if(a&&a.length){var n=Va(e);if(n&&n.length){for(d=0,i=a.length;d<i;++d)a[d].zindex||t(a[d]);a=n}for(d=0,i=a.length;d<i;++d)t(a[d])}}function Za(e,t){var n=e.items,a,d;if(!n||!n.length)return null;var i=Va(e);for(i&&i.length&&(n=i),d=n.length;0<=--d;)if(a=t(n[d]))return a;if(n===i)for(n=e.items,d=n.length;0<=--d;)if(!n[d].zindex&&(a=t(n[d])))return a;return null}function Ka(e){return function(t,n,a){Ja(n,function(n){(!a||a.intersects(n.bounds))&&ei(e,t,n,n)})}}function Qa(e){return function(t,n,a){n.items.length&&(!a||a.intersects(n.bounds))&&ei(e,t,n.items[0],n.items)}}function ei(e,t,n,a){var i=null==n.opacity?1:n.opacity;0===i||e(t,a)||(n.fill&&Wa(t,n,i)&&t.fill(),n.stroke&&Ha(t,n,i)&&t.stroke())}function ti(e){return e||(e=lw),function(t,n,a,i,d,r){return 1<t.pixelRatio&&(a*=t.pixelRatio,i*=t.pixelRatio),Za(n,function(n){var o=n.bounds;return(!o||o.contains(d,r))&&o?e(t,n,a,i,d,r)?n:void 0:void 0})}}function ni(e,t){return function(n,a,i,d){var r=Array.isArray(a)?a[0]:a,o=null==t?r.fill:t,l=r.stroke&&n.isPointInStroke,s,f;return l&&(s=r.strokeWidth,f=r.strokeCap,n.lineWidth=null==s?1:s,n.lineCap=null==f?'butt':f),!e(n,a)&&(o&&n.isPointInPath(i,d)||l&&n.isPointInStroke(i,d))}}function ai(e){return ti(ni(e))}function ii(e,t){return'translate('+e+','+t+')'}function di(e){return ii(e.x||0,e.y||0)}function ri(e,t){function n(e,n){var a=n.x||0,i=n.y||0;e.translate(a,i),e.beginPath(),t(e,n),e.translate(-a,-i)}return{type:e,tag:'path',nested:!1,attr:function(e,n){e('transform',di(n)),e('d',t(null,n))},bound:function(e,n){return t(Na(e),n),$a(e,n).translate(n.x||0,n.y||0)},draw:Ka(n),pick:ai(n)}}function oi(e,t){function n(e,n){e.beginPath(),t(e,n)}var a=ni(n);return{type:e,tag:'path',nested:!0,attr:function(e,n){var a=n.mark.items;a.length&&e('d',t(null,a))},bound:function(e,n){var a=n.items;return 0===a.length?e:(t(Na(e),a),$a(e,a[0]))},draw:Qa(n),pick:function(e,t,n,i,d,r){var o=t.items,l=t.bounds;return o&&o.length&&(!l||l.contains(d,r))?(1<e.pixelRatio&&(n*=e.pixelRatio,i*=e.pixelRatio),a(e,o,n,i)?o[0]:null):null}}}function li(e,t,n){var a=e._defs,i=t.clip_id||(t.clip_id='clip'+a.clip_id++),d=a.clipping[i]||(a.clipping[i]={id:i});return d.width=n.width||0,d.height=n.height||0,'url(#'+i+')'}function si(e,t,n){return(!1!==e.interactive||'group'===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}function fi(e,t){var n=e.image;return n&&n.url===e.url||(n={loaded:!1,width:0,height:0},t.loadImage(e.url).then(function(t){e.image=t,e.image.url=e.url})),n}function ci(e,t){return'center'===e?t/2:'right'===e?t:0}function ui(e,t){return'middle'===e?t/2:'bottom'===e?t:0}function gi(e,t){var n=t.path;if(null==n)return!0;var a=t.pathCache;a&&a.path===n||((t.pathCache=a=va(n)).path=n),Ea(e,a,t.x,t.y)}function hi(e,t){e.beginPath(),ja(e,t)}function mi(e,t,n){var a,i,d,r;return t.stroke&&Ha(e,t,n)&&(a=t.x||0,i=t.y||0,d=null==t.x2?a:t.x2,r=null==t.y2?i:t.y2,e.beginPath(),e.moveTo(a,i),e.lineTo(d,r),!0)}function yi(e){return kw=vi(e),bi(wi(e))}function bi(e){return~~(0.8*e.length*kw)}function _i(e){return vw.font=Ei(e),xi(wi(e))}function xi(e){return vw.measureText(e).width}function vi(e){return null==e.fontSize?11:e.fontSize}function ki(e){vw=e?(vw=wn(1,1))?vw.getContext('2d'):null:null,xw.width=vw?_i:yi}function wi(e){var t=e.text;return null==t?'':0<e.limit?Si(e):t+''}function Si(e){var t=+e.limit,n=e.text+'',a=vw?(vw.font=Ei(e),xi):(kw=vi(e),bi);if(a(n)<t)return n;var i=e.ellipsis||'\u2026',d='rtl'===e.dir,r=0,o=n.length,l;if(t-=a(i),d){for(;r<o;)l=r+o>>>1,a(n.slice(l))>t?r=l+1:o=l;return i+n.slice(r)}for(;r<o;)l=1+(r+o>>>1),a(n.slice(0,l))<t?r=l:o=l-1;return n.slice(0,r)+i}function Ei(e,t){var n=e.font;return t&&n&&(n=(n+'').replace(/\"/g,'\'')),''+(e.fontStyle?e.fontStyle+' ':'')+(e.fontVariant?e.fontVariant+' ':'')+(e.fontWeight?e.fontWeight+' ':'')+vi(e)+'px '+(n||'sans-serif')}function Ci(e){var t=e.baseline,n=vi(e);return ev('top'===t?0.93*n:'middle'===t?0.3*n:'bottom'===t?-0.21*n:0)}function zi(e,n,i){var d=xw.height(n),o=n.align,a=n.radius||0,r=n.x||0,l=n.y||0,s=n.dx||0,f=(n.dy||0)+Ci(n)-ev(0.8*d),c,p;return a&&(p=(n.theta||0)-Gx/2,r+=a*Bx(p),l+=a*Ix(p)),c=xw.width(n),'center'===o?s-=c/2:'right'===o&&(s-=c),e.set(s+=r,f+=l,s+c,f+d),n.angle&&!i&&e.rotate(n.angle*Gx/180,r,l),e.expand(i?0:1)}function Ti(e,t,n){var a=zw[e.mark.marktype],i=t||a.bound;a.nested&&(e=e.mark);var d=e.bounds,r=e.bounds_prev||(e.bounds_prev=new gn);return d?(r.clear().union(d),d.clear()):e.bounds=new gn,i(e.bounds,e,n),d||r.clear().union(e.bounds),e.bounds}function Ri(e,t,a){var d=zw[e.marktype],r=d.bound,o=e.items,l=o&&o.length,s,i,n,f;if(d.nested)return n=l?o[0]:(Tw.mark=e,Tw),f=Ti(n,r,a),t=t&&t.union(f)||f,t;if(t=t||e.bounds&&e.bounds.clear()||new gn,l)for(s=0,i=o.length;s<i;++s)t.union(Ti(o[s],r,a));return e.bounds=t}function Ai(e,t){return JSON.stringify(e,Rw,t)}function Oi(e){var t='string'===typeof e?JSON.parse(e):e;return Pi(t)}function Pi(e){var t=e.marktype,a=e.items,d,r,i;if(a)for(r=0,i=a.length;r<i;++r)d=t?'mark':'group',a[r][d]=e,a[r].zindex&&(a[r][d].zdirty=!0),'group'===(t||d)&&Pi(a[r]);return t&&Ri(e),e}function Mi(e){arguments.length?this.root=Oi(e):(this.root=Di({marktype:'group',name:'root',role:'frame'}),this.root.items=[new yn(this.root)])}function Di(e,t){return{bounds:new gn,bounds_prev:new gn,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0}}function Li(e){this._active=null,this._handlers={},this._loader=e||Ue()}function qi(e){this._el=null,this._bgcolor=null,this._loader=new Sn(e)}function Ui(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Fi(e){Li.call(this,e),this._down=null,this._touch=null,this._first=!0}function ji(e,t,n){return function(i){var d=this._active,r=this.pickEvent(i);r===d?this.fire(e,i):((!d||!d.exit)&&this.fire(n,i),this._active=r,this.fire(t,i),this.fire(e,i))}}function $i(e){return function(t){this.fire(e,t),this._active=null}}function Ni(e,t){var n=t.group;e.save(),e.beginPath(),e.rect(0,0,n.width||0,n.height||0),e.clip()}function Ii(e,t,n,a){var i='undefined'!==typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,d=e.getContext('2d'),r=i?Dw:1;return e.width=t*r,e.height=n*r,1!==r&&(e.style.width=t+'px',e.style.height=n+'px'),d.pixelRatio=r,d.setTransform(r,0,0,r,r*a[0],r*a[1]),e}function Bi(e){qi.call(this,e),this._redraw=!1}function Yi(e,t){var a=new gn,d,i,n,r,o;for(d=0,i=t.length;d<i;++d)n=t[d],r=n.mark,o=r.group,n=zw[r.marktype].nested?r:n,a.union(Gi(n.bounds,o)),n.bounds_prev&&a.union(Gi(n.bounds_prev,o));return a.expand(1).round(),e.beginPath(),e.rect(a.x1,a.y1,a.width(),a.height()),e.clip(),a}function Gi(e,t){if(null==t)return e;for(var n=Uw.clear().union(e);null!=t;t=t.mark.group)n.translate(t.x||0,t.y||0);return n}function Wi(e){Li.call(this,e);var t=this;t._hrefHandler=Hi(t,function(e,n){n&&n.href&&t.handleHref(e,n,n.href)}),t._tooltipHandler=Hi(t,function(e,n){n&&n.tooltip&&t.handleTooltip(e,n,'mouseover'===e.type?n.tooltip:null)})}function Hi(e,t){return function(n){var a=n.target,i=a.__data__;n.vegaType=n.type,i=Array.isArray(i)?i[0]:i,t.call(e._obj,n,i)}}function Xi(e,t,n){var a='<'+e,i,d;if(t)for(i in t)d=t[i],null!=d&&(a+=' '+i+'="'+d+'"');return n&&(a+=' '+n),a+'>'}function Vi(e){return'</'+e+'>'}function Ji(e){qi.call(this,e),this._dirtyID=0,this._svg=null,this._root=null,this._defs=null}function Zi(e,t,a){var d,i,n;for(e=xn(e,a,'linearGradient',Iw),e.setAttribute('id',t.id),e.setAttribute('x1',t.x1),e.setAttribute('x2',t.x2),e.setAttribute('y1',t.y1),e.setAttribute('y2',t.y2),(d=0,i=t.stops.length);d<i;++d)n=xn(e,d,'stop',Iw),n.setAttribute('offset',t.stops[d].offset),n.setAttribute('stop-color',t.stops[d].color);vn(e,d)}function Ki(e,t,n){var a;e=xn(e,n,'clipPath',Iw),e.setAttribute('id',t.id),a=xn(e,0,'rect',Iw),a.setAttribute('x',0),a.setAttribute('y',0),a.setAttribute('width',t.width),a.setAttribute('height',t.height)}function Qi(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function ed(e,t,n){t=t.lastChild;var a=0,i;Ja(n,function(n){i=e.draw(t,n,i),++a}),vn(t,1+a)}function td(e,t,n,a){var i=e._svg,d;if(!i&&(d=t.ownerDocument,i=bn(d,a,Iw),e._svg=i,e.mark&&(i.__data__=e,i.__values__={fill:'default'},'g'===a))){var r=bn(d,'path',Iw);r.setAttribute('class','background'),i.appendChild(r),r.__data__=e;var o=bn(d,'g',Iw);i.appendChild(o),o.__data__=e}return(d||i.previousSibling!==n)&&t.insertBefore(i,n?n.nextSibling:t.firstChild),i}function nd(e,t,n){t===Gw[e]||(null==t?n?Yw.removeAttributeNS(n,e):Yw.removeAttribute(e):n?Yw.setAttributeNS(n,e,t):Yw.setAttribute(e,t),Gw[e]=t)}function ad(){return'undefined'===typeof window?'':window.location.href}function dd(e){qi.call(this,e),this._text={head:'',root:'',foot:'',defs:'',body:''},this._defs={clip_id:1,gradient:{},clipping:{}}}function rd(e,t,n,a){Vw[a||e]=t}function od(e,t,a,d){if(null==e)return'';var r='',o,i,n,l,s;for('bgrect'===a&&!1===t.interactive&&(r+='pointer-events: none;'),'text'===a&&(r+='font: '+Ei(e)+';'),(o=0,i=Nw.length);o<i;++o)n=Nw[o],l=$w[n],s=e[n],null==s?'fill'===l&&(r+=(r.length?' ':'')+'fill: none;'):(s.id&&(d.gradient[s.id]=s,s='url(#'+s.id+')'),r+=(r.length?' ':'')+l+': '+s+';');return r?'style="'+r+'"':null}function ld(e){return e.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}function sd(e,t){return e=((e||'')+'').toLowerCase(),1<arguments.length?(tS[e]=t,this):tS[e]}function fd(e,t,n){return!(e!==t)||('path'===n?cd(e,t):e instanceof Date&&t instanceof Date?+e===+t:ae(e)&&ae(t)?Vx(e-t)<=nS:e&&t&&(N(e)||N(t))?null==e||null==t?!1:pd(e,t):e==t)}function cd(e,t){return fd(va(e),va(t))}function pd(e,t){var n=Object.keys(e),d=Object.keys(t),r,o;if(n.length!==d.length)return!1;for(n.sort(),d.sort(),o=n.length-1;0<=o;o--)if(n[o]!=d[o])return!1;for(o=n.length-1;0<=o;o--)if(r=n[o],!fd(e[r],t[r],r))return!1;return typeof e===typeof t}function ud(e){var t=e||id,n=[],a={};return n.add=function(e){var i=t(e);return a[i]||(a[i]=1,n.push(e)),n},n.remove=function(e){var i=t(e),d;return a[i]&&(a[i]=0,0<=(d=n.indexOf(e))&&n.splice(d,1)),n},n}function gd(e){return e._id}function hd(e,t){for(var n in e)'_id'!==n&&(t[n]=e[n]);return t}function md(e){var t=e===Object(e)?e:{data:e};return t._id||(t._id=++aS),t}function yd(e){return md(hd(e,{}))}function bd(e,t){return hd(e,t)}function _d(e,t){return t._id=e._id,t}function xd(e){return e&&e.constructor===vd}function vd(){var e=[],r=[],a=[],o=[],d=[];return{constructor:vd,insert:function(a){for(var t=H(a),d=0,i=t.length;d<i;++d)e.push(t[d]);return this},remove:function(e){for(var t=V(e)?o:r,a=H(e),d=0,i=a.length;d<i;++d)t.push(a[d]);return this},modify:function(e,t,n){var i={field:t,value:J(n)};return V(e)?(i.filter=e,d.push(i)):(i.tuple=e,a.push(i)),this},encode:function(e,n){return a.push({tuple:e,field:n}),this},pulse:function(l,s){function c(e,t,n){n?e[t]=n(e):l.encode=t,p[e._id]=e}var p,u,i,n,g,f,t;for(u=0,i=e.length;u<i;++u)l.add.push(md(e[u]));for(p={},u=0,i=r.length;u<i;++u)f=r[u],p[f._id]=f;for(u=0,i=o.length;u<i;++u)g=o[u],s.forEach(function(e){g(e)&&(p[e._id]=e)});for(t in p)l.rem.push(p[t]);for(p={},u=0,i=a.length;u<i;++u)n=a[u],c(n.tuple,n.field,n.value),l.modifies(n.field);for(u=0,i=d.length;u<i;++u)n=d[u],g=n.filter,s.forEach(function(e){g(e)&&c(e,n.field,n.value)}),l.modifies(n.field);for(t in p)l.mod.push(p[t]);return l}}}function kd(){Object.defineProperty(this,iS,{writable:!0,value:{}})}function wd(e,t,n,a){this.id=++rS,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,a)}function Sd(e){return function(t){var n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}function Ed(e,t,n){this.id=++sS,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Cd(e,t,n){return new Ed(e,t,n)}function zd(n,e,a,t,i,d){var r=Z({},d,cS),o,l;V(a)||(a=J(a)),t===void 0?o=function(t){n.touch(a(t))}:V(t)?(l=new wd(null,t,i,!1),o=function(i){var e=a(i),t=(l.evaluate(i),l.value);xd(t)?n.pulse(e,t,d):n.update(e,t,r)}):o=function(i){n.update(a(i),t,r)},e.apply(o)}function Td(e,t,n,a,i,d){var r,o;a===void 0?o=n:(r=V(a)?a:J(a),a=n?function(e,t){var a=r(e,t);return n.skip()?a:n.skip(!0).value=a}:r,o=new wd(null,a,i,!1),o.modified(d&&d.force),o.rank=0,n&&(o.skip(!0),o.value=n.value,o.targets().add(n))),t.targets().add(o)}function Rd(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Ad(e,n){return e?function(a,t){return e(a,t)&&n(a,t)}:n}function Od(e,t){var n={};return e.visit(t,function(e){n[e._id]=1}),function(e){return n[e._id]?null:e}}function Pd(e){var t=new Promise(function(e,t){n=e,i=t}),n,i;return t.requests=0,t.done=function(){0===--t.requests&&e.runAfter(function(){e._pending=null;try{e.run(),n(e)}catch(e){i(e)}})},e._pending=t}function Md(e,t,a,d){var r=this,o=0,l,s,c,i,n;for(this.dataflow=e,this.stamp=t,this.fields=null,this.encode=d||null,this.pulses=a,(c=0,i=a.length);c<i;++c)if(l=a[c],l.stamp===t){if(l.fields)for(n in s=r.fields||(r.fields={}),l.fields)s[n]=1;l.changed(r.ADD)&&(o|=r.ADD),l.changed(r.REM)&&(o|=r.REM),l.changed(r.MOD)&&(o|=r.MOD)}this.changes=o}function Dd(e){this.cmp=e,this.nodes=[]}function Ld(e,t,n,a){var i,d,r;for(i=e[n];n>t;){if(r=n-1>>1,d=e[r],0>a(i,d)){e[n]=d,n=r;continue}break}return e[n]=i}function qd(e,t,n){for(var a=t,i=e.length,d=e[t],r=2*t+1,o;r<i;)o=r+1,o<i&&0<=n(e[r],e[o])&&(r=o),e[t]=e[r],t=r,r=2*t+1;return e[t]=d,Ld(e,a,t,n)}function Ud(){this._log=W(),this._clock=0,this._rank=0,this._loader=Ue(),this._touched=ud(pv),this._pulses={},this._pulse=null,this._heap=new Dd(function(e,t){return e.qrank-t.qrank}),this._postrun=[]}function Fd(e){return function(){return this._log[e].apply(this,arguments)}}function jd(e,t){wd.call(this,e,null,t)}function $d(e,t){var n=e.type;Nd(n,e),Id(n,t)}function Nd(e,t){return e=e&&e.toLowerCase(),1<arguments.length?(RS[e]=t,this):RS.hasOwnProperty(e)?RS[e]:null}function Id(e,t){return 1<arguments.length?(TS[e]=t,this):TS.hasOwnProperty(e)?TS[e]:null}function Bd(e){this._key=e||'_id',this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null}function Yd(e,t){return OS[e](t)}function Gd(e){return function(t){var n=Z({init:'',add:'',rem:'',idx:0},e);return n.out=t||e.name,n}}function Wd(e,t){return e.idx-t.idx}function Hd(e,t){function n(e,i){function a(t){e[t]||n(e,e[t]=OS[t]())}return i.req&&i.req.forEach(a),t&&i.str&&i.str.forEach(a),e}var a=e.reduce(n,e.reduce(function(e,t){return e[t.name]=t,e},{})),i=[],d;for(d in a)i.push(a[d]);return i.sort(Wd)}function Xd(e,t){var n=Hd(e,!0),i='this.cell = cell; this.tuple = t; this.valid = 0; this.missing = 0;',d='if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;',r='if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;',o='var t = this.tuple; var cell = this.cell;';return n.forEach(function(e){0>e.idx?(i=e.init+i,d=e.add+d,r=e.rem+r):(i+=e.init,d+=e.add,r+=e.rem)}),e.slice().sort(Wd).forEach(function(e){o+='t[\''+e.out+'\']='+e.set+';'}),o+='return t;',i=Function('cell','t',i),i.prototype.add=Function('v','t',d),i.prototype.rem=Function('v','t',r),i.prototype.set=Function(o),i.prototype.get=t||id,i.fields=e.map(function(e){return e.out}),i}function Vd(e){jd.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function Jd(e,t,n){return n||e+(t?'_'+t:'')}function Zd(e){var t=this._dims,a=t.length,n=t[0](e)+'',d;for(d=1;d<a;++d)n+='|'+t[d](e);return n}function Kd(e){jd.call(this,null,e)}function Qd(e){jd.call(this,[],e)}function er(e){wd.call(this,null,tr,e)}function tr(e){return this.value&&!e.modified()?this.value:X(e.fields,e.orders)}function nr(e){jd.call(this,null,e)}function ar(e,t,n){return'upper'===t?e=e.toUpperCase():'lower'===t?e=e.toLowerCase():void 0,e.match(n)}function ir(e){jd.call(this,null,e)}function dr(e,d,a,r){for(var o=[],l={},t=e.length,n=0,i,s;n<t;++n)for(l[d]=s=e[n],i=0;i<t;++i)l[a]=e[i],r(l)&&(o.push(md(l)),l={},l[d]=s);return o}function rr(e,t){var n=e[jS];US.hasOwnProperty(n)||F('Unknown distribution function: '+n);var a=US[n]();for(var i in e)i===$S?a.data((e.from||t()).map(e[i])):i===FS?a[i](e[i].map(function(e){return rr(e,t)})):typeof a[i]===jS&&a[i](e[i]);return a}function or(e){jd.call(this,null,e)}function lr(e){return function(){return e.materialize(e.SOURCE).source}}function sr(e){jd.call(this,[+Infinity,-Infinity],e)}function fr(e,t){wd.call(this,e),this.parent=t}function cr(e){jd.call(this,{},e),this._keys=Q();var t=this._targets=[];t.active=0,t.forEach=function(e){for(var a=0,i=t.active;a<i;++a)e(t[a],a,t)}}function pr(e){wd.call(this,null,ur,e)}function ur(e){return this.value&&!e.modified()?this.value:fv(e.name)?H(e.name).map(function(e){return $(e)}):$(e.name,e.as)}function gr(e){jd.call(this,Q(),e)}function hr(e){jd.call(this,{},e)}function mr(e){return e.fields.join('|')}function yr(e){jd.call(this,null,e)}function br(e){jd.call(this,[],e)}function _r(e){jd.call(this,[],e)}function xr(e){var t=e.method||VS.value,n;return null==VS[t]?void F('Unrecognized imputation method: '+t):t===VS.value?(n=void 0===e.value?0:e.value,function(){return n}):VS[t]}function vr(e){var n=e.field;return function(e){return e?n(e):NaN}}function wr(e,a,d){var r=function(e){return e(n)},o=[],l=[],s={},f={},c,p,u,g,h,m,i,y,n;for(m=0,y=e.length;m<y;++m)n=e[m],p=(c=d.map(r))+'',i=s[p]||(s[p]=l.push(c)),g=(u=a?a.map(r):JS)+'',(h=f[g])||(h=f[g]=[],o.push(h),h.values=u),h[i-1]=n;return o.domain=l,o}function Sr(e){wd.call(this,null,Er,e)}function Er(e){return this.value&&!e.modified()?this.value:de(e.fields)}function Cr(e){jd.call(this,{},e)}function zr(e){wd.call(this,null,Tr,e)}function Tr(t){if(this.value&&!t.modified())return this.value;var a=+Infinity,d=-Infinity,r=t.extents,o,i,n;for(o=0,i=r.length;o<i;++o)n=r[o],n[0]<a&&(a=n[0]),n[1]>d&&(d=n[1]);return[a,d]}function Rr(e){wd.call(this,null,Ar,e)}function Ar(e){return this.value&&!e.modified()?this.value:e.values.reduce(function(e,t){return e.concat(t)},[])}function Or(e){jd.call(this,null,e)}function Pr(e){cr.call(this,e)}function Mr(e){jd.call(this,null,e)}function Dr(e){jd.call(this,null,e)}function Lr(e){jd.call(this,null,e)}function qr(e){jd.call(this,[],e),this.count=0}function Ur(e){jd.call(this,null,e)}function Fr(e){jd.call(this,null,e),this.modified(!0)}function jr(e){jd.call(this,Q(),e)}function $r(e){jd.call(this,null,e)}function Nr(e){return function(n){var a=n[0],i=n[1],d;return i<a&&(d=a,a=i,i=d),[e.invert(a),e.invert(i)]}}function Ir(e){return function(a){var d=e.range(),r=a[0],o=a[1],l=-1,s,f,t,i;for(o<r&&(f=r,r=o,o=f),t=0,i=d.length;t<i;++t)d[t]>=r&&d[t]<=o&&(0>l&&(l=t),s=t);if(!(0>l))return r=e.invertExtent(d[l]),o=e.invertExtent(d[s]),[void 0===r[0]?r[1]:r[0],void 0===o[1]?o[0]:o[1]]}}function Br(e,t,n){var a=e-t+2*n;return e?0<a?a:1:0}function Yr(e){function t(t){var d=t+'',o=a.get(d);if(!o){if(n!==uE)return n;a.set(d,o=r.push(t))}return e[(o-1)%e.length]}var a=_e(),r=[],n=uE;return e=null==e?[]:pE.call(e),t.domain=function(e){if(!arguments.length)return r.slice();r=[],a=_e();for(var o=-1,i=e.length,n,d;++o<i;)a.has(d=(n=e[o])+'')||a.set(d,r.push(n));return t},t.range=function(n){return arguments.length?(e=pE.call(n),t):e.slice()},t.unknown=function(e){return arguments.length?(n=e,t):n},t.copy=function(){return Yr().domain(r).range(e).unknown(n)},t}function Gr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Wr(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function Hr(){}function Xr(e){var t;return e=(e+'').trim().toLowerCase(),(t=mE.exec(e))?(t=parseInt(t[1],16),new Qr(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1)):(t=yE.exec(e))?Vr(parseInt(t[1],16)):(t=bE.exec(e))?new Qr(t[1],t[2],t[3],1):(t=_E.exec(e))?new Qr(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=xE.exec(e))?Jr(t[1],t[2],t[3],t[4]):(t=vE.exec(e))?Jr(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=kE.exec(e))?eo(t[1],t[2]/100,t[3]/100,1):(t=wE.exec(e))?eo(t[1],t[2]/100,t[3]/100,t[4]):SE.hasOwnProperty(e)?Vr(SE[e]):'transparent'===e?new Qr(NaN,NaN,NaN,0):null}function Vr(e){return new Qr(255&e>>16,255&e>>8,255&e,1)}function Jr(e,t,n,i){return 0>=i&&(e=t=n=NaN),new Qr(e,t,n,i)}function Zr(e){return(e instanceof Hr||(e=Xr(e)),!e)?new Qr:(e=e.rgb(),new Qr(e.r,e.g,e.b,e.opacity))}function Kr(e,t,n,a){return 1===arguments.length?Zr(e):new Qr(e,t,n,null==a?1:a)}function Qr(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function eo(e,t,n,i){return 0>=i?e=t=n=NaN:0>=n||1<=n?e=t=NaN:0>=t&&(e=NaN),new ao(e,t,n,i)}function to(e){if(e instanceof ao)return new ao(e.h,e.s,e.l,e.opacity);if(e instanceof Hr||(e=Xr(e)),!e)return new ao;if(e instanceof ao)return e;e=e.rgb();var t=e.r/255,n=e.g/255,a=e.b/255,i=Zx(t,n,a),d=nv(t,n,a),r=NaN,f=d-i,s=(d+i)/2;return f?(r=t===d?(n-a)/f+6*(n<a):n===d?(a-t)/f+2:(t-n)/f+4,f/=0.5>s?d+i:2-d-i,r*=60):f=0<s&&1>s?0:r,new ao(r,f,s,e.opacity)}function no(e,t,n,a){return 1===arguments.length?to(e):new ao(e,t,n,null==a?1:a)}function ao(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function io(e,t,n){return 255*(60>e?t+(n-t)*e/60:180>e?n:240>e?t+(n-t)*(240-e)/60:t)}function ro(e){if(e instanceof lo)return new lo(e.l,e.a,e.b,e.opacity);if(e instanceof ho){var t=e.h*EE;return new lo(e.l,Bx(t)*e.c,Ix(t)*e.c,e.opacity)}e instanceof Qr||(e=Zr(e));var n=po(e.r),i=po(e.g),a=po(e.b),d=so((0.4124564*n+0.3575761*i+0.1804375*a)/Kn),r=so((0.2126729*n+0.7151522*i+0.072175*a)/Xn),o=so((0.0193339*n+0.119192*i+0.9503041*a)/Yn);return new lo(116*r-16,500*(d-r),200*(r-o),e.opacity)}function oo(e,t,n,a){return 1===arguments.length?ro(e):new lo(e,t,n,null==a?1:a)}function lo(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function so(e){return e>AE?Qx(e,1/3):e/RE+Zn}function fo(e){return e>TE?e*e*e:RE*(e-Zn)}function co(e){return 255*(0.0031308>=e?12.92*e:1.055*Qx(e,1/2.4)-0.055)}function po(e){return 0.04045>=(e/=255)?e/12.92:Qx((e+0.055)/1.055,2.4)}function uo(e){if(e instanceof ho)return new ho(e.h,e.c,e.l,e.opacity);e instanceof lo||(e=ro(e));var t=jx(e.b,e.a)*CE;return new ho(0>t?t+360:t,Hx(e.a*e.a+e.b*e.b),e.l,e.opacity)}function go(e,t,n,a){return 1===arguments.length?uo(e):new ho(e,t,n,null==a?1:a)}function ho(e,t,n,a){this.h=+e,this.c=+t,this.l=+n,this.opacity=+a}function mo(e){if(e instanceof bo)return new bo(e.h,e.s,e.l,e.opacity);e instanceof Qr||(e=Zr(e));var t=e.r/255,n=e.g/255,a=e.b/255,i=(ME*a+E*t-PE*n)/(ME+E-PE),d=a-i,r=(D*(n-i)-B*d)/C,o=Hx(r*r+d*d)/(D*i*(1-i)),l=o?jx(r,d)*CE-120:NaN;return new bo(0>l?l+360:l,o,i,e.opacity)}function yo(e,t,n,a){return 1===arguments.length?mo(e):new bo(e,t,n,null==a?1:a)}function bo(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function _o(e,t,n,a,i){var d=e*e,r=d*e;return((1-3*e+3*d-r)*t+(4-6*d+3*r)*n+(1+3*e+3*d-3*r)*a+r*i)/6}function xo(e){var a=e.length-1;return function(n){var t=0>=n?n=0:1<=n?(n=1,a-1):Kx(n*a),i=e[t],d=e[t+1],r=0<t?e[t-1]:2*i-d,o=t<a-1?e[t+2]:2*d-i;return _o((n-t/a)*a,r,i,d,o)}}function vo(e){var a=e.length;return function(n){var t=Kx((0>(n%=1)?++n:n)*a),i=e[(t+a-1)%a],d=e[t%a],r=e[(t+1)%a],o=e[(t+2)%a];return _o((n-t/a)*a,i,d,r,o)}}function ko(e){return function(){return e}}function wo(e,n){return function(a){return e+a*n}}function So(e,n,a){return e=Qx(e,a),n=Qx(n,a)-e,a=1/a,function(i){return Qx(e+i*n,a)}}function Eo(e,t){var n=t-e;return n?wo(e,180<n||-180>n?n-360*ev(n/360):n):ko(isNaN(e)?t:e)}function Co(e){return 1===(e=+e)?zo:function(t,n){return n-t?So(t,n,e):ko(isNaN(t)?n:t)}}function zo(e,t){var n=t-e;return n?wo(e,n):ko(isNaN(e)?t:e)}function To(e){return function(t){var a=t.length,n=Array(a),d=Array(a),r=Array(a),o,i;for(o=0;o<a;++o)i=Kr(t[o]),n[o]=i.r||0,d[o]=i.g||0,r[o]=i.b||0;return n=e(n),d=e(d),r=e(r),i.opacity=1,function(e){return i.r=n(e),i.g=d(e),i.b=r(e),i+''}}}function Ro(e,t){var n=t?t.length:0,a=e?Zx(n,e.length):0,d=Array(n),r=Array(n),o;for(o=0;o<a;++o)d[o]=qo(e[o],t[o]);for(;o<n;++o)r[o]=t[o];return function(e){for(o=0;o<a;++o)r[o]=d[o](e);return r}}function Ao(e,n){var i=new Date;return e=+e,n-=e,function(a){return i.setTime(e+n*a),i}}function Oo(e,n){return e=+e,n-=e,function(a){return e+n*a}}function Po(e,t){var n={},i={},d;for(d in(null===e||'object'!==typeof e)&&(e={}),(null===t||'object'!==typeof t)&&(t={}),t)d in e?n[d]=qo(e[d],t[d]):i[d]=t[d];return function(e){for(d in n)i[d]=n[d](e);return i}}function Mo(e){return function(){return e}}function Do(e){return function(n){return e(n)+''}}function Lo(e,n){var t=UE.lastIndex=FE.lastIndex=0,a=-1,d=[],r=[],o,l,s;for(e+='',n+='';(o=UE.exec(e))&&(l=FE.exec(n));)(s=l.index)>t&&(s=n.slice(t,s),d[a]?d[a]+=s:d[++a]=s),(o=o[0])===(l=l[0])?d[a]?d[a]+=l:d[++a]=l:(d[++a]=null,r.push({i:a,x:Oo(o,l)})),t=FE.lastIndex;return t<n.length&&(s=n.slice(t),d[a]?d[a]+=s:d[++a]=s),2>d.length?r[0]?Do(r[0].x):Mo(n):(n=r.length,function(e){for(var t=0,a;t<n;++t)d[(a=r[t]).i]=a.x(e);return d.join('')})}function qo(e,n){var a=typeof n,t;return null==n||'boolean'===a?ko(n):('number'===a?Oo:'string'===a?(t=Xr(n))?(n=t,DE):Lo:n instanceof Xr?DE:n instanceof Date?Ao:Array.isArray(n)?Ro:isNaN(n)?Po:Oo)(e,n)}function Uo(e,n){return e=+e,n-=e,function(a){return ev(e+n*a)}}function Fo(t,n,i,r,d,o){var l,s,c;return(l=Hx(t*t+n*n))&&(t/=l,n/=l),(c=t*i+n*r)&&(i-=t*c,r-=n*c),(s=Hx(i*i+r*r))&&(i/=s,r/=s,c/=s),t*r<n*i&&(t=-t,n=-n,c=-c,l=-l),{translateX:d,translateY:o,rotate:jx(n,t)*jE,skewX:Ux(c)*jE,scaleX:l,scaleY:s}}function jo(e,t,n,i){function d(e){return e.length?e.pop()+' ':''}function r(e,a,d,r,o,l){if(e!==d||a!==r){var s=o.push('translate(',null,t,null,n);l.push({i:s-4,x:Oo(e,d)},{i:s-2,x:Oo(a,r)})}else(d||r)&&o.push('translate('+d+t+r+n)}function o(e,t,n,a){e===t?t&&n.push(d(n)+'rotate('+t+i):(180<e-t?t+=360:180<t-e&&(e+=360),a.push({i:n.push(d(n)+'rotate(',null,i)-2,x:Oo(e,t)}))}function l(e,t,n,a){e===t?t&&n.push(d(n)+'skewX('+t+i):a.push({i:n.push(d(n)+'skewX(',null,i)-2,x:Oo(e,t)})}function f(e,t,n,a,r,o){if(e!==n||t!==a){var l=r.push(d(r)+'scale(',null,',',null,')');o.push({i:l-4,x:Oo(e,n)},{i:l-2,x:Oo(t,a)})}else(1!==n||1!==a)&&r.push(d(r)+'scale('+n+','+a+')')}return function(t,n){var a=[],d=[];return t=e(t),n=e(n),r(t.translateX,t.translateY,n.translateX,n.translateY,a,d),o(t.rotate,n.rotate,a,d),l(t.skewX,n.skewX,a,d),f(t.scaleX,t.scaleY,n.scaleX,n.scaleY,a,d),t=n=null,function(e){for(var t=-1,i=d.length,n;++t<i;)a[(n=d[t]).i]=n.x(e);return a.join('')}}}function $o(e){return((e=Wx(e))+1/e)/2}function No(e){return((e=Wx(e))-1/e)/2}function Io(e){return((e=Wx(2*e))-1)/(e+1)}function Bo(e){return function(n,t){var a=e((n=no(n)).h,(t=no(t)).h),i=zo(n.s,t.s),d=zo(n.l,t.l),r=zo(n.opacity,t.opacity);return function(e){return n.h=a(e),n.s=i(e),n.l=d(e),n.opacity=r(e),n+''}}}function Yo(e){return function(n,t){var a=e((n=go(n)).h,(t=go(t)).h),i=zo(n.c,t.c),d=zo(n.l,t.l),r=zo(n.opacity,t.opacity);return function(e){return n.h=a(e),n.c=i(e),n.l=d(e),n.opacity=r(e),n+''}}}function Go(e){return function t(n){function a(a,t){var i=e((a=yo(a)).h,(t=yo(t)).h),d=zo(a.s,t.s),r=zo(a.l,t.l),o=zo(a.opacity,t.opacity);return function(e){return a.h=i(e),a.s=d(e),a.l=r(Qx(e,n)),a.opacity=o(e),a+''}}return n=+n,a.gamma=t,a}(1)}function Wo(e){return function(){return e}}function Ho(e){return+e}function Xo(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Wo(t)}function Vo(e){return function(t,n){var i=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:i(e)}}}function Jo(e){return function(n,i){var d=e(n=+n,i=+i);return function(e){return 0>=e?n:1<=e?i:d(e)}}}function Zo(e,t,n,a){var i=e[0],d=e[1],r=t[0],o=t[1];return d<i?(i=n(d,i),r=a(o,r)):(i=n(i,d),r=a(r,o)),function(e){return r(i(e))}}function Ko(e,t,n,a){var o=Zx(e.length,t.length)-1,l=Array(o),d=Array(o),r=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++r<o;)l[r]=n(e[r],e[r+1]),d[r]=a(t[r],t[r+1]);return function(t){var n=dv(e,t,1,o)-1;return d[n](l[n](t))}}function Qo(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function el(e,t){function n(){return l=2<Zx(i.length,d.length)?Ko:Zo,s=f=null,a}function a(t){return(s||(s=l(i,d,o?Vo(e):e,r)))(+t)}var i=QE,d=QE,r=qo,o=!1,l,s,f;return a.invert=function(e){return(f||(f=l(d,i,Xo,o?Jo(t):t)))(+e)},a.domain=function(e){return arguments.length?(i=cE.call(e,Ho),n()):i.slice()},a.range=function(e){return arguments.length?(d=pE.call(e),n()):d.slice()},a.rangeRound=function(e){return d=pE.call(e),r=Uo,n()},a.clamp=function(e){return arguments.length?(o=!!e,n()):o},a.interpolate=function(e){return arguments.length?(r=e,n()):r},n()}function tl(e,t){if(0>(a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf('e')))return null;var n=e.slice(0,a),a;return[1<n.length?n[0]+n.slice(2):n,+e.slice(a+1)]}function nl(e){return e=tl(Vx(e)),e?e[1]:NaN}function al(e,n){return function(a,d){for(var r=a.length,i=[],t=0,o=e[0],l=0;0<r&&0<o&&(l+o+1>d&&(o=nv(1,d-l)),i.push(a.substring(r-=o,r+o)),!((l+=o+1)>d));)o=e[t=(t+1)%e.length];return i.reverse().join(n)}}function il(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}function dl(e,t){var n=tl(e,t);if(!n)return e+'';var a=n[0],i=n[1];return 0>i?'0.'+Array(-i).join('0')+a:a.length>i+1?a.slice(0,i+1)+'.'+a.slice(i+1):a+Array(i-a.length+2).join('0')}function rl(e){return new ol(e)}function ol(e){if(!(f=tC.exec(e)))throw new Error('invalid format: '+e);var t=f[1]||' ',n=f[2]||'>',a=f[3]||'-',i=f[4]||'',d=!!f[5],r=f[6]&&+f[6],o=!!f[7],l=f[8]&&+f[8].slice(1),s=f[9]||'',f;'n'===s?(o=!0,s='g'):!eC[s]&&(s=''),(d||'0'===t&&'='===n)&&(d=!0,t='0',n='='),this.fill=t,this.align=n,this.sign=a,this.symbol=i,this.zero=d,this.width=r,this.comma=o,this.precision=l,this.type=s}function ll(e){return e}function sl(e){function t(e){function t(e){var t=y,f=b,v,i,n;if('c'===m)f=_(e)+f,e='';else{e=+e;var c=0>e;if(e=_(Vx(e),h),c&&0===+e&&(c=!1),t=(c?'('===s?s:'-':'-'===s||'('===s?'':s)+t,f=f+('s'===m?rC[8+dC/3]:'')+(c&&'('===s?')':''),x)for(v=-1,i=e.length;++v<i;)if(n=e.charCodeAt(v),48>n||57<n){f=(46===n?d+e.slice(v+1):e.slice(v))+f,e=e.slice(0,v);break}}g&&!p&&(e=a(e,Infinity));var k=t.length+e.length+f.length,w=k<u?Array(u-k+1).join(o):'';switch(g&&p&&(e=a(w+e,w.length?u-f.length:Infinity),w=''),l){case'<':e=t+e+f+w;break;case'=':e=t+w+e+f;break;case'^':e=w.slice(0,k=w.length>>1)+t+e+f+w.slice(k);break;default:e=w+t+e+f;}return r(e)}e=rl(e);var o=e.fill,l=e.align,s=e.sign,f=e.symbol,p=e.zero,u=e.width,g=e.comma,h=e.precision,m=e.type,y='$'===f?n[0]:'#'===f&&/[boxX]/.test(m)?'0'+m.toLowerCase():'',b='$'===f?n[1]:/[%p]/.test(m)?i:'',_=eC[m],x=!m||/[defgprs%]/.test(m);return h=null==h?m?6:12:/[gprs]/.test(m)?nv(1,Zx(21,h)):nv(0,Zx(20,h)),t.toString=function(){return e+''},t}var a=e.grouping&&e.thousands?al(e.grouping,e.thousands):ll,n=e.currency,d=e.decimal,r=e.numerals?il(e.numerals):ll,i=e.percent||'%';return{format:t,formatPrefix:function(n,a){var i=t((n=rl(n),n.type='f',n)),d=3*nv(-8,Zx(8,Kx(nl(a)/3))),r=Qx(10,-d),o=rC[8+d/3];return function(e){return i(r*e)+o}}}}function fl(e){return oC=sl(e),lC=oC.format,sC=oC.formatPrefix,oC}function cl(e){return nv(0,-nl(Vx(e)))}function pl(e,t){return nv(0,3*nv(-8,Zx(8,Kx(nl(t)/3)))-nl(Vx(e)))}function ul(e,t){return e=Vx(e),t=Vx(t)-e,nv(0,nl(t)-nl(e))+1}function gl(e,t,n){var a=e[0],i=e[e.length-1],d=u(a,i,null==t?10:t),r;switch(n=rl(null==n?',f':n),n.type){case's':{var o=nv(Vx(a),Vx(i));return null!=n.precision||isNaN(r=pl(d,o))||(n.precision=r),sC(n,o)}case'':case'e':case'g':case'p':case'r':{null!=n.precision||isNaN(r=ul(d,nv(Vx(a),Vx(i))))||(n.precision=r-('e'===n.type));break}case'f':case'%':{null!=n.precision||isNaN(r=cl(d))||(n.precision=r-2*('%'===n.type));break}}return lC(n)}function hl(e){var t=e.domain;return e.ticks=function(e){var n=t();return c(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return gl(t(),e,n)},e.nice=function(a){var r=t(),d=r.length-1,i=null==a?10:a,n=r[0],o=r[d],l=u(n,o,i);return l&&(l=u(Kx(n/l)*l,tv(o/l)*l,i),r[0]=Kx(n/l)*l,r[d]=tv(o/l)*l,t(r)),e},e}function ml(){var e=el(Xo,Oo);return e.copy=function(){return Qo(e,ml())},hl(e)}function yl(){function e(e){return+e}var t=[0,1];return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=cE.call(n,Ho),e):t.slice()},e.copy=function(){return yl().domain(t)},hl(e)}function bl(e,n){e=e.slice();var a=0,i=e.length-1,d=e[a],r=e[i],o;return r<d&&(o=a,a=i,i=o,o=d,d=r,r=o),e[a]=n.floor(d),e[i]=n.ceil(r),e}function _l(e,t){return(t=av(t/e))?function(n){return av(n/e)/t}:Wo(t)}function xl(e,n){return 0>e?function(i){return-Qx(-n,i)*Qx(-e,1-i)}:function(a){return Qx(n,a)*Qx(e,1-a)}}function vl(e){return isFinite(e)?+('1e'+e):0>e?0:e}function kl(e){return 10===e?vl:e===qx?Wx:function(t){return Qx(e,t)}}function wl(e){return e===qx?av:10===e&&Math.log10||2===e&&Math.log2||(e=av(e),function(t){return av(t)/e})}function Sl(e){return function(t){return-e(-t)}}function El(){function e(){return l=wl(o),s=kl(o),0>a()[0]&&(l=Sl(l),s=Sl(s)),t}var t=el(_l,xl).domain([1,10]),a=t.domain,o=10,l=wl(10),s=kl(10);return t.base=function(t){return arguments.length?(o=+t,e()):o},t.domain=function(t){return arguments.length?(a(t),e()):a()},t.ticks=function(e){var f=a(),d=f[0],u=f[f.length-1],g;(g=u<d)&&(r=d,d=u,u=r);var r=l(d),i=l(u),h=null==e?10:+e,n=[],m,p,y;if(o%1||!(i-r<h))n=c(r,i,Zx(i-r,h)).map(s);else if(r=ev(r)-1,i=ev(i)+1,0<d){for(;r<i;++r)for(p=1,m=s(r);p<o;++p)if(y=m*p,!(y<d)){if(y>u)break;n.push(y)}}else for(;r<i;++r)for(p=o-1,m=s(r);1<=p;--p)if(y=m*p,!(y<d)){if(y>u)break;n.push(y)}return g?n.reverse():n},t.tickFormat=function(e,n){if(null==n&&(n=10===o?'.0e':','),'function'!==typeof n&&(n=lC(n)),e===Infinity)return n;null==e&&(e=10);var a=nv(1,o*e/t.ticks().length);return function(e){var t=e/s(ev(l(e)));return t*o<o-0.5&&(t*=o),t<=a?n(e):''}},t.nice=function(){return a(bl(a(),{floor:function(e){return s(Kx(l(e)))},ceil:function(e){return s(tv(l(e)))}}))},t.copy=function(){return Qo(t,El().base(o))},t}function Cl(e,t){return 0>e?-Qx(-e,t):Qx(e,t)}function zl(){var e=1,t=el(function(t,n){return(n=Cl(n,e)-(t=Cl(t,e)))?function(a){return(Cl(a,e)-t)/n}:Wo(n)},function(n,a){return a=Cl(a,e)-(n=Cl(n,e)),function(i){return Cl(n+a*i,1/e)}}),n=t.domain;return t.exponent=function(t){return arguments.length?(e=+t,n(n())):e},t.copy=function(){return Qo(t,zl().exponent(e))},hl(t)}function Tl(){function e(){var e=0,i=nv(1,d.length);for(r=Array(i-1);++e<i;)r[e-1]=h(a,e/i);return t}function t(e){if(!isNaN(e=+e))return d[dv(r,e)]}var a=[],d=[],r=[];return t.invertExtent=function(e){var t=d.indexOf(e);return 0>t?[NaN,NaN]:[0<t?r[t-1]:a[0],t<r.length?r[t]:a[a.length-1]]},t.domain=function(t){if(!arguments.length)return a.slice();a=[];for(var r=0,i=t.length,n;r<i;++r)(n=t[r],null!=n&&!isNaN(n=+n))&&a.push(n);return a.sort(o),e()},t.range=function(t){return arguments.length?(d=pE.call(t),e()):d.slice()},t.quantiles=function(){return r.slice()},t.copy=function(){return Tl().domain(a).range(d)},t}function Rl(){function e(e){if(e<=e)return o[dv(n,e,0,r)]}function t(){var t=-1;for(n=Array(r);++t<r;)n[t]=((t+1)*d-(t-r)*a)/(r+1);return e}var a=0,d=1,r=1,n=[0.5],o=[0,1];return e.domain=function(e){return arguments.length?(a=+e[0],d=+e[1],t()):[a,d]},e.range=function(e){return arguments.length?(r=(o=pE.call(e)).length-1,t()):o.slice()},e.invertExtent=function(e){var t=o.indexOf(e);return 0>t?[NaN,NaN]:1>t?[a,n[0]]:t>=r?[n[r-1],d]:[n[t-1],n[t]]},e.copy=function(){return Rl().domain([a,d]).range(o)},hl(e)}function Al(){function e(e){if(e<=e)return a[dv(t,e,0,i)]}var t=[0.5],a=[0,1],i=1;return e.domain=function(n){return arguments.length?(t=pE.call(n),i=Zx(t.length,a.length-1),e):t.slice()},e.range=function(n){return arguments.length?(a=pE.call(n),i=Zx(t.length,a.length-1),e):a.slice()},e.invertExtent=function(e){var n=a.indexOf(e);return[t[n-1],t[n]]},e.copy=function(){return Al().domain(t).range(a)},e}function Ol(e){return new Date(e)}function Pl(e){return e instanceof Date?+e:+new Date(+e)}function Ml(e,t,a,i,d,r,o,l,s){function f(n){return(o(n)<n?m:r(n)<n?y:d(n)<n?b:i(n)<n?_:t(n)<n?a(n)<n?x:v:e(n)<n?k:w)(n)}function c(t,a,d,r){if(null==t&&(t=10),'number'===typeof t){var o=Vx(d-a)/t,s=n(function(e){return e[2]}).right(S,o);s===S.length?(r=u(a/mC,d/mC,t),t=e):s?(s=S[o/S[s-1][2]<S[s][2]/o?s-1:s],r=s[1],t=s[0]):(r=u(a,d,t),t=l)}return null==r?t:t.every(r)}var p=el(Xo,Oo),g=p.invert,h=p.domain,m=s('.%L'),y=s(':%S'),b=s('%I:%M'),_=s('%I %p'),x=s('%a %d'),v=s('%b %d'),k=s('%B'),w=s('%Y'),S=[[o,1,fC],[o,5,5*fC],[o,15,15*fC],[o,30,30*fC],[r,1,cC],[r,5,5*cC],[r,15,15*cC],[r,30,30*cC],[d,1,pC],[d,3,3*pC],[d,6,6*pC],[d,12,12*pC],[i,1,uC],[i,2,2*uC],[a,1,gC],[t,1,hC],[t,3,3*hC],[e,1,mC]];return p.invert=function(e){return new Date(g(e))},p.domain=function(e){return arguments.length?h(cE.call(e,Pl)):h().map(Ol)},p.ticks=function(e,n){var a=h(),i=a[0],d=a[a.length-1],o=d<i,r;return o&&(r=i,i=d,d=r),r=c(e,i,d,n),r=r?r.range(i,d+1):[],o?r.reverse():r},p.tickFormat=function(e,t){return null==t?f:s(t)},p.nice=function(e,t){var n=h();return(e=c(e,n[0],n[n.length-1],t))?h(bl(n,e)):p},p.copy=function(){return Qo(p,Ml(e,t,a,i,d,r,o,l,s))},p}function Dl(e){return e.match(/.{6}/g).map(function(e){return'#'+e})}function Ll(e){var a=e.length;return function(n){return e[nv(0,Zx(a-1,Kx(n*a)))]}}function ql(){function e(){var e=i().length,t=r[1]<r[0],n=r[t-0],u=r[1-t],g=Br(e,o,l);c=(u-n)/(g||1),a&&(c=Kx(c)),n+=(u-n-c*(e-o))*s,p=c*(1-o),a&&(n=ev(n),p=ev(p));var h=f(e).map(function(e){return n+c*e});return d(t?h.reverse():h)}var t=Yr().unknown(void 0),i=t.domain,d=t.range,r=[0,1],a=!1,o=0,l=0,s=0.5,c,p;return delete t.unknown,t.domain=function(t){return arguments.length?(i(t),e()):i()},t.range=function(t){return arguments.length?(r=[+t[0],+t[1]],e()):r.slice()},t.rangeRound=function(t){return r=[+t[0],+t[1]],a=!0,e()},t.bandwidth=function(){return p},t.step=function(){return c},t.round=function(t){return arguments.length?(a=!!t,e()):a},t.padding=function(t){return arguments.length?(o=l=nv(0,Zx(1,t)),e()):o},t.paddingInner=function(t){return arguments.length?(o=nv(0,Zx(1,t)),e()):o},t.paddingOuter=function(t){return arguments.length?(l=nv(0,Zx(1,t)),e()):l},t.align=function(t){return arguments.length?(s=nv(0,Zx(1,t)),e()):s},t.invertRange=function(e){var o=+e[0],l=+e[1],s=r[1]<r[0],f=s?d().reverse():d(),c=f.length-1,n,a,u;if(l<o&&(u=o,o=l,l=u),!(l<f[0]||o>r[1-s]))return n=nv(0,dv(f,o)-1),a=o===l?n:dv(f,l)-1,o-f[n]>p+1e-10&&++n,s&&(u=n,n=c-a,a=c-u),n>a?void 0:i().slice(n,a+1)},t.invert=function(e){var n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return ql().domain(i()).range(r).round(a).paddingInner(o).paddingOuter(l).align(s)},e()}function Ul(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Ul(t())},e}function Fl(e){return TC.call(e,function(e){return+e})}function jl(){function e(e){return null==e||e!==e?void 0:n(a[nv(dv(a,e),1)-1])}function t(e){a=Fl(e),n.domain([a[0],fe(a)])}var n=ml(),a=[];return e.domain=function(n){return arguments.length?(t(n),e):a.slice()},e.range=function(t){return arguments.length?(n.range(t),e):n.range()},e.rangeRound=function(t){return arguments.length?(n.rangeRound(t),e):n.rangeRound()},e.interpolate=function(t){return arguments.length?(n.interpolate(t),e):n.interpolate()},e.invert=function(e){return n.invert(e)},e.ticks=function(t){var i=a.length,n=~~(i/(t||i));return 2>n?e.domain():a.filter(function(e,t){return!(t%n)})},e.tickFormat=function(){return n.tickFormat.apply(n,arguments)},e.copy=function(){return jl().domain(e.domain()).range(e.range())},e}function $l(){function e(e){return null==e||e!==e?void 0:n[(dv(t,e)-1)%n.length]}var t=[],n=[];return e.domain=function(n){return arguments.length?(t=Fl(n),e):t.slice()},e.range=function(t){return arguments.length?(n=RC.call(t),e):n.slice()},e.copy=function(){return $l().domain(e.domain()).range(e.range())},e}function Nl(e){function t(){var e=a.domain();i=e[0],d=fe(e)-i}function n(n){var a=(n-i)/d;return e(r?nv(0,Zx(1,a)):a)}var a=ml(),i=0,d=1,r=!1;return n.clamp=function(e){return arguments.length?(r=!!e,n):r},n.domain=function(e){return arguments.length?(a.domain(e),t(),n):a.domain()},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return Nl().domain(a.domain()).clamp(r).interpolator(e)},n.ticks=function(e){return a.ticks(e)},n.tickFormat=function(e,t){return a.tickFormat(e,t)},n.nice=function(e){return a.nice(e),t(),n},n}function Il(e,t){return function(){var n=t();return n.invertRange||(n.invertRange=n.invert?Nr(n):n.invertExtent?Ir(n):void 0),n.type=e,n}}function Bl(e,t){return 1<arguments.length?(AC[e]=Il(e,t),this):AC.hasOwnProperty(e)?AC[e]:void 0}function Yl(e){for(var t=0|e.length/6,n=Array(t),a=0;a<t;)n[a]='#'+e.slice(6*a,6*++a);return n}function Gl(e){for(var t=0|e.length/6,n=Array(t),a=0;a<t;)n[a]='#'+e.slice(6*a,6*++a);return n}function Wl(e){return LE(e[e.length-1])}function Hl(e,t){Yz[e]=Bz['interpolate'+t],_[e]=Bz['scheme'+t]}function Xl(e,t){if(1<arguments.length)return Yz[e]=t,this;var n=e.split('-');return e=n[0],n=+n[1]+1,n&&_.hasOwnProperty(e)?_[e][n-1]:!n&&Yz.hasOwnProperty(e)?Yz[e]:void 0}function Vl(e,t){var n=t[0],a=fe(t)-n;return function(t){return e(n+t*a)}}function Jl(e,t,n){return'linear'===e.type||'sequential'===e.type?function(e){return(e-t)/(n-t)}:e.copy().domain([t,n]).range([0,1]).interpolate(Zl)}function Zl(e,t){return function(n){return e+n*(t-e)}}function Kl(e,t){var n=KE[Ql(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function Ql(e){return'interpolate'+e.toLowerCase().split('-').map(function(e){return e[0].toUpperCase()+e.slice(1)}).join('')}function es(e,t){return e-t}function ts(e){for(var t=0,a=e.length,n=e[a-1][1]*e[0][0]-e[a-1][0]*e[0][1];++t<a;)n+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return n}function as(e){return function(){return e}}function is(e,t){for(var a=-1,i=t.length,n;++a<i;)if(n=ds(e,t[a]))return n;return 0}function ds(e,t){for(var a=t[0],d=t[1],r=-1,o=0,i=e.length,n=i-1;o<i;n=o++){var l=e[o],s=l[0],f=l[1],c=e[n],p=c[0],u=c[1];if(rs(l,c,t))return 0;f>d!==u>d&&a<(p-s)*(d-f)/(u-f)+s&&(r=-r)}return r}function rs(e,t,n){var a;return os(e,t,n)&&ls(e[a=+(e[0]===t[0])],n[a],t[a])}function os(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function ls(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function ss(){}function fs(){function e(e){var n=r(e);if(!Array.isArray(n)){var a=s(e),i=a[0],d=a[1];n=u(i,d,n),n=f(Kx(i/n)*n,Kx(d/n)*n,n)}else n=n.slice().sort(es);var l=n.map(function(n){var a=[],i=[];return t(e,n,function(t){o(t,e,n),0<ts(t)?a.push([t]):i.push(t)}),i.forEach(function(e){for(var t=0,i=a.length,n;t<i;++t)if(is((n=a[t])[0],e))return void n.push(e)}),a});return l.map(function(e,t){return{type:'MultiPolygon',value:n[t],coordinates:e}})}function t(e,t,a){function r(e){var t=[e[0][0]+s,e[0][1]+c],i=[e[1][0]+s,e[1][1]+c],d=n(t),r=n(i),p,f;(p=l[d])?(f=o[r])?(delete l[p.end],delete o[f.start],p===f?(p.ring.push(i),a(p.ring)):o[p.start]=l[f.end]={start:p.start,end:f.end,ring:p.ring.concat(f.ring)}):(delete l[p.end],p.ring.push(i),l[p.end=r]=p):(p=o[r])?(f=l[d])?(delete o[p.start],delete l[f.end],p===f?(p.ring.push(i),a(p.ring)):o[f.start]=l[p.end]={start:f.start,end:p.end,ring:f.ring.concat(p.ring)}):(delete o[p.start],p.ring.unshift(t),o[p.start=d]=p):o[d]=l[r]={start:d,end:r,ring:[t,i]}}var o=[],l=[],s,c,f,p,u,g;for(s=c=-1,p=e[0]>=t,Hz[p<<1].forEach(r);++s<i-1;)f=p,p=e[s+1]>=t,Hz[f|p<<1].forEach(r);for(Hz[p<<0].forEach(r);++c<d-1;){for(s=-1,p=e[c*i+i]>=t,u=e[c*i]>=t,Hz[p<<1|u<<2].forEach(r);++s<i-1;)f=p,p=e[c*i+i+s+1]>=t,g=u,u=e[c*i+s+1]>=t,Hz[f|p<<1|u<<2|g<<3].forEach(r);Hz[p|u<<3].forEach(r)}for(s=-1,u=e[c*i]>=t,Hz[u<<2].forEach(r);++s<i-1;)g=u,u=e[c*i+s+1]>=t,Hz[u<<2|g<<3].forEach(r);Hz[u<<3].forEach(r)}function n(e){return 2*e[0]+4*(e[1]*(i+1))}function a(e,t,n){e.forEach(function(e){var a=e[0],r=e[1],o=0|a,l=0|r,s=t[l*i+o],f;0<a&&a<i&&o===a&&(f=t[l*i+o-1],e[0]=a+(n-f)/(s-f)-0.5),0<r&&r<d&&l===r&&(f=t[(l-1)*i+o],e[1]=r+(n-f)/(s-f)-0.5)})}var i=1,d=1,r=g,o=a;return e.size=function(t){if(!arguments.length)return[i,d];var n=tv(t[0]),a=tv(t[1]);if(!(0<n)||!(0<a))throw new Error('invalid size');return i=n,d=a,e},e.thresholds=function(t){return arguments.length?(r='function'===typeof t?t:Array.isArray(t)?as(Wz.call(t)):as(t),e):r},e.smooth=function(t){return arguments.length?(o=t?a:ss,e):o===a},e}function cs(e,t,a){for(var d=e.width,n=e.height,r=(a<<1)+1,o=0;o<n;++o)for(var l=0,i=0;l<d+a;++l)l<d&&(i+=e.data[l+o*d]),l>=a&&(l>=r&&(i-=e.data[l-r+o*d]),t.data[l-a+o*d]=i/Zx(l+1,d-1+r-l,r))}function ps(e,t,a){for(var d=e.width,n=e.height,r=(a<<1)+1,o=0;o<d;++o)for(var i=0,l=0;i<n+a;++i)i<n&&(l+=e.data[o+i*d]),i>=a&&(i>=r&&(l-=e.data[o+(i-r)*d]),t.data[o+(i-a)*d]=l/Zx(i+1,n-1+r-i,r))}function us(e){return e[0]}function gs(e){return e[1]}function hs(){function e(e){var a=new Float32Array(o*b),i=new Float32Array(o*b);e.forEach(function(e,t,n){var i=s(e,t,n)+y>>r,d=c(e,t,n)+y>>r;0<=i&&i<o&&0<=d&&d<b&&++a[i+d*o]}),cs({width:o,height:b,data:a},{width:o,height:b,data:i},h>>r),ps({width:o,height:b,data:i},{width:o,height:b,data:a},h>>r),cs({width:o,height:b,data:a},{width:o,height:b,data:i},h>>r),ps({width:o,height:b,data:i},{width:o,height:b,data:a},h>>r),cs({width:o,height:b,data:a},{width:o,height:b,data:i},h>>r),ps({width:o,height:b,data:i},{width:o,height:b,data:a},h>>r);var d=x(a);if(!Array.isArray(d)){var l=m(a);d=u(0,l,d),d=f(0,Kx(l/d)*d,d),d.shift()}return fs().thresholds(d).size([o,b])(a).map(t)}function t(e){return e.value*=Qx(2,-2*r),e.coordinates.forEach(a),e}function a(e){e.forEach(i)}function i(e){e.forEach(d)}function d(e){e[0]=e[0]*Qx(2,r)-y,e[1]=e[1]*Qx(2,r)-y}function l(){return y=3*h,o=p+2*y>>r,b=g+2*y>>r,e}var s=us,c=gs,p=960,g=500,h=20,r=2,y=3*h,o=p+2*y>>r,b=g+2*y>>r,x=as(20);return e.x=function(t){return arguments.length?(s='function'===typeof t?t:as(+t),e):s},e.y=function(t){return arguments.length?(c='function'===typeof t?t:as(+t),e):c},e.size=function(e){if(!arguments.length)return[p,g];var t=tv(e[0]),n=tv(e[1]);if(!(0<=t)&&!(0<=t))throw new Error('invalid size');return p=t,g=n,l()},e.cellSize=function(e){if(!arguments.length)return 1<<r;if(!(1<=(e=+e)))throw new Error('invalid cell size');return r=Kx(av(e)/Xx),l()},e.thresholds=function(t){return arguments.length?(x='function'===typeof t?t:Array.isArray(t)?as(Wz.call(t)):as(t),e):x},e.bandwidth=function(e){if(!arguments.length)return Hx(h*(h+1));if(!(0<=(e=+e)))throw new Error('invalid bandwidth');return h=ev((Hx(4*e*e+1)-1)/2),l()},e}function ms(e){jd.call(this,null,e)}function ys(){return new bs}function bs(){this.reset()}function _s(e,t,n){var a=e.s=t+n,i=a-t;e.t=t-(a-i)+(n-i)}function xs(e){return 1<e?0:-1>e?Qz:Nx(e)}function vs(e){return 1<e?eT:-1>e?-eT:Fx(e)}function ks(){}function ws(e,t){e&&bT.hasOwnProperty(e.type)&&bT[e.type](e,t)}function Ss(e,t,a){var d=-1,i=e.length-a,n;for(t.lineStart();++d<i;)n=e[d],t.point(n[0],n[1],n[2]);t.lineEnd()}function Es(e,t){var a=-1,i=e.length;for(t.polygonStart();++a<i;)Ss(e[a],t,1);t.polygonEnd()}function Cs(e,t){e&&yT.hasOwnProperty(e.type)?yT[e.type](e,t):ws(e,t)}function zs(){vT.point=Rs}function Ts(){As(ET,CT)}function Rs(e,t){vT.point=As,ET=e,CT=t,e*=iT,t*=iT,zT=e,TT=lT(t=t/2+tT),RT=uT(t)}function As(e,t){e*=iT,t*=iT,t=t/2+tT;var n=e-zT,a=0<=n?1:-1,i=a*n,d=lT(t),r=uT(t),o=RT*r,l=TT*d+o*lT(i),s=o*a*uT(i);_T.add(oT(s,l)),zT=e,TT=d,RT=r}function Os(e){return[oT(e[1],e[0]),vs(e[2])]}function Ps(e){var t=e[0],n=e[1],a=lT(n);return[a*lT(t),a*uT(t),uT(n)]}function Ms(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ds(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ls(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function qs(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Us(e){var t=hT(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Fs(e,t){FT.push(jT=[AT=e,PT=e]),t<OT&&(OT=t),t>MT&&(MT=t)}function js(e,t){var n=Ps([e*iT,t*iT]);if(UT){var a=Ds(UT,n),i=[a[1],-a[0],0],d=Ds(i,a);Us(d),d=Os(d);var r=e-DT,o=0<r?1:-1,l=d[0]*aT*o,s=180<dT(r),f;s^(o*DT<l&&l<o*e)?(f=d[1]*aT,f>MT&&(MT=f)):(l=(l+360)%360-180,s^(o*DT<l&&l<o*e))?(f=-d[1]*aT,f<OT&&(OT=f)):(t<OT&&(OT=t),t>MT&&(MT=t)),s?e<DT?Gs(AT,e)>Gs(AT,PT)&&(PT=e):Gs(e,PT)>Gs(AT,PT)&&(AT=e):PT>=AT?(e<AT&&(AT=e),e>PT&&(PT=e)):e>DT?Gs(AT,e)>Gs(AT,PT)&&(PT=e):Gs(e,PT)>Gs(AT,PT)&&(AT=e)}else FT.push(jT=[AT=e,PT=e]);t<OT&&(OT=t),t>MT&&(MT=t),UT=n,DT=e}function $s(){wT.point=js}function Ns(){jT[0]=AT,jT[1]=PT,wT.point=Fs,UT=null}function Is(e,t){if(UT){var n=e-DT;kT.add(180<dT(n)?n+(0<n?360:-360):n)}else LT=e,qT=t;vT.point(e,t),js(e,t)}function Bs(){vT.lineStart()}function Ys(){Is(LT,qT),vT.lineEnd(),dT(kT)>Kz&&(AT=-(PT=180)),jT[0]=AT,jT[1]=PT,UT=null}function Gs(e,t){return 0>(t-=e)?t+360:t}function Ws(e,t){e*=iT,t*=iT;var n=lT(t);Hs(n*lT(e),n*uT(e),uT(t))}function Hs(e,t,n){++$T,IT+=(e-IT)/$T,BT+=(t-BT)/$T,YT+=(n-YT)/$T}function Xs(){ST.point=Vs}function Vs(e,t){e*=iT,t*=iT;var n=lT(t);eR=n*lT(e),tR=n*uT(e),nR=uT(t),ST.point=Js,Hs(eR,tR,nR)}function Js(e,t){e*=iT,t*=iT;var n=lT(t),a=n*lT(e),i=n*uT(e),d=uT(t),r=oT(hT((r=tR*d-nR*i)*r+(r=nR*a-eR*d)*r+(r=eR*i-tR*a)*r),eR*a+tR*i+nR*d);NT+=r,WT+=r*(eR+(eR=a)),HT+=r*(tR+(tR=i)),XT+=r*(nR+(nR=d)),Hs(eR,tR,nR)}function Zs(){ST.point=Ws}function Ks(){ST.point=ef}function Qs(){tf(KT,QT),ST.point=Ws}function ef(e,t){KT=e,QT=t,e*=iT,t*=iT,ST.point=tf;var n=lT(t);eR=n*lT(e),tR=n*uT(e),nR=uT(t),Hs(eR,tR,nR)}function tf(e,t){e*=iT,t*=iT;var n=lT(t),a=n*lT(e),i=n*uT(e),d=uT(t),r=tR*d-nR*i,o=nR*a-eR*d,l=eR*i-tR*a,s=hT(r*r+o*o+l*l),f=vs(s),c=s&&-f/s;VT+=c*r,JT+=c*o,ZT+=c*l,NT+=f,WT+=f*(eR+(eR=a)),HT+=f*(tR+(tR=i)),XT+=f*(nR+(nR=d)),Hs(eR,tR,nR)}function nf(e,t){function n(n,a){return n=e(n,a),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,a){return n=t.invert(n,a),n&&e.invert(n[0],n[1])}),n}function af(e,t){return[e>Qz?e-nT:e<-Qz?e+nT:e,t]}function df(e,t,n){return(e%=nT)?t||n?nf(of(e),lf(t,n)):of(e):t||n?lf(t,n):af}function rf(e){return function(t,n){return t+=e,[t>Qz?t-nT:t<-Qz?t+nT:t,n]}}function of(e){var t=rf(e);return t.invert=rf(-e),t}function lf(e,t){function n(e,t){var n=lT(t),o=lT(e)*n,l=uT(e)*n,s=uT(t),f=s*a+o*i;return[oT(l*d-f*r,o*a-s*i),vs(f*d+l*r)]}var a=lT(e),i=uT(e),d=lT(t),r=uT(t);return n.invert=function(e,t){var n=lT(t),o=lT(e)*n,l=uT(e)*n,s=uT(t),f=s*d-l*r;return[oT(l*d+s*r,o*a+f*i),vs(f*a-o*i)]},n}function sf(e){function t(t){return t=e(t[0]*iT,t[1]*iT),t[0]*=aT,t[1]*=aT,t}return e=df(e[0]*iT,e[1]*iT,2<e.length?e[2]*iT:0),t.invert=function(t){return t=e.invert(t[0]*iT,t[1]*iT),t[0]*=aT,t[1]*=aT,t},t}function ff(e,n,a,i,d,r){if(a){var o=lT(n),l=uT(n),s=i*a;null==d?(d=n+i*nT,r=n-s/2):(d=cf(o,d),r=cf(o,r),(0<i?d<r:d>r)&&(d+=i*nT));for(var f=d,t;0<i?f>r:f<r;f-=s)t=Os([o,-l*lT(f),-l*uT(f)]),e.point(t[0],t[1])}}function cf(e,t){t=Ps(t),t[0]-=e,Us(t);var n=xs(-t[1]);return((0>-t[2]?-n:n)+nT-Kz)%nT}function pf(){var e=[],t;return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:ks,rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function uf(e,t,n,a,i,d){var o=e[0],l=e[1],s=t[0],f=t[1],c=0,p=1,u=s-o,g=f-l,h;if(h=n-o,u||!(0<h)){if(h/=u,0>u){if(h<c)return;h<p&&(p=h)}else if(0<u){if(h>p)return;h>c&&(c=h)}if(h=i-o,u||!(0>h)){if(h/=u,0>u){if(h>p)return;h>c&&(c=h)}else if(0<u){if(h<c)return;h<p&&(p=h)}if(h=a-l,g||!(0<h)){if(h/=g,0>g){if(h<c)return;h<p&&(p=h)}else if(0<g){if(h>p)return;h>c&&(c=h)}if(h=d-l,g||!(0>h)){if(h/=g,0>g){if(h>p)return;h>c&&(c=h)}else if(0<g){if(h<c)return;h<p&&(p=h)}return 0<c&&(e[0]=o+c*u,e[1]=l+c*g),1>p&&(t[0]=o+p*u,t[1]=l+p*g),!0}}}}}function gf(e,t){return dT(e[0]-t[0])<Kz&&dT(e[1]-t[1])<Kz}function hf(e,t,n,a){this.x=e,this.z=t,this.o=n,this.e=a,this.v=!1,this.n=this.p=null}function mf(e,t,a,d,r){var o=[],l=[],s,i;if(e.forEach(function(e){if(!(0>=(i=e.length-1))){var t=e[0],a=e[i],i,n;if(gf(t,a)){for(r.lineStart(),s=0;s<i;++s)r.point((t=e[s])[0],t[1]);return void r.lineEnd()}o.push(n=new hf(t,e,null,!0)),l.push(n.o=new hf(t,null,n,!1)),o.push(n=new hf(a,e,null,!1)),l.push(n.o=new hf(a,null,n,!0))}}),!!o.length){for(l.sort(t),yf(o),yf(l),(s=0,i=l.length);s<i;++s)l[s].e=a=!a;for(var n=o[0],f,c;;){for(var p=n,u=!0;p.v;)if((p=p.n)===n)return;f=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(u)for(s=0,i=f.length;s<i;++s)r.point((c=f[s])[0],c[1]);else d(p.x,p.n.x,1,r);p=p.n}else{if(u)for(f=p.p.z,s=f.length-1;0<=s;--s)r.point((c=f[s])[0],c[1]);else d(p.x,p.p.x,-1,r);p=p.p}p=p.o,f=p.z,u=!u}while(!p.v);r.lineEnd()}}}function yf(e){if(a=e.length){for(var t=0,i=e[0],a,n;++t<a;)i.n=n=e[t],n.p=i,i=n;i.n=n=e[0],n.p=i}}function bf(e,t,n,d){function i(a,i){return e<=a&&a<=n&&t<=i&&i<=d}function a(i,o,s,f){var c=0,a=0;if(null==i||(c=r(i,s))!==(a=r(o,s))||0>l(i,o)^0<s)do f.point(0===c||3===c?e:n,1<c?d:t);while((c=(c+s+4)%4)!==a);else f.point(o[0],o[1])}function r(a,i){return dT(a[0]-e)<Kz?0<i?0:3:dT(a[0]-n)<Kz?0<i?2:1:dT(a[1]-t)<Kz?0<i?1:0:0<i?3:2}function o(e,t){return l(e.x,t.x)}function l(e,t){var n=r(e,1),a=r(t,1);return n===a?0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]:n-a}return function(r){function l(e,t){i(e,t)&&c.point(e,t)}function s(){for(var t=0,a=0,i=h.length;a<i;++a)for(var n=h[a],r=1,o=n.length,l=n[0],s=l[0],f=l[1],c,p;r<o;++r)c=s,p=f,l=n[r],s=l[0],f=l[1],p<=d?f>d&&(s-c)*(d-p)>(f-p)*(e-c)&&++t:f<=d&&(s-c)*(d-p)<(f-p)*(e-c)&&--t;return t}function f(r,o){var l=i(r,o);if(h&&m.push([r,o]),z)_=r,k=o,w=l,z=!1,l&&(c.lineStart(),c.point(r,o));else if(l&&C)c.point(r,o);else{var s=[S=nv(iR,Zx(aR,S)),E=nv(iR,Zx(aR,E))],a=[r=nv(iR,Zx(aR,r)),o=nv(iR,Zx(aR,o))];uf(s,a,e,t,n,d)?(!C&&(c.lineStart(),c.point(s[0],s[1])),c.point(a[0],a[1]),!l&&c.lineEnd(),T=!1):l&&(c.lineStart(),c.point(r,o),T=!1)}S=r,E=o,C=l}var c=r,p=pf(),u={point:l,lineStart:function(){u.point=f,h&&h.push(m=[]),z=!0,C=!1,S=E=NaN},lineEnd:function(){g&&(f(_,k),w&&C&&p.rejoin(),g.push(p.result())),u.point=l,C&&c.lineEnd()},polygonStart:function(){c=p,g=[],h=[],T=!0},polygonEnd:function(){var e=s(),t=T&&e,n=(g=b(g)).length;(t||n)&&(r.polygonStart(),t&&(r.lineStart(),a(null,null,1,r),r.lineEnd()),n&&mf(g,o,e,a,r),r.polygonEnd()),c=r,g=h=m=null}},g,h,m,_,k,w,S,E,C,z,T;return u}}function _f(e,t){var a=t[0],d=t[1],r=[uT(a),-lT(a),0],o=0,l=0;dR.reset();for(var s=0,i=e.length;s<i;++s)if(y=(h=e[s]).length)for(var n=h[y-1],f=n[0],c=n[1]/2+tT,p=uT(c),u=lT(c),g=0,h,y;g<y;++g,f=b,p=x,u=v,n=m){var m=h[g],b=m[0],_=m[1]/2+tT,x=uT(_),v=lT(_),w=b-f,S=0<=w?1:-1,E=S*w,C=E>Qz,z=p*x;if(dR.add(oT(z*S*uT(E),u*v+z*lT(E))),o+=C?w+S*nT:w,C^f>=a^b>=a){var k=Ds(Ps(n),Ps(m));Us(k);var T=Ds(r,k);Us(T);var R=(C^0<=w?-1:1)*vs(T[2]);(d>R||d===R&&(k[0]||k[1]))&&(l+=C^0<=w?1:-1)}}return(o<-Kz||o<Kz&&dR<-Kz)^1&l}function xf(){oR.point=oR.lineEnd=ks}function vf(e,t){e*=iT,t*=iT,CR=e,zR=uT(t),TR=lT(t),oR.point=kf}function kf(e,t){e*=iT,t*=iT;var n=uT(t),a=lT(t),i=dT(e-CR),d=lT(i),r=uT(i),o=a*r,l=TR*n-zR*a*d,s=zR*n+TR*a*d;rR.add(oT(hT(o*o+l*l),s)),CR=e,zR=n,TR=a}function wf(e,t,n){var a=f(e,t-Kz,n).concat(t);return function(e){return a.map(function(t){return[e,t]})}}function Sf(e,t,n){var a=f(e,t-Kz,n).concat(t);return function(e){return a.map(function(t){return[t,e]})}}function Ef(){function e(){return{type:'MultiLineString',coordinates:t()}}function t(){return f(sT(c/i)*i,s,i).map(y).concat(f(sT(h/d)*d,g,d).map(x)).concat(f(sT(l/n)*n,o,n).filter(function(e){return dT(e%i)>Kz}).map(m)).concat(f(sT(u/a)*a,p,a).filter(function(e){return dT(e%d)>Kz}).map(b))}var n=10,a=n,i=90,d=360,r=2.5,o,l,s,c,p,u,g,h,m,b,y,x;return e.lines=function(){return t().map(function(e){return{type:'LineString',coordinates:e}})},e.outline=function(){return{type:'Polygon',coordinates:[y(c).concat(x(g).slice(1),y(s).reverse().slice(1),x(h).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.extentMajor(t).extentMinor(t):e.extentMinor()},e.extentMajor=function(t){return arguments.length?(c=+t[0][0],s=+t[1][0],h=+t[0][1],g=+t[1][1],c>s&&(t=c,c=s,s=t),h>g&&(t=h,h=g,g=t),e.precision(r)):[[c,h],[s,g]]},e.extentMinor=function(t){return arguments.length?(l=+t[0][0],o=+t[1][0],u=+t[0][1],p=+t[1][1],l>o&&(t=l,l=o,o=t),u>p&&(t=u,u=p,p=t),e.precision(r)):[[l,u],[o,p]]},e.step=function(t){return arguments.length?e.stepMajor(t).stepMinor(t):e.stepMinor()},e.stepMajor=function(t){return arguments.length?(i=+t[0],d=+t[1],e):[i,d]},e.stepMinor=function(t){return arguments.length?(n=+t[0],a=+t[1],e):[n,a]},e.precision=function(t){return arguments.length?(r=+t,m=wf(u,p,90),b=Sf(l,o,r),y=wf(h,g,90),x=Sf(c,s,r),e):r},e.extentMajor([[-180,-90+Kz],[180,90-Kz]]).extentMinor([[-180,-80-Kz],[180,80+Kz]])}function Cf(e){return e}function zf(){fR.point=Tf}function Tf(e,t){fR.point=Rf,RR=OR=e,AR=PR=t}function Rf(e,t){sR.add(PR*e-OR*t),OR=e,PR=t}function Af(){Rf(RR,AR)}function Of(e,t){mR+=e,yR+=t,++bR}function Pf(){ER.point=Mf}function Mf(e,t){ER.point=Df,Of(LR=e,qR=t)}function Df(e,t){var n=e-LR,a=t-qR,i=hT(n*n+a*a);_R+=i*(LR+e)/2,xR+=i*(qR+t)/2,vR+=i,Of(LR=e,qR=t)}function Lf(){ER.point=Of}function qf(){ER.point=Ff}function Uf(){jf(MR,DR)}function Ff(e,t){ER.point=jf,Of(MR=LR=e,DR=qR=t)}function jf(e,t){var n=e-LR,a=t-qR,i=hT(n*n+a*a);_R+=i*(LR+e)/2,xR+=i*(qR+t)/2,vR+=i,i=qR*e-LR*t,kR+=i*(LR+e),wR+=i*(qR+t),SR+=3*i,Of(LR=e,qR=t)}function $f(e){this._context=e}function Nf(e,t){FR.point=If,$R=IR=e,NR=BR=t}function If(e,t){IR-=e,BR-=t,UR.add(hT(IR*IR+BR*BR)),IR=e,BR=t}function Bf(){this._string=[]}function Yf(e){return'm0,'+e+'a'+e+','+e+' 0 1,1 0,'+-2*e+'a'+e+','+e+' 0 1,1 0,'+2*e+'z'}function Gf(e,t){function n(e){return e&&('function'===typeof a&&d.pointRadius(+a.apply(this,arguments)),Cs(e,i(d))),d.result()}var a=4.5,i,d;return n.area=function(e){return Cs(e,i(fR)),fR.result()},n.measure=function(e){return Cs(e,i(FR)),FR.result()},n.bounds=function(e){return Cs(e,i(hR)),hR.result()},n.centroid=function(e){return Cs(e,i(ER)),ER.result()},n.projection=function(t){return arguments.length?(i=null==t?(e=null,Cf):(e=t).stream,n):e},n.context=function(e){return arguments.length?(d=null==e?(t=null,new Bf):new $f(t=e),'function'!==typeof a&&d.pointRadius(a),n):t},n.pointRadius=function(e){return arguments.length?(a='function'===typeof e?e:(d.pointRadius(+e),+e),n):a},n.projection(e).context(t)}function Wf(e,t,n,a){return function(i,d){function r(t,n){var a=i(t,n);e(t=a[0],n=a[1])&&d.point(t,n)}function o(e,t){var n=i(e,t);u.point(n[0],n[1])}function l(){m.point=o,u.lineStart()}function s(){m.point=r,u.lineEnd()}function f(e,t){k.push([e,t]);var n=i(e,t);y.point(n[0],n[1])}function c(){y.lineStart(),k=[]}function p(){f(k[0][0],k[0][1]),y.lineEnd();var e=y.clean(),t=h.result(),a=t.length,r,i,o,l;if(k.pop(),x.push(k),k=null,!!a){if(1&e){if(o=t[0],0<(i=o.length-1)){for(_||(d.polygonStart(),_=!0),d.lineStart(),r=0;r<i;++r)d.point((l=o[r])[0],l[1]);d.lineEnd()}return}1<a&&2&e&&t.push(t.pop().concat(t.shift())),v.push(t.filter(Hf))}}var u=t(d),g=i.invert(a[0],a[1]),h=pf(),y=t(h),_=!1,m={point:r,lineStart:l,lineEnd:s,polygonStart:function(){m.point=f,m.lineStart=c,m.lineEnd=p,v=[],x=[]},polygonEnd:function(){m.point=r,m.lineStart=l,m.lineEnd=s,v=b(v);var e=_f(x,g);v.length?(!_&&(d.polygonStart(),_=!0),mf(v,Xf,e,n,d)):e&&(!_&&(d.polygonStart(),_=!0),d.lineStart(),n(null,null,1,d),d.lineEnd()),_&&(d.polygonEnd(),_=!1),v=x=null},sphere:function(){d.polygonStart(),d.lineStart(),n(null,null,1,d),d.lineEnd(),d.polygonEnd()}},x,v,k;return m}}function Hf(e){return 1<e.length}function Xf(e,t){return(0>(e=e.x)[0]?e[1]-eT-Kz:eT-e[1])-(0>(t=t.x)[0]?t[1]-eT-Kz:eT-t[1])}function Vf(e,t,n,a){var i=uT(e-n),d,r;return dT(i)>Kz?rT((uT(t)*(r=lT(a))*uT(n)-uT(a)*(d=lT(t))*uT(e))/(d*r*i)):(t+a)/2}function Jf(e,t){function n(e,t){return lT(e)*lT(t)>d}function a(e,n,a){var i=Ps(e),r=Ps(n),o=[1,0,0],l=Ds(i,r),s=Ms(l,l),f=l[0],c=s-f*f;if(!c)return!a&&e;var p=Ds(o,l),g=qs(o,d*s/c),h=qs(l,-d*f/c);Ls(g,h);var m=p,u=Ms(g,m),y=Ms(m,m),b=u*u-y*(Ms(g,g)-1);if(!(0>b)){var _=hT(b),t=qs(m,(-u-_)/y);if(Ls(t,g),t=Os(t),!a)return t;var x=e[0],v=n[0],k=e[1],S=n[1],E;v<x&&(E=x,x=v,v=E);var C=v-x,z=dT(C-Qz)<Kz;if(!z&&S<k&&(E=k,k=S,S=E),z||C<Kz?z?0<k+S^t[1]<(dT(t[0]-x)<Kz?k:S):k<=t[1]&&t[1]<=S:C>Qz^(x<=t[0]&&t[0]<=v)){var T=qs(m,(-u+_)/y);return Ls(T,g),[t,Os(T)]}}}function i(t,n){var a=o?e:Qz-e,i=0;return t<-a?i|=1:t>a&&(i|=2),n<-a?i|=4:n>a&&(i|=8),i}var d=lT(e),o=0<d,r=dT(d)>Kz;return Wf(n,function(e){var d,l,s,f,p;return{lineStart:function(){f=s=!1,p=1},point:function(u,g){var h=[u,g],m=n(u,g),y=o?m?0:i(u,g):m?i(u+(0>u?Qz:-Qz),g):0,c;if(!d&&(f=s=m)&&e.lineStart(),m!==s&&(c=a(d,h),(gf(d,c)||gf(h,c))&&(h[0]+=Kz,h[1]+=Kz,m=n(h[0],h[1]))),m!==s)p=0,m?(e.lineStart(),c=a(h,d),e.point(c[0],c[1])):(c=a(d,h),e.point(c[0],c[1]),e.lineEnd()),d=c;else if(r&&d&&o^m){var b;!(y&l)&&(b=a(h,d,!0))&&(p=0,o?(e.lineStart(),e.point(b[0][0],b[0][1]),e.point(b[1][0],b[1][1]),e.lineEnd()):(e.point(b[1][0],b[1][1]),e.lineEnd(),e.lineStart(),e.point(b[0][0],b[0][1])))}!m||d&&gf(d,h)||e.point(h[0],h[1]),d=h,s=m,l=y},lineEnd:function(){s&&e.lineEnd(),d=null},clean:function(){return p|(f&&s)<<1}}},function(n,a,i,d){ff(d,e,t,i,n,a)},o?[0,-e]:[-Qz,e-Qz])}function Zf(e){return function(t){var n=new Kf;for(var a in e)n[a]=e[a];return n.stream=t,n}}function Kf(){}function Qf(e,t,n){var a=t[1][0]-t[0][0],i=t[1][1]-t[0][1],d=e.clipExtent&&e.clipExtent();e.scale(150).translate([0,0]),null!=d&&e.clipExtent(null),Cs(n,e.stream(hR));var r=hR.result(),o=Zx(a/(r[1][0]-r[0][0]),i/(r[1][1]-r[0][1])),l=+t[0][0]+(a-o*(r[1][0]+r[0][0]))/2,s=+t[0][1]+(i-o*(r[1][1]+r[0][1]))/2;return null!=d&&e.clipExtent(d),e.scale(150*o).translate([l,s])}function ec(e,t,n){return Qf(e,[[0,0],t],n)}function tc(e,t){return+t?ac(e,t):nc(e)}function nc(e){return Zf({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function ac(e,t){function n(i,d,r,o,l,s,f,u,g,h,y,_,x,v){var k=f-i,w=u-d,S=k*k+w*w;if(S>4*t&&x--){var E=o+h,a=l+y,b=s+_,c=hT(E*E+a*a+b*b),m=vs(b/=c),C=dT(dT(b)-1)<Kz||dT(r-g)<Kz?(r+g)/2:oT(a,E),z=e(C,m),p=z[0],T=z[1],R=p-i,A=T-d,O=w*R-k*A;(O*O/S>t||0.3<dT((k*R+w*A)/S-0.5)||o*h+l*y+s*_<WR)&&(n(i,d,r,o,l,s,p,T,C,E/=c,a/=c,b,x,v),v.point(p,T),n(p,T,C,E,a,b,f,u,g,h,y,_,x,v))}}return function(t){function a(n,a){n=e(n,a),t.point(n[0],n[1])}function i(){b=NaN,f.point=d,t.lineStart()}function d(a,i){var d=Ps([a,i]),r=e(a,i);n(b,_,y,x,v,k,b=r[0],_=r[1],y=a,x=d[0],v=d[1],k=d[2],GR,t),t.point(b,_)}function r(){f.point=a,t.lineEnd()}function o(){i(),f.point=l,f.lineEnd=s}function l(e,t){d(c=e,t),p=b,u=_,g=x,h=v,m=k,f.point=d}function s(){n(b,_,y,x,v,k,p,u,c,g,h,m,GR,t),f.lineEnd=r,r()}var f={point:a,lineStart:i,lineEnd:r,polygonStart:function(){t.polygonStart(),f.lineStart=o},polygonEnd:function(){t.polygonEnd(),f.lineStart=i}},c,p,u,g,h,m,y,b,_,x,v,k;return f}}function ic(e){return dc(function(){return e})()}function dc(e){function t(e){return e=S(e[0]*iT,e[1]*iT),[e[0]*r+v,k-e[1]*r]}function n(e){return e=S.invert((e[0]-v)/r,(k-e[1])/r),e&&[e[0]*aT,e[1]*aT]}function a(e,t){return e=_(e,t),[e[0]*r+v,k-e[1]*r]}function i(){S=nf(w=df(c,p,u),_);var e=_(s,f);return v=o-e[0]*r,k=l+e[1]*r,d()}function d(){return T=R=null,t}var r=150,o=480,l=250,s=0,f=0,c=0,p=0,u=0,g=null,h=YR,m=null,y=Cf,b=0.5,x=tc(a,b),_,v,k,w,S,E,C,z,T,R;return t.stream=function(e){return T&&R===e?T:T=HR(h(w,x(y(R=e))))},t.clipAngle=function(e){return arguments.length?(h=+e?Jf(g=e*iT,6*iT):(g=null,YR),d()):g*aT},t.clipExtent=function(e){return arguments.length?(y=null==e?(m=E=C=z=null,Cf):bf(m=+e[0][0],E=+e[0][1],C=+e[1][0],z=+e[1][1]),d()):null==m?null:[[m,E],[C,z]]},t.scale=function(e){return arguments.length?(r=+e,i()):r},t.translate=function(e){return arguments.length?(o=+e[0],l=+e[1],i()):[o,l]},t.center=function(e){return arguments.length?(s=e[0]%360*iT,f=e[1]%360*iT,i()):[s*aT,f*aT]},t.rotate=function(e){return arguments.length?(c=e[0]%360*iT,p=e[1]%360*iT,u=2<e.length?e[2]%360*iT:0,i()):[c*aT,p*aT,u*aT]},t.precision=function(e){return arguments.length?(x=tc(a,b=e*e),d()):hT(b)},t.fitExtent=function(e,n){return Qf(t,e,n)},t.fitSize=function(e,n){return ec(t,e,n)},function(){return _=e.apply(this,arguments),t.invert=_.invert&&n,i()}}function rc(e){var t=0,n=Qz/3,a=dc(e),i=a(t,n);return i.parallels=function(e){return arguments.length?a(t=e[0]*iT,n=e[1]*iT):[t*aT,n*aT]},i}function oc(e){function t(e,t){return[e*n,uT(t)/n]}var n=lT(e);return t.invert=function(e,t){return[e/n,vs(t*n)]},t}function lc(e,t){function a(e,t){var a=hT(n-2*d*uT(t))/d;return[a*uT(e*=d),o-a*lT(e)]}var i=uT(e),d=(i+uT(t))/2;if(dT(d)<Kz)return oc(e);var n=1+i*(2*d-i),o=hT(n)/d;return a.invert=function(e,t){var a=o-t;return[oT(e,dT(a))/d*gT(a),vs((n-(e*e+a*a)*d*d)/(2*d))]},a}function sc(){return rc(lc).scale(155.424).center([0,33.6442])}function fc(){return sc().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-0.6,38.7])}function cc(e){var t=e.length;return{point:function(n,a){for(var d=-1;++d<t;)e[d].point(n,a)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function pc(e){return function(t,n){var a=lT(t),i=lT(n),d=e(a*i);return[d*i*uT(t),d*uT(n)]}}function uc(e){return function(t,n){var a=hT(t*t+n*n),i=e(a),d=uT(i),r=lT(i);return[oT(t*d,a*r),vs(a&&n*d/a)]}}function gc(e,t){return[e,cT(mT((eT+t)/2))]}function hc(e){function t(){var a=Qz*i(),d=n(sf(n.rotate()).invert([0,0]));return r(null==o?[[d[0]-a,d[1]-a],[d[0]+a,d[1]+a]]:e===gc?[[nv(d[0]-a,o),l],[Zx(d[0]+a,s),f]]:[[o,nv(d[1]-a,l)],[s,Zx(d[1]+a,f)]])}var n=ic(e),a=n.center,i=n.scale,d=n.translate,r=n.clipExtent,o=null,l,s,f;return n.scale=function(e){return arguments.length?(i(e),t()):i()},n.translate=function(e){return arguments.length?(d(e),t()):d()},n.center=function(e){return arguments.length?(a(e),t()):a()},n.clipExtent=function(e){return arguments.length?(null==e?o=l=s=f=null:(o=+e[0][0],l=+e[0][1],s=+e[1][0],f=+e[1][1]),t()):null==o?null:[[o,l],[s,f]]},t()}function mc(e){return mT((eT+e)/2)}function yc(e,t){function a(e,t){0<n?t<-eT+Kz&&(t=-eT+Kz):t>eT-Kz&&(t=eT-Kz);var a=n/pT(mc(t),d);return[a*uT(d*e),n-a*lT(d*e)]}var i=lT(e),d=e===t?uT(e):cT(i/lT(t))/cT(mc(t)/mc(e)),n=i*pT(mc(e),d)/d;return d?(a.invert=function(e,t){var a=n-t,i=gT(d)*hT(e*e+a*a);return[oT(e,dT(a))/d*gT(a),2*rT(pT(n/i,1/d))-eT]},a):gc}function bc(e,t){return[e,t]}function _c(e,t){function a(e,t){var a=n-t,i=d*e;return[a*uT(i),n-a*lT(i)]}var i=lT(e),d=e===t?uT(e):(i-lT(t))/(t-e),n=i/d+e;return dT(d)<Kz?bc:(a.invert=function(e,t){var a=n-t;return[oT(e,dT(a))/d*gT(a),n-gT(d)*hT(e*e+a*a)]},a)}function xc(e,t){var n=lT(t),a=lT(e)*n;return[n*uT(e)/a,uT(t)/a]}function vc(e,t){return[lT(t)*uT(e),uT(t)]}function kc(e,t){var n=lT(t),a=1+lT(e)*n;return[n*uT(e)/a,uT(t)/a]}function wc(e,t){return[cT(mT((eT+t)/2)),-e]}function Sc(e,t){return function n(){var a=t();return a.type=e,a.path=Gf().projection(a),a.copy=a.copy||function(){var e=n();return ZR.forEach(function(t){a.hasOwnProperty(t)&&e[t](a[t]())}),e.path.pointRadius(a.path.pointRadius()),e},a}}function Ec(e,t){return 1<arguments.length?(KR[e]=Sc(e,t),this):KR.hasOwnProperty(e)?KR[e]:null}function Cc(e){return e&&e.path||JR}function zc(e){jd.call(this,null,e)}function Tc(e){jd.call(this,null,e)}function Rc(e){jd.call(this,null,e)}function Ac(e,t){var n=function(n){return e(t(n))};return n.context=function(t){return e.context(t),n},n}function Oc(e){jd.call(this,[],e),this.generator=Ef()}function Pc(e){jd.call(this,null,e),this.modified(!0)}function Mc(e,t){var n=Dc(t.fit);t.extent?e.fitExtent(t.extent,n):t.size?e.fitSize(t.size,n):0}function Dc(e){return fv(e)?1<e.length?{type:'FeatureCollection',features:e}:e[0]:e}function Lc(e){var t=Ec((e||'mercator').toLowerCase());return t||F('Unrecognized projection type: '+e),t()}function qc(e,t,n){V(e[t])&&e[t](n)}function Uc(e,t){return e.ticks?e.ticks(t):e.domain()}function Fc(e,t,n){var a=e.tickFormat?e.tickFormat(t,n):String;return e.type===dA?jc(a,$c(n)):a}function jc(e,t){return function(n){return e(n)?t(n):''}}function $c(e){var t=rl(e||',');if(null==t.precision){switch(t.precision=12,t.type){case'%':t.precision-=2;break;case'e':t.precision-=1;}return Nc(lC(t),lC('.1f')(1)[1])}return lC(t)}function Nc(e,t){return function(n){var a=e(n),i=a.indexOf(t),d,r;if(0>i)return a;for(d=Ic(a,i),r=d<a.length?a.slice(d):'';--d>i;)if('0'!==a[d]){++d;break}return a.slice(0,d)+r}}function Ic(e,t){var n=e.lastIndexOf('e'),a;if(0<n)return n;for(n=e.length;--n>t;)if(a=e.charCodeAt(n),48<=a&&57>=a)return n+1}function Bc(e){jd.call(this,null,e)}function Yc(e){jd.call(this,null,e)}function Gc(){return md({})}function Wc(e){return e.exit}function Hc(e){jd.call(this,null,e)}function Xc(e,t,n){if(n)return e.domain();var a=bA[e.type];return a?a(e):Uc(e,t)}function Vc(e){var t=e.domain();return t.max=t.pop(),t}function Jc(e,t){return bA[e.type]?Zc(t):Qc(t)}function Zc(e){return function(t,n,a){var i=a[n+1]||a.max||+Infinity,d=Kc(t,e),r=Kc(i,e);return d&&r?d+'\u2013'+r:r?'< '+r:'\u2265 '+d}}function Kc(e,t){return isFinite(e)?t(e):null}function Qc(e){return function(t){return e(t)}}function ep(e){jd.call(this,[],e)}function tp(e){return e.source.x}function np(e){return e.source.y}function ap(e){return e.target.x}function ip(e){return e.target.y}function dp(e){jd.call(this,{},e)}function rp(e,t,n,a){return'M'+e+','+t+'L'+n+','+a}function op(e,t,n,a){var i=n-e,d=a-t,r=Hx(i*i+d*d)/2,o=180*jx(d,i)/Gx;return'M'+e+','+t+'A'+r+','+r+' '+o+' 0 1 '+n+','+a}function lp(e,t,n,a){var i=n-e,d=a-t,r=0.2*(i+d),o=0.2*(d-i);return'M'+e+','+t+'C'+(e+r)+','+(t+o)+' '+(n+o)+','+(a-r)+' '+n+','+a}function sp(e){jd.call(this,null,e)}function fp(e){jd.call(this,null,e),this.modified(!0)}function cp(e,t,a){var i=pp(e,t.domainRaw);if(-1<i)return i;var d=t.domain,r=t.zero||void 0===t.zero&&SA[e.type],o,n;return d?((r||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(o=(d=d.slice()).length-1||1,r&&(0<d[0]&&(d[0]=0),0>d[o]&&(d[o]=0)),null!=t.domainMin&&(d[0]=t.domainMin),null!=t.domainMax&&(d[o]=t.domainMax),null!=t.domainMid&&(n=t.domainMid,(n<d[0]||n>d[o])&&a.warn('Scale domainMid exceeds domain min or max.',n),d.splice(o,0,n))),e.domain(d),t.nice&&e.nice&&e.nice(!0!==t.nice&&+t.nice||null),d.length):0}function pp(e,t){return t?(e.domain(t),t.length):-1}function up(e,t,n){var a=t.round||!1,i=t.range;if(null!=t.rangeStep)i=gp(e.type,t,n);else if(t.scheme){if(i=hp(e.type,t,n),V(i))return e.interpolator(i);}else if(i&&e.type===gA)return e.interpolator(LE(yp(i,t.reverse)));i&&t.interpolate&&e.interpolate?e.interpolate(Kl(t.interpolate,t.interpolateGamma)):V(e.round)?e.round(a):V(e.rangeRound)&&e.interpolate(a?Uo:qo),i&&e.range(yp(i,t.reverse))}function gp(e,t,n){e!==rA&&e!==oA&&F('Only band and point scales support rangeStep.');var a=(null==t.paddingOuter?t.padding:t.paddingOuter)||0,i=e===oA?1:(null==t.paddingInner?t.padding:t.paddingInner)||0;return[0,t.rangeStep*Br(n,i,a)]}function hp(e,t,n){var a=t.scheme.toLowerCase(),i=Xl(a),d=t.schemeExtent,r;return i||F('Unrecognized scheme name: '+t.scheme),n=e===pA?n+1:e===uA?n-1:e===fA||e===cA?+t.schemeCount||wA:n,e===gA?mp(i,d,t.reverse):!d&&(r=Xl(a+'-'+n))?r:V(i)?bp(mp(i,d),n):e===sA?i:i.slice(0,n)}function mp(e,t,n){return V(e)&&(t||n)?Vl(e,yp(t||[0,1],n)):e}function yp(e,t){return t?e.slice().reverse():e}function bp(e,t){for(var n=Array(t),a=0;a<t;++a)n[a]=e(a/(t-1||1));return n}function _p(e){jd.call(this,null,e)}function xp(e){jd.call(this,null,e)}function vp(e,n,a,i,d){for(var r=(n-e.sum)/2,o=e.length,l=0,s;l<o;++l)s=e[l],s[i]=r,s[d]=r+=Vx(a(s))}function kp(e,n,a,i,d){for(var r=1/e.sum,o=0,l=e.length,s=0,f=0,c;s<l;++s)c=e[s],c[i]=o,c[d]=o=r*(f+=Vx(a(c)))}function wp(e,n,a,i,d){for(var r=0,o=0,l=e.length,s=0,f,c;s<l;++s)c=e[s],f=a(c),0>f?(c[i]=o,c[d]=o+=f):(c[i]=r,c[d]=r+=f)}function Sp(e,a,d,r){var o=[],l=function(e){return e(p)},f,c,i,n,p,t,u,g,s;if(null==a)o.push(e.slice());else for(f={},c=0,i=e.length;c<i;++c)p=e[c],t=a.map(l),u=f[t]||(o.push(f[t]=[]),f[t]),u.push(p);for(t=0,s=0,n=o.length;t<n;++t){for(u=o[t],c=0,g=0,i=u.length;c<i;++c)g+=Vx(r(u[c]));u.sum=g,g>s&&(s=g),d&&u.sort(d)}return o.max=s,o}function Ep(e){return function(){return e}}function Cp(){return 1e-6*(Math.random()-0.5)}function zp(e,t,n,a){if(isNaN(t)||isNaN(n))return e;var r=e._root,o={data:a},l=e._x0,s=e._y0,f=e._x1,c=e._y1,p,u,g,h,m,y,b,_,i;if(!r)return e._root=o,e;for(;r.length;)if((y=t>=(u=(l+f)/2))?l=u:f=u,(b=n>=(g=(s+c)/2))?s=g:c=g,(p=r,!(r=r[_=b<<1|y])))return p[_]=o,e;if(h=+e._x.call(null,r.data),m=+e._y.call(null,r.data),t===h&&n===m)return o.next=r,p?p[_]=o:e._root=o,e;do p=p?p[_]=[,,,,]:e._root=[,,,,],(y=t>=(u=(l+f)/2))?l=u:f=u,(b=n>=(g=(s+c)/2))?s=g:c=g;while((_=b<<1|y)===(i=(m>=g)<<1|h>=u));return p[i]=r,p[_]=o,e}function Tp(e,t,n,a,i){this.node=e,this.x0=t,this.y0=n,this.x1=a,this.y1=i}function Rp(e){return e[0]}function Ap(e){return e[1]}function Op(e,t,n){var a=new Pp(null==t?Rp:t,null==n?Ap:n,NaN,NaN,NaN,NaN);return null==e?a:a.addAll(e)}function Pp(e,t,n,a,i,d){this._x=e,this._y=t,this._x0=n,this._y0=a,this._x1=i,this._y1=d,this._root=void 0}function Mp(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}function Dp(e){return e.x+e.vx}function Lp(e){return e.y+e.vy}function qp(e){return e.index}function Up(e,t){var n=e.get(t);if(!n)throw new Error('missing: '+t);return n}function Fp(){return LA||(FA(jp),LA=UA.now()+qA)}function jp(){LA=0}function $p(){this._call=this._time=this._next=null}function Np(e,n,a){var i=new $p;return i.restart(e,n,a),i}function Ip(){Fp(),++AA;for(var n=jA,t;n;)0<=(t=LA-n._time)&&n._call.call(null,t),n=n._next;--AA}function Bp(){LA=(DA=UA.now())+qA,AA=OA=0;try{Ip()}finally{AA=0,Gp(),LA=0}}function Yp(){var e=UA.now(),t=e-DA;t>MA&&(qA-=t,DA=e)}function Gp(){for(var e=jA,t=Infinity,n,a;e;)e._call?(t>e._time&&(t=e._time),n=e,e=e._next):(a=e._next,e._next=null,e=n?n._next=a:jA=a);$A=n,Wp(t)}function Wp(e){if(!AA){OA&&(OA=clearTimeout(OA));var t=e-LA;24<t?(e<Infinity&&(OA=setTimeout(Bp,t)),PA&&(PA=clearInterval(PA))):(!PA&&(DA=LA,PA=setInterval(Yp,MA)),AA=1,FA(Bp))}}function Hp(e){return e.x}function Xp(e){return e.y}function Vp(e){function t(){n(),p.call('tick',u),d<r&&(c.stop(),p.call('end',u))}function n(){var t=e.length,n,a;for(d+=(l-d)*o,f.each(function(e){e(d)}),n=0;n<t;++n)a=e[n],null==a.fx?a.x+=a.vx*=s:(a.x=a.fx,a.vx=0),null==a.fy?a.y+=a.vy*=s:(a.y=a.fy,a.vy=0)}function a(){for(var t=0,a=e.length,n;t<a;++t){if(n=e[t],n.index=t,isNaN(n.x)||isNaN(n.y)){var i=NA*Hx(t),d=t*IA;n.x=i*Bx(d),n.y=i*Ix(d)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function i(t){return t.initialize&&t.initialize(e),t}var d=1,r=1e-3,o=1-Qx(r,1/300),l=0,s=0.6,f=_e(),c=Np(t),p=Ee('tick','end'),u;return null==e&&(e=[]),a(),u={tick:n,restart:function(){return c.restart(t),u},stop:function(){return c.stop(),u},nodes:function(t){return arguments.length?(e=t,a(),f.each(i),u):e},alpha:function(e){return arguments.length?(d=+e,u):d},alphaMin:function(e){return arguments.length?(r=+e,u):r},alphaDecay:function(e){return arguments.length?(o=+e,u):+o},alphaTarget:function(e){return arguments.length?(l=+e,u):l},velocityDecay:function(e){return arguments.length?(s=1-e,u):1-s},force:function(e,t){return 1<arguments.length?(null==t?f.remove(e):f.set(e,i(t)),u):f.get(e)},find:function(t,a,d){var r=0,i=e.length,n,o,l,s,f;for(null==d?d=Infinity:d*=d,r=0;r<i;++r)s=e[r],n=t-s.x,o=a-s.y,l=n*n+o*o,l<d&&(f=s,d=l);return f},on:function(e,t){return 1<arguments.length?(p.on(e,t),u):p.on(e)}}}function Jp(e){jd.call(this,null,e)}function Zp(e,t){return function(){e.touch(t).run()}}function Kp(e,t){var n=Vp(e),a=!1,i=n.stop,d=n.restart;return n.stopped=function(){return a},n.restart=function(){return a=!1,d()},n.stop=function(){return a=!0,i()},Qp(n,t,!0).on('end',function(){a=!0})}function Qp(e,t,a){var d=H(t.forces),r,i,n;for(r=0,i=GA.length;r<i;++r)n=GA[r],n!==YA&&t.modified(n)&&e[n](t[n]);for(r=0,i=d.length;r<i;++r)(a||t.modified(YA,r))&&e.force(YA+r,eu(d[r]));for(i=e.numForces||0;r<i;++r)e.force(YA+r,null);return e.numForces=d.length,e}function eu(e){var t,n;for(n in BA.hasOwnProperty(e.force)||F('Unrecognized force: '+e.force),t=BA[e.force](),e)V(t[n])&&t[n](e[n]);return t}function tu(e,t){return e.parent===t.parent?1:2}function nu(e){return e.reduce(au,0)/e.length}function au(e,t){return e+t.x}function iu(e){return 1+e.reduce(du,0)}function du(e,t){return nv(e,t.y)}function ru(e){for(var t;t=e.children;)e=t[0];return e}function ou(e){for(var t;t=e.children;)e=t[t.length-1];return e}function lu(){function e(e){var d=0,r;e.eachAfter(function(e){var n=e.children;n?(e.x=nu(n),e.y=iu(n)):(e.x=r?d+=t(e,r):0,e.y=0,r=e)});var o=ru(e),l=ou(e),s=o.x-t(o,l)/2,f=l.x+t(l,o)/2;return e.eachAfter(i?function(t){t.x=(t.x-e.x)*n,t.y=(e.y-t.y)*a}:function(t){t.x=(t.x-s)/(f-s)*n,t.y=(1-(e.y?t.y/e.y:1))*a})}var t=tu,n=1,a=1,i=!1;return e.separation=function(n){return arguments.length?(t=n,e):t},e.size=function(t){return arguments.length?(i=!1,n=+t[0],a=+t[1],e):i?null:[n,a]},e.nodeSize=function(t){return arguments.length?(i=!0,n=+t[0],a=+t[1],e):i?[n,a]:null},e}function su(e){var t=0,n=e.children,a=n&&n.length;if(!a)t=1;else for(;0<=--a;)t+=n[a].value;e.value=t}function fu(e,t){if(e===t)return e;var n=e.ancestors(),a=t.ancestors(),i=null;for(e=n.pop(),t=a.pop();e===t;)i=e,e=n.pop(),t=a.pop();return i}function cu(e,t){var a=new hu(e),d=+e.value&&(a.value=e.value),r=[a],o,l,s,f,i;for(null==t&&(t=pu);o=r.pop();)if(d&&(o.value=+o.data.value),(s=t(o.data))&&(i=s.length))for(o.children=Array(i),f=i-1;0<=f;--f)r.push(l=o.children[f]=new hu(s[f])),l.parent=o,l.depth=o.depth+1;return a.eachBefore(gu)}function pu(e){return e.children}function uu(e){e.data=e.data.data}function gu(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function hu(e){this.data=e,this.depth=this.height=0,this.parent=null}function mu(e){this._=e,this.next=null}function yu(e){for(var t=(e=e.slice()).length,n=null,a=n,d;t;){var i=new mu(e[t-1]);a=a?a.next=i:n=i,e[d]=e[--t]}return{head:n,tail:a}}function bu(e){return xu(yu(e),[])}function _u(e,t){var n=t.x-e.x,a=t.y-e.y,i=e.r-t.r;return i*i+1e-6>n*n+a*a}function xu(e,t){var n=null,a=e.head,i,d,r;switch(t.length){case 1:i=vu(t[0]);break;case 2:i=ku(t[0],t[1]);break;case 3:i=wu(t[0],t[1],t[2]);}for(;a;)r=a._,d=a.next,i&&_u(i,r)?n=a:(n?(e.tail=n,n.next=null):e.head=e.tail=null,t.push(r),i=xu(e,t),t.pop(),e.head?(a.next=e.head,e.head=a):(a.next=null,e.head=e.tail=a),n=e.tail,n.next=d),a=d;return e.tail=n,i}function vu(e){return{x:e.x,y:e.y,r:e.r}}function ku(e,t){var n=e.x,a=e.y,i=e.r,d=t.x,r=t.y,o=t.r,s=d-n,f=r-a,c=o-i,p=Hx(s*s+f*f);return{x:(n+d+s/p*c)/2,y:(a+r+f/p*c)/2,r:(p+i+o)/2}}function wu(e,t,n){var a=e.x,i=e.y,d=e.r,o=t.x,l=t.y,s=t.r,f=n.x,c=n.y,p=n.r,u=2*(a-o),g=2*(i-l),h=2*(s-d),m=a*a+i*i-d*d-o*o-l*l+s*s,y=2*(a-f),b=2*(i-c),_=2*(p-d),x=a*a+i*i-d*d-f*f-c*c+p*p,v=y*g-u*b,k=(g*x-b*m)/v-a,w=(b*h-g*_)/v,S=(y*m-u*x)/v-i,E=(u*_-y*h)/v,C=w*w+E*E-1,z=2*(k*w+S*E+d),T=(-z-Hx(z*z-4*C*(k*k+S*S-d*d)))/(2*C);return{x:k+w*T+a,y:S+E*T+i,r:T}}function Su(e,t,n){var a=e.x,i=e.y,d=t.r+n.r,r=e.r+n.r,o=t.x-a,l=t.y-i,s=o*o+l*l;if(s){var f=0.5+((r*=r)-(d*=d))/(2*s),c=Hx(nv(0,2*d*(r+s)-(r-=s)*r-d*d))/(2*s);n.x=a+f*o+c*l,n.y=i+f*l-c*o}else n.x=a+r,n.y=i}function Eu(e,t){var n=t.x-e.x,a=t.y-e.y,i=e.r+t.r;return i*i-1e-6>n*n+a*a}function Cu(e,t,n){var i=e._,a=e.next._,d=i.r+a.r,r=(i.x*a.r+a.x*i.r)/d-t,o=(i.y*a.r+a.y*i.r)/d-n;return r*r+o*o}function zu(e){this._=e,this.next=null,this.previous=null}function Tu(e){if(!(r=e.length))return 0;var t,a,d,r;if(t=e[0],t.x=0,t.y=0,!(1<r))return t.r;if(a=e[1],t.x=-a.r,a.x=t.r,a.y=0,!(2<r))return t.r+a.r;Su(a,t,d=e[2]);var n=t.r*t.r,o=a.r*a.r,l=d.r*d.r,s=n+o+l,f=n*t.x+o*a.x+l*d.x,c=n*t.y+o*a.y+l*d.y,p,u,g,i,h,m,y;t=new zu(t),a=new zu(a),d=new zu(d),t.next=d.previous=a,a.next=t.previous=d,d.next=a.previous=t;pack:for(g=3;g<r;++g){Su(t._,a._,d=e[g]),d=new zu(d),i=a.next,h=t.previous,m=a._.r,y=t._.r;do if(m<=y){if(Eu(i._,d._)){a=i,t.next=a,a.previous=t,--g;continue pack}m+=i._.r,i=i.next}else{if(Eu(h._,d._)){t=h,t.next=a,a.previous=t,--g;continue pack}y+=h._.r,h=h.previous}while(i!==h.next);for(d.previous=t,d.next=a,t.next=a.previous=a=d,s+=l=d._.r*d._.r,f+=l*d._.x,c+=l*d._.y,n=Cu(t,p=f/s,u=c/s);(d=d.next)!==a;)(l=Cu(d,p,u))<n&&(t=d,n=l);a=t.next}for(t=[a._],d=a;(d=d.next)!==a;)t.push(d._);for(d=bu(t),g=0;g<r;++g)t=e[g],t.x-=d.x,t.y-=d.y;return d.r}function Ru(e){return null==e?null:Au(e)}function Au(e){if('function'!==typeof e)throw new Error;return e}function Ou(){return 0}function Pu(e){return function(){return e}}function Mu(e){return Hx(e.value)}function Du(e){return function(t){t.children||(t.r=nv(0,+e(t)||0))}}function Lu(t,a){return function(d){if(r=d.children){var o=r.length,n=t(d)*a||0,r,l,i;if(n)for(l=0;l<o;++l)r[l].r+=n;if(i=Tu(r),n)for(l=0;l<o;++l)r[l].r-=n;d.r=i+n}}}function qu(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function Uu(e){e.x0=ev(e.x0),e.y0=ev(e.y0),e.x1=ev(e.x1),e.y1=ev(e.y1)}function Fu(e,t,a,d,r){for(var o=e.children,l=-1,i=o.length,n=e.value&&(d-t)/e.value,s;++l<i;)s=o[l],s.y0=a,s.y1=r,s.x0=t,s.x1=t+=s.value*n}function ju(e){return e.id}function $u(e){return e.parentId}function Nu(){function e(e){var r=e.length,n=Array(r),o={},l,d,i,s,f,c,p;for(d=0;d<r;++d)l=e[d],f=n[d]=new hu(l),null!=(c=t(l,d,e))&&(c+='')&&(p=VA+(f.id=c),o[p]=p in o?ZA:f);for(d=0;d<r;++d)if(f=n[d],c=a(e[d],d,e),null==c||!(c+='')){if(i)throw new Error('multiple roots');i=f}else{if(s=o[VA+c],!s)throw new Error('missing: '+c);if(s===ZA)throw new Error('ambiguous: '+c);s.children?s.children.push(f):s.children=[f],f.parent=s}if(!i)throw new Error('no root');if(i.parent=JA,i.eachBefore(function(e){e.depth=e.parent.depth+1,--r}).eachBefore(gu),i.parent=null,0<r)throw new Error('cycle');return i}var t=ju,a=$u;return e.id=function(n){return arguments.length?(t=Au(n),e):t},e.parentId=function(t){return arguments.length?(a=Au(t),e):a},e}function Iu(e,t){return e.parent===t.parent?1:2}function Bu(e){var t=e.children;return t?t[0]:e.t}function Yu(e){var t=e.children;return t?t[t.length-1]:e.t}function Gu(e,t,n){var a=n/(t.i-e.i);t.c-=a,t.s+=n,e.c+=a,t.z+=n,t.m+=n}function Wu(e){for(var t=0,n=0,a=e.children,d=a.length,i;0<=--d;)i=a[d],i.z+=t,i.m+=t,t+=i.s+(n+=i.c)}function Hu(e,t,n){return e.a.parent===t.parent?e.a:n}function Xu(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function Vu(e){for(var t=new Xu(e,0),a=[t],d,r,o,l,i;d=a.pop();)if(o=d._.children)for(d.children=Array(i=o.length),l=i-1;0<=l;--l)a.push(r=d.children[l]=new Xu(o[l],l)),r.parent=d;return(t.parent=new Xu(null,0)).children=[t],t}function Ju(){function e(e){var f=Vu(e);if(f.eachAfter(n),f.parent.m=-f.z,f.eachBefore(a),l)e.eachBefore(i);else{var t=e,c=e,p=e;e.eachBefore(function(e){e.x<t.x&&(t=e),e.x>c.x&&(c=e),e.depth>p.depth&&(p=e)});var u=t===c?1:d(t,c)/2,s=u-t.x,g=r/(c.x+u+s),h=o/(p.depth||1);e.eachBefore(function(e){e.x=(e.x+s)*g,e.y=e.depth*h})}return e}function n(e){var n=e.children,a=e.parent.children,i=e.i?a[e.i-1]:null;if(n){Wu(e);var r=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+d(e._,i._),e.m=e.z-r):e.z=r}else i&&(e.z=i.z+d(e._,i._));e.parent.A=t(e,i,e.parent.A||a[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function t(e,t,n){if(t){for(var a=e,i=e,r=t,o=a.parent.children[0],l=a.m,s=i.m,f=r.m,c=o.m,p;r=Yu(r),a=Bu(a),r&&a;)o=Bu(o),i=Yu(i),i.a=e,p=r.z+f-a.z-l+d(r._,a._),0<p&&(Gu(Hu(r,e,n),e,p),l+=p,s+=p),f+=r.m,l+=a.m,c+=o.m,s+=i.m;r&&!Yu(i)&&(i.t=r,i.m+=f-s),a&&!Bu(o)&&(o.t=a,o.m+=l-c,n=e)}return n}function i(e){e.x*=r,e.y=e.depth*o}var d=Iu,r=1,o=1,l=null;return e.separation=function(t){return arguments.length?(d=t,e):d},e.size=function(t){return arguments.length?(l=!1,r=+t[0],o=+t[1],e):l?null:[r,o]},e.nodeSize=function(t){return arguments.length?(l=!0,r=+t[0],o=+t[1],e):l?[r,o]:null},e}function Zu(e,t,a,d,r){for(var o=e.children,l=-1,i=o.length,n=e.value&&(r-a)/e.value,s;++l<i;)s=o[l],s.x0=t,s.x1=d,s.y0=a,s.y1=a+=s.value*n}function Ku(e,t,a,i,d,r){for(var o=[],l=t.children,s=0,f=0,c=l.length,n=t.value,p,u,g,h,m,y,b,_,x,v,k;s<c;){g=d-a,h=r-i;do m=l[f++].value;while(!m&&f<c);for(y=b=m,v=nv(h/g,g/h)/(n*e),k=m*m*v,x=nv(b/k,k/y);f<c;++f){if(m+=u=l[f].value,u<y&&(y=u),u>b&&(b=u),k=m*m*v,_=nv(b/k,k/y),_>x){m-=u;break}x=_}o.push(p={value:m,dice:g<h,children:l.slice(s,f)}),p.dice?Fu(p,a,i,d,n?i+=h*m/n:r):Zu(p,a,i,n?a+=g*m/n:d,r),n-=m,s=f}return o}function Qu(){function e(e){return e.x0=e.y0=0,e.x1=i,e.y1=d,e.eachBefore(t),r=[0],a&&e.eachBefore(Uu),e}function t(e){var t=r[e.depth],a=e.x0+t,i=e.y0+t,d=e.x1-t,p=e.y1-t;d<a&&(a=d=(a+d)/2),p<i&&(i=p=(i+p)/2),e.x0=a,e.y0=i,e.x1=d,e.y1=p,e.children&&(t=r[e.depth+1]=o(e)/2,a+=c(e)-t,i+=l(e)-t,d-=s(e)-t,p-=f(e)-t,d<a&&(a=d=(a+d)/2),p<i&&(i=p=(i+p)/2),n(e,a,i,d,p))}var n=QA,a=!1,i=1,d=1,r=[0],o=Ou,l=Ou,s=Ou,f=Ou,c=Ou;return e.round=function(t){return arguments.length?(a=!!t,e):a},e.size=function(t){return arguments.length?(i=+t[0],d=+t[1],e):[i,d]},e.tile=function(t){return arguments.length?(n=Au(t),e):n},e.padding=function(t){return arguments.length?e.paddingInner(t).paddingOuter(t):e.paddingInner()},e.paddingInner=function(t){return arguments.length?(o='function'===typeof t?t:Pu(+t),e):o},e.paddingOuter=function(t){return arguments.length?e.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):e.paddingTop()},e.paddingTop=function(t){return arguments.length?(l='function'===typeof t?t:Pu(+t),e):l},e.paddingRight=function(t){return arguments.length?(s='function'===typeof t?t:Pu(+t),e):s},e.paddingBottom=function(t){return arguments.length?(f='function'===typeof t?t:Pu(+t),e):f},e.paddingLeft=function(t){return arguments.length?(c='function'===typeof t?t:Pu(+t),e):c},e}function eg(e){jd.call(this,null,e)}function tg(e){return e.values}function ng(e){jd.call(this,null,e)}function ag(e){jd.call(this,{},e)}function ig(e){var t;return e.parent&&(t=e.parent.data)&&null!=gd(t)&&t}function dg(e){jd.call(this,null,e)}function rg(e,t,a){for(var d=0,i=t.length,n;d<i;++d)n=t[d],n in a&&e[n](a[n])}function og(e,a,d){for(var r=e.data,t=0,i=a.length-1;t<i;++t)r[d[t]]=e[a[t]];r[d[i]]=e.children?e.children.length:0}function lg(e){dg.call(this,e)}function sg(e){dg.call(this,e)}function fg(e){dg.call(this,e)}function cg(e){dg.call(this,e)}function pg(e){return function(){return e}}function ug(e){return e[0]}function gg(e){return e[1]}function hg(){this._=null}function mg(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function yg(e,t){var n=t,a=t.R,i=n.U;i?i.L===n?i.L=a:i.R=a:e._=a,a.U=i,n.U=a,n.R=a.L,n.R&&(n.R.U=n),a.L=n}function bg(e,t){var n=t,a=t.L,i=n.U;i?i.L===n?i.L=a:i.R=a:e._=a,a.U=i,n.U=a,n.L=a.R,n.L&&(n.L.U=n),a.R=n}function _g(e){for(;e.L;)e=e.L;return e}function xg(e,t,n,a){var i=[null,null],d=hO.push(i)-1;return i.left=e,i.right=t,n&&kg(i,e,t,n),a&&kg(i,t,e,a),uO[e.index].halfedges.push(d),uO[t.index].halfedges.push(d),i}function vg(e,t,n){var a=[t,n];return a.left=e,a}function kg(e,t,n,a){e[0]||e[1]?e.left===n?e[1]=a:e[0]=a:(e[0]=a,e.left=t,e.right=n)}function wg(e,t,n,i,d){var o=e[0],a=e[1],l=o[0],s=o[1],f=a[0],c=a[1],p=0,u=1,g=f-l,h=c-s,m;if(m=t-l,g||!(0<m)){if(m/=g,0>g){if(m<p)return;m<u&&(u=m)}else if(0<g){if(m>u)return;m>p&&(p=m)}if(m=i-l,g||!(0>m)){if(m/=g,0>g){if(m>u)return;m>p&&(p=m)}else if(0<g){if(m<p)return;m<u&&(u=m)}if(m=n-s,h||!(0<m)){if(m/=h,0>h){if(m<p)return;m<u&&(u=m)}else if(0<h){if(m>u)return;m>p&&(p=m)}if(m=d-s,h||!(0>m)){if(m/=h,0>h){if(m>u)return;m>p&&(p=m)}else if(0<h){if(m<p)return;m<u&&(u=m)}return 0<p||1>u?(0<p&&(e[0]=[l+p*g,s+p*h]),1>u&&(e[1]=[l+u*g,s+u*h]),!0):!0}}}}}function Sg(e,t,n,a,i){var d=e[1];if(d)return!0;var r=e[0],o=e.left,l=e.right,s=o[0],f=o[1],c=l[0],p=l[1],u=(s+c)/2,g,h;if(p===f){if(u<t||u>=a)return;if(s>c){if(!r)r=[u,n];else if(r[1]>=i)return;d=[u,i]}else{if(!r)r=[u,i];else if(r[1]<n)return;d=[u,n]}}else if(g=(s-c)/(p-f),h=(f+p)/2-g*u,-1>g||1<g){if(s>c){if(!r)r=[(n-h)/g,n];else if(r[1]>=i)return;d=[(i-h)/g,i]}else{if(!r)r=[(i-h)/g,i];else if(r[1]<n)return;d=[(n-h)/g,n]}}else if(f<p){if(!r)r=[t,g*t+h];else if(r[0]>=a)return;d=[a,g*a+h]}else{if(!r)r=[a,g*a+h];else if(r[0]<t)return;d=[t,g*t+h]}return e[0]=r,e[1]=d,!0}function Eg(e,t,n,a){for(var d=hO.length,i;d--;)Sg(i=hO[d],e,t,n,a)&&wg(i,e,t,n,a)&&(Vx(i[0][0]-i[1][0])>sO||Vx(i[0][1]-i[1][1])>sO)||delete hO[d]}function Cg(e){return uO[e.index]={site:e,halfedges:[]}}function zg(e,t){var n=e.site,a=t.left,i=t.right;return(n===i&&(i=a,a=n),i)?jx(i[1]-a[1],i[0]-a[0]):(n===a?(a=t[1],i=t[0]):(a=t[0],i=t[1]),jx(a[0]-i[0],i[1]-a[1]))}function Tg(e,t){return t[+(t.left!==e.site)]}function Rg(e,t){return t[+(t.left===e.site)]}function Ag(){for(var e=0,t=uO.length,n,a,i,d;e<t;++e)if((n=uO[e])&&(d=(a=n.halfedges).length)){var r=Array(d),o=Array(d);for(i=0;i<d;++i)r[i]=i,o[i]=zg(n,hO[a[i]]);for(r.sort(function(e,t){return o[t]-o[e]}),i=0;i<d;++i)o[i]=a[r[i]];for(i=0;i<d;++i)a[i]=o[i]}}function Og(e,t,n,a){var i=uO.length,d=!0,r,o,l,s,f,c,p,u,g,h,m,y;for(r=0;r<i;++r)if(o=uO[r]){for(l=o.site,f=o.halfedges,s=f.length;s--;)hO[f[s]]||f.splice(s,1);for(s=0,c=f.length;s<c;)h=Rg(o,hO[f[s]]),m=h[0],y=h[1],p=Tg(o,hO[f[++s%c]]),u=p[0],g=p[1],(Vx(m-u)>sO||Vx(y-g)>sO)&&(f.splice(s,0,hO.push(vg(l,h,Vx(m-e)<sO&&a-y>sO?[e,Vx(u-e)<sO?g:a]:Vx(y-a)<sO&&n-m>sO?[Vx(g-a)<sO?u:n,a]:Vx(m-n)<sO&&y-t>sO?[n,Vx(u-n)<sO?g:t]:Vx(y-t)<sO&&m-e>sO?[Vx(g-t)<sO?u:e,t]:null))-1),++c);c&&(d=!1)}if(d){var b=Infinity,_,x,v;for(r=0,d=null;r<i;++r)(o=uO[r])&&(l=o.site,_=l[0]-e,x=l[1]-t,v=_*_+x*x,v<b&&(b=v,d=o));if(d){var k=[e,t],w=[e,a],S=[n,a],E=[n,t];d.halfedges.push(hO.push(vg(l=d.site,k,w))-1,hO.push(vg(l,w,S))-1,hO.push(vg(l,S,E))-1,hO.push(vg(l,E,k))-1)}}for(r=0;r<i;++r)(o=uO[r])&&(o.halfedges.length||delete uO[r])}function Pg(){mg(this),this.x=this.y=this.arc=this.site=this.cy=null}function Mg(e){var t=e.P,n=e.N;if(t&&n){var a=t.site,i=e.site,r=n.site;if(a!==r){var o=i[0],l=i[1],s=a[0]-o,f=a[1]-l,c=r[0]-o,p=r[1]-l,u=2*(s*p-f*c);if(!(u>=-fO)){var d=s*s+f*f,g=c*c+p*p,h=(p*d-f*g)/u,m=(s*g-c*d)/u,y=oO.pop()||new Pg;y.arc=e,y.site=i,y.x=h+o,y.y=(y.cy=m+l)+Hx(h*h+m*m),e.circle=y;for(var b=null,_=gO._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(_.L)_=_.L;else{b=_.P;break}}else if(_.R)_=_.R;else{b=_;break}gO.insert(b,y),b||(cO=y)}}}}function Dg(e){var t=e.circle;t&&(!t.P&&(cO=t.N),gO.remove(t),oO.push(t),mg(t),e.circle=null)}function Lg(){mg(this),this.edge=this.site=this.circle=null}function qg(e){var t=lO.pop()||new Lg;return t.site=e,t}function Ug(e){Dg(e),pO.remove(e),lO.push(e),mg(e)}function Fg(e){var t=e.circle,n=t.x,a=t.cy,i=[n,a],d=e.P,r=e.N,o=[e];Ug(e);for(var l=d;l.circle&&Vx(n-l.circle.x)<sO&&Vx(a-l.circle.cy)<sO;)d=l.P,o.unshift(l),Ug(l),l=d;o.unshift(l),Dg(l);for(var s=r;s.circle&&Vx(n-s.circle.x)<sO&&Vx(a-s.circle.cy)<sO;)r=s.N,o.push(s),Ug(s),s=r;o.push(s),Dg(s);var f=o.length,c;for(c=1;c<f;++c)s=o[c],l=o[c-1],kg(s.edge,l.site,s.site,i);l=o[0],s=o[f-1],s.edge=xg(l.site,s.site,null,i),Mg(l),Mg(s)}function jg(e){for(var t=e[0],n=e[1],a=pO._,i,r,o,l;a;)if(o=$g(a,n)-t,o>sO)a=a.L;else if(l=t-Ng(a,n),l>sO){if(!a.R){i=a;break}a=a.R}else{o>-sO?(i=a.P,r=a):l>-sO?(i=a,r=a.N):i=r=a;break}Cg(e);var s=qg(e);if(pO.insert(i,s),i||r){if(i===r)return Dg(i),r=qg(i.site),pO.insert(s,r),s.edge=r.edge=xg(i.site,s.site),Mg(i),void Mg(r);if(!r)return void(s.edge=xg(i.site,s.site));Dg(i),Dg(r);var f=i.site,c=f[0],p=f[1],u=e[0]-c,g=e[1]-p,h=r.site,m=h[0]-c,y=h[1]-p,b=2*(u*y-g*m),d=u*u+g*g,_=m*m+y*y,x=[(y*d-g*_)/b+c,(u*_-m*d)/b+p];kg(r.edge,f,h,x),s.edge=xg(f,e,null,x),r.edge=xg(e,h,null,x),Mg(i),Mg(r)}}function $g(e,t){var n=e.site,a=n[0],i=n[1],d=i-t;if(!d)return a;var r=e.P;if(!r)return-Infinity;n=r.site;var o=n[0],l=n[1],s=l-t;if(!s)return o;var f=o-a,c=1/d-1/s,p=f/s;return c?(-p+Hx(p*p-2*c*(f*f/(-2*s)-l+s/2+i-d/2)))/c+a:(a+o)/2}function Ng(e,t){var n=e.N;if(n)return $g(n,t);var a=e.site;return a[1]===t?a[0]:Infinity}function Ig(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function Bg(e,t){return t[1]-e[1]||t[0]-e[0]}function Yg(e,t){var n=e.sort(Bg).pop(),a,i,d;for(hO=[],uO=Array(e.length),pO=new hg,gO=new hg;;)if(d=cO,n&&(!d||n[1]<d.y||n[1]===d.y&&n[0]<d.x))(n[0]!==a||n[1]!==i)&&(jg(n),a=n[0],i=n[1]),n=e.pop();else if(d)Fg(d.arc);else break;if(Ag(),t){var r=+t[0][0],o=+t[0][1],l=+t[1][0],s=+t[1][1];Eg(r,o,l,s),Og(r,o,l,s)}this.edges=hO,this.cells=uO,pO=gO=hO=uO=null}function Gg(){function e(e){return new Yg(e.map(function(a,d){var i=[ev(t(a,d,e)/sO)*sO,ev(n(a,d,e)/sO)*sO];return i.index=d,i.data=a,i}),a)}var t=ug,n=gg,a=null;return e.polygons=function(t){return e(t).polygons()},e.links=function(t){return e(t).links()},e.triangles=function(t){return e(t).triangles()},e.x=function(n){return arguments.length?(t='function'===typeof n?n:pg(+n),e):t},e.y=function(t){return arguments.length?(n='function'===typeof t?t:pg(+t),e):n},e.extent=function(t){return arguments.length?(a=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],e):a&&[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},e.size=function(t){return arguments.length?(a=null==t?null:[[0,0],[+t[0],+t[1]]],e):a&&[a[1][0]-a[0][0],a[1][1]-a[0][1]]},e}function Wg(e){jd.call(this,null,e)}function Hg(){function e(e){e.width=e.height=1;var t=Hx(e.getContext('2d').getImageData(0,0,1,1).data.length>>2);e.width=(_O<<5)/t,e.height=cw/t;var n=e.getContext('2d');return n.fillStyle=n.strokeStyle='red',n.textAlign='center',{context:n,ratio:t}}function t(e,d,r){for(var l=d.x,f=d.y,c=Hx(a[0]*a[0]+a[1]*a[1]),p=n(a),s=.5>o()?1:-1,u=-s,t,g,m;(t=p(u+=s))&&(g=~~t[0],m=~~t[1],!(Zx(Vx(g),Vx(m))>=c));)if(d.x=l+g,d.y=f+m,!(0>d.x+d.x0||0>d.y+d.y0||d.x+d.x1>a[0]||d.y+d.y1>a[1])&&(!r||!Vg(d,e,a[0]))&&(!r||Zg(d,r))){for(var y=d.sprite,b=d.width>>5,_=a[0]>>5,v=d.x-(b<<4),k=127&v,w=d.y1-d.y0,h=(d.y+d.y0)*_+(v>>5),x=0,S;x<w;x++){S=0;for(var E=0;E<=b;E++)e[h+E]|=S<<32-k|(E<b?(S=y[x*b+E])>>>k:0);h+=_}return d.sprite=null,!0}return!1}var a=[256,256],n=Kg,r=[],o=Math.random,i={},l,s,f,c,p,u,g;return i.layout=function(){for(var h=e(eh()),m=Qg((a[0]>>5)*a[1]),y=null,b=r.length,n=-1,i=[],_=r.map(function(e){return{text:l(e),font:s(e),style:c(e),weight:p(e),rotate:u(e),size:~~f(e),padding:g(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:e}}).sort(function(e,t){return t.size-e.size}),x;++n<b;)x=_[n],x.x=a[0]*(o()+.5)>>1,x.y=a[1]*(o()+.5)>>1,Xg(h,x,_,n),x.hasText&&t(m,x,y)&&(i.push(x),y?Jg(y,x):y=[{x:x.x+x.x0,y:x.y+x.y0},{x:x.x+x.x1,y:x.y+x.y1}],x.x-=a[0]>>1,x.y-=a[1]>>1);return i},i.words=function(e){return arguments.length?(r=e,i):r},i.size=function(e){return arguments.length?(a=[+e[0],+e[1]],i):a},i.font=function(e){return arguments.length?(s=th(e),i):s},i.fontStyle=function(e){return arguments.length?(c=th(e),i):c},i.fontWeight=function(e){return arguments.length?(p=th(e),i):p},i.rotate=function(e){return arguments.length?(u=th(e),i):u},i.text=function(e){return arguments.length?(l=th(e),i):l},i.spiral=function(e){return arguments.length?(n=ch[e]||e,i):n},i.fontSize=function(e){return arguments.length?(f=th(e),i):f},i.padding=function(e){return arguments.length?(g=th(e),i):g},i.random=function(e){return arguments.length?(o=e,i):o},i}function Xg(e,t,a,d){if(!t.sprite){var r=e.context,o=e.ratio;r.clearRect(0,0,(_O<<5)/o,cw/o);var l=0,s=0,f=0,c=a.length,n,p,u,g,i;for(--d;++d<c;){if(t=a[d],r.save(),r.font=t.style+' '+t.weight+' '+~~((t.size+1)/o)+'px '+t.font,n=r.measureText(t.text+'m').width*o,u=t.size<<1,t.rotate){var h=Ix(t.rotate*bO),y=Bx(t.rotate*bO),b=n*y,_=n*h,x=u*y,v=u*h;n=nv(Vx(b+v),Vx(b-v))+31>>5<<5,u=~~nv(Vx(_+x),Vx(_-x))}else n=n+31>>5<<5;if(u>f&&(f=u),l+n>=_O<<5&&(l=0,s+=f,f=0),s+u>=cw)break;r.translate((l+(n>>1))/o,(s+(u>>1))/o),t.rotate&&r.rotate(t.rotate*bO),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=n,t.height=u,t.xoff=l,t.yoff=s,t.x1=n>>1,t.y1=u>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,l+=n}for(var w=r.getImageData(0,0,(_O<<5)/o,cw/o).data,S=[];0<=--d;)if(t=a[d],t.hasText){for(n=t.width,p=n>>5,u=t.y1-t.y0,g=0;g<u*p;g++)S[g]=0;if(l=t.xoff,null==l)return;s=t.yoff;var E=0,C=-1;for(i=0;i<u;i++){for(g=0;g<n;g++){var z=p*i+(g>>5),k=w[(s+i)*(_O<<5)+(l+g)<<2]?1<<31-g%32:0;S[z]|=k,E|=k}E?C=i:(t.y0++,u--,i--,s++)}t.y1=t.y0+C,t.sprite=S.slice(0,(t.y1-t.y0)*p)}}}function Vg(e,t,n){n>>=5;for(var a=e.sprite,d=e.width>>5,r=e.x-(d<<4),o=127&r,l=e.y1-e.y0,s=(e.y+e.y0)*n+(r>>5),f=0,c;f<l;f++){c=0;for(var p=0;p<=d;p++)if((c<<32-o|(p<d?(c=a[f*d+p])>>>o:0))&t[s+p])return!0;s+=n}return!1}function Jg(e,t){var n=e[0],a=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>a.x&&(a.x=t.x+t.x1),t.y+t.y1>a.y&&(a.y=t.y+t.y1)}function Zg(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Kg(t){var n=t[0]/t[1];return function(e){return[n*(e*=.1)*Bx(e),e*Ix(e)]}}function Qg(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function eh(){try{return'undefined'!==typeof document&&document.createElement?document.createElement('canvas'):new(require('canvas'))}catch(t){F('Canvas unavailable. Run in browser or install node-canvas.')}}function th(e){return'function'===typeof e?e:function(){return e}}function nh(e){jd.call(this,Hg(),e)}function ah(t,n){var a=new TS.Extent;return a.transform({field:t,modified:hv},n),a.value}function ih(e){return new Uint8Array(e)}function dh(e){return new Uint16Array(e)}function rh(e){return new Uint32Array(e)}function oh(){var e=8,a=[],t=rh(0),d=sh(0,e),r=sh(0,e);return{data:function(){return a},seen:function(){return t=lh(t,a.length)},add:function(e){for(var d=0,i=a.length,r=e.length,n;d<r;++d)n=e[d],n._index=i++,a.push(n)},remove:function(e,o){var l=a.length,n=Array(l-e),s=a,f,t,i;for(t=0;!o[t]&&t<l;++t)n[t]=a[t],s[t]=t;for(i=t;t<l;++t)f=a[t],o[t]?s[t]=-1:(s[t]=i,d[i]=d[t],r[i]=r[t],n[i]=f,f._index=i++),d[t]=0;return a=n,s},size:function(){return a.length},curr:function(){return d},prev:function(){return r},reset:function(e){r[e]=d[e]},all:function(){return 257>e?255:65537>e?65535:4294967295},set:function(e,t){d[e]|=t},clear:function(e,t){d[e]&=~t},resize:function(t,n){var a=d.length;(t>a||n>e)&&(e=nv(n,e),d=sh(t,e,d),r=sh(t,e))}}}function lh(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function sh(e,t,n){var a=(257>t?ih:65537>t?dh:rh)(e);return n&&a.set(n),a}function fh(e,t,n){var a=1<<t;return{one:a,zero:~a,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n=this,d=n.bisect(n.range,e.value),r=e.index,o=d[0],l=d[1],s=r.length,f;for(f=0;f<o;++f)t[r[f]]|=a;for(f=l;f<s;++f)t[r[f]]|=a;return n}}}function ph(){var e=rh(0),t=[],a=0;return{insert:function(n,d,r){if(!d.length)return[];var o=a,l=d.length,s=Array(l),f=rh(l),c,p,u;for(u=0;u<l;++u)s[u]=n(d[u]),f[u]=u;if(s=uh(s,f),o)c=t,p=e,t=Array(o+l),e=rh(o+l),gh(r,c,p,o,s,f,l,t,e);else{if(0<r)for(u=0;u<l;++u)f[u]+=r;t=s,e=f}return a=o+l,{index:f,value:s}},remove:function(d,r){var o=a,n,l,i;for(l=0;!r[e[l]]&&l<o;++l);for(i=l;l<o;++l)r[n=e[l]]||(e[i]=n,t[i]=t[l],++i);a=o-d},bisect:function(e,i){var d=i?i.length:(i=t,a);return[rv(i,e[0],0,d),dv(i,e[1],0,d)]},reindex:function(t){for(var d=0,i=a;d<i;++d)e[d]=t[e[d]]},index:function(){return e},size:function(){return a}}}function uh(e,t){return e.sort.call(t,function(t,n){var a=e[t],i=e[n];return a<i?-1:a>i?1:0}),k(e,t)}function gh(e,t,n,a,d,r,o,l,s){var f=0,c=0,p;for(p=0;f<a&&c<o;++p)t[f]<d[c]?(l[p]=t[f],s[p]=n[f++]):(l[p]=d[c],s[p]=r[c++]+e);for(;f<a;++f,++p)l[p]=t[f],s[p]=n[f];for(;c<o;++c,++p)l[p]=d[c],s[p]=r[c]+e}function hh(e){jd.call(this,oh(),e),this._indices=null,this._dims=null}function mh(e){jd.call(this,null,e)}function yh(e){jd.call(this,null,e)}function bh(e,t,n){return e.bounds_prev.clear().union(e.bounds),t(e.bounds.clear(),e,n)}function _h(e){jd.call(this,null,e)}function xh(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function vh(e){jd.call(this,null,e)}function kh(e){for(var t=e.items,a=t.length,n=0,i={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null},d,r;n<a;++n)if(d=t[n],r=d.items,'group'===d.marktype)switch(d.role){case RO:case AO:break;case OO:wh(r,i.rowheaders);break;case PO:wh(r,i.rowfooters);break;case DO:wh(r,i.colheaders);break;case LO:wh(r,i.colfooters);break;case MO:i.rowtitle=r[0];break;case qO:i.coltitle=r[0];break;default:wh(r,i.marks);}return i}function wh(e,t){for(var a=0,i=e.length;a<i;++a)t.push(e[a])}function Sh(e){return{x1:0,y1:0,x2:e.width||0,y2:e.height||0}}function Eh(e){return e.bounds.clone().translate(-(e.x||0),-(e.y||0))}function Ch(e,t){var n={x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y+e.height};return n[t]}function zh(e,t){return e.bounds[t]}function Th(e,t,n){return(N(e)?e[t]:e)||n||0}function Rh(e,t,a){function d(e,t){return Kx(Zx(e,t))}function r(e,t){return tv(nv(e,t))}var o=kh(t,a),l=o.marks,s='flush'===a.bounds,f=s?Sh:Eh,c=new gn(0,0,0,0),p=Th(a.align,'column'),u=Th(a.align,'row'),h=Th(a.padding,'column'),_=Th(a.padding,'row'),v=a.offset,k=a.columns||l.length,w=0>k?1:tv(l.length/k),S=[],E=[],C=l.length,n,m,i,z,b,g,T,R,x,y,A;for(m=0;m<C;++m)z=f(l[m]),g=0===m%k?0:tv(f(l[m-1]).x2),T=m<k?0:tv(f(l[m-k]).y2),R=(0>z.x1?tv(-z.x1):0)+g,x=(0>z.y1?tv(-z.y1):0)+T,S.push(R+h),E.push(x+_);for(m=0;m<C;++m)0===m%k&&(S[m]=0),m<k&&(E[m]=0);if('each'===p)for(i=1;i<k;++i){for(A=0,m=i;m<C;m+=k)A<S[m]&&(A=S[m]);for(m=i;m<C;m+=k)S[m]=A}else if('all'===p){for(A=0,m=0;m<C;++m)m%k&&A<S[m]&&(A=S[m]);for(m=0;m<C;++m)m%k&&(S[m]=A)}if('each'===u)for(i=1;i<w;++i){for(A=0,m=i*k,n=m+k;m<n;++m)A<E[m]&&(A=E[m]);for(m=i*k;m<n;++m)E[m]=A}else if('all'===u){for(A=0,m=k;m<C;++m)A<E[m]&&(A=E[m]);for(m=k;m<C;++m)E[m]=A}for(R=0,m=0;m<C;++m)b=l[m],g=b.x||0,b.x=R=S[m]+(m%k?R:0),b.bounds.translate(R-g,0);for(i=0;i<k;++i)for(x=0,m=i;m<C;m+=k)b=l[m],T=b.y||0,b.y=x+=E[m],b.bounds.translate(0,x-T);for(e.enqueue(l),m=0;m<C;++m)l[m].mark.bounds.clear();for(m=0;m<C;++m)b=l[m],c.union(b.mark.bounds.union(b.bounds));f=s?Ch:zh,R=Ah(e,o.rowheaders,l,k,w,-Th(v,'rowHeader'),d,0,f,'x1',0,k,1),x=Ah(e,o.colheaders,l,k,k,-Th(v,'columnHeader'),d,1,f,'y1',0,1,k),Ah(e,o.rowfooters,l,k,w,Th(v,'rowFooter'),r,0,f,'x2',k-1,k,1),Ah(e,o.colfooters,l,k,k,Th(v,'columnFooter'),r,1,f,'y2',w*k-k,1,k),o.rowtitle&&(A=R-Th(v,'rowTitle'),y=Th(a.titleBand,'row',0.5),Oh(e,o.rowtitle,A,0,c,y)),o.coltitle&&(A=x-Th(v,'columnTitle'),y=Th(a.titleBand,'column',0.5),Oh(e,o.coltitle,A,1,c,y))}function Ah(e,t,a,d,r,o,l,s,f,c,p,u,_){var v=a.length,n=0,w=0,S,i,E,k,m,b,h,g,x;for(S=p;S<v;S+=u)a[S]&&(n=l(n,f(a[S],c)));if(!t.length)return n;for(t.length>r&&(e.warn('Grid headers exceed limit: '+r),t=t.slice(0,r)),n+=o,(i=0,k=t.length);i<k;++i)t[i].mark.bounds.clear();for(S=p,i=0,k=t.length;i<k;++i,S+=u){for(b=t[i],m=b.mark.bounds,E=S;null==(h=a[E]);E-=_);s?(g=h.x,x=n):(g=n,x=h.y),m.union(b.bounds.translate(g-(b.x||0),x-(b.y||0))),b.x=g,b.y=x,w=l(w,m[c])}return e.enqueue(t),w}function Oh(e,t,n,a,i,d){if(t){var r=n,o=n;a?r=ev(i.x1+d*i.width()):o=ev(i.y1+d*i.height()),t.bounds.translate(r-(t.x||0),o-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=r,t.y=o,e.enqueue(t.mark.items)}}function Ph(e){jd.call(this,null,e)}function Mh(e,t,a){var d=t.items,r=nv(0,t.width||0),o=nv(0,t.height||0),l=new gn().set(0,0,r,o),s=l.clone(),f=l.clone(),c=[],p,u,g,h,m,i;for(m=0,i=d.length;m<i;++m)switch(u=d[m],u.role){case $O:s.union(h=Uh(e,u,r,o)),Lh(u)&&f.union(h);break;case NO:p=u;break;case BO:c.push(u);break;case IO:case YO:case GO:case WO:case HO:case XO:f.union(u.bounds);break;default:l.union(u.bounds);}if(p&&(s.union(h=Fh(e,p,s)),Lh(p)&&f.union(h)),c.length)for(g={left:0,right:0,margin:a.legendMargin||8},m=0,i=c.length;m<i;++m)h=jh(e,c[m],g,f,r,o),a.autosize&&a.autosize.type===UO?l.add(h.x1,0).add(h.x2,0):l.union(h);$h(e,t,l.union(f).union(s),a)}function Dh(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Lh(e){var t=e.items[0].datum.orient;return'left'===t||'right'===t}function qh(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Uh(e,t,n,a){var d=t.items[0],r=d.datum,o=r.orient,l=qh(r),f=d.range,c=d.offset,p=d.position,u=d.minExtent,g=d.maxExtent,h=r.title&&d.items[l[2]].items[0],m=d.titlePadding,b=h?h.fontSize+m:0,_=d.bounds,v=0,x=0,y,i;return _.clear(),-1<(y=l[0])&&_.union(d.items[y].bounds),-1<(y=l[1])&&_.union(d.items[y].bounds),'top'===o?(v=p||0,x=-c,i=nv(u,Zx(g,-_.y1)),h&&(h.auto?(h.y=-(m+i),i+=b):_.union(h.bounds)),_.add(0,-i).add(f,0)):'left'===o?(v=-c,x=p||0,i=nv(u,Zx(g,-_.x1)),h&&(h.auto?(h.x=-(m+i),i+=b):_.union(h.bounds)),_.add(-i,0).add(0,f)):'right'===o?(v=n+c,x=p||0,i=nv(u,Zx(g,_.x2)),h&&(h.auto?(h.x=m+i,i+=b):_.union(h.bounds)),_.add(0,0).add(i,f)):'bottom'===o?(v=p||0,x=a+c,i=nv(u,Zx(g,_.y2)),h&&(h.auto?(h.y=m+i,i+=b):_.union(h.bounds)),_.add(0,0).add(f,i)):(v=d.x,x=d.y),(Dh(d,'x',v+0.5)|Dh(d,'y',x+0.5)&&e.enqueue([d]),$a(_.translate(v,x),d),d.mark.bounds.clear().union(_))}function Fh(e,t,n){var a=t.items[0],i=a.datum,d=i.orient,r=a.offset,o=a.bounds,l=0,s=0;return'top'===d?(l=a.x,s=n.y1-r):'left'===d?(l=n.x1-r,s=a.y):'right'===d?(l=n.x2+r,s=a.y):'bottom'===d?(l=a.x,s=n.y2+r):(l=a.x,s=a.y),o.translate(l-a.x,s-a.y),Dh(a,'x',l)|Dh(a,'y',s)&&e.enqueue([a]),t.bounds.clear().union(o)}function jh(e,t,n,a,i,d){var r=t.items[0],o=r.datum,l=o.orient,s=r.offset,f=r.bounds.clear(),c=0,p=n[l]||0,u,g;return r.items.forEach(function(e){f.union(e.bounds)}),u=ev(f.width())+2*r.padding-1,g=ev(f.height())+2*r.padding-1,'left'===l?(c-=u+s-Kx(a.x1),n.left+=g+n.margin):'right'===l?(c+=s+tv(a.x2),n.right+=g+n.margin):'top-left'===l?(c+=s,p+=s):'top-right'===l?(c+=i-u-s,p+=s):'bottom-left'===l?(c+=s,p+=d-g-s):'bottom-right'===l?(c+=i-u-s,p+=d-g-s):(c=r.x,p=r.y),(Dh(r,'x',c)|Dh(r,'width',u)|Dh(r,'y',p)|Dh(r,'height',g)&&e.enqueue([r]),$a(f.set(c,p,c+u,p+g),r),r.mark.bounds.clear().union(f))}function $h(e,t,n,a){var i=a.autosize&&a.autosize.type,d=a.autosize&&a.autosize.resize,r=e._width,o=e._height;if(!(1>e._autosize)&&i){var l=nv(0,t.width||0),s=nv(0,tv(-n.x1)),f=nv(0,tv(n.x2-l)),c=nv(0,t.height||0),p=nv(0,tv(-n.y1)),u=nv(0,tv(n.y2-c));i===jO?(r=l,o=c,s=0,p=0):i===UO?(l=nv(0,r-s-f),c=nv(0,o-p-u)):i===FO&&(r=l+s+f,o=c+p+u),e.autosize(r,o,l,c,[s,p],d)}}function Nh(e){var t=e._signals.cursor;t||(e._signals.cursor=t=e.add({user:JO,item:null})),e.on(e.events('view','mousemove'),t,function(e,n){var a=t.value,i=a?I(a)?a:a.user:JO,d=n.item&&n.item.cursor||null;return a&&i===a.user&&d==a.item?a:{user:i,item:d}}),e.add(null,function(e){var t=e.cursor,n=this.value;return I(t)||(n=t.item,t=t.user),Ih(t&&t!==JO?t:n||t),n},{cursor:t})}function Ih(e){'undefined'!==typeof document&&document.body&&(document.body.style.cursor=e)}function Bh(e,t){var n=e._runtime.data;return n.hasOwnProperty(t)||e.error('Unrecognized data set: '+t),n[t]}function Yh(e,t){xd(t)||this.error('Second argument to changes must be a changeset.');var n=Bh(this,e);return n.modified=!0,this.pulse(n.input,t)}function Gh(e){var t=e.padding();return nv(0,e._width+t.left+t.right)}function Wh(e){var t=e.padding();return nv(0,e._height+t.top+t.bottom)}function Hh(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Xh(e){var t=Hh(e);e._renderer.background(e._background),e._renderer.resize(Gh(e),Wh(e),t),e._handler.origin(t)}function Vh(t,n,a){var i=t._renderer.element(),d,r,e;return i&&(e=Hh(t),r=n.changedTouches?n.changedTouches[0]:n,d=Ui(r,i),d[0]-=e[0],d[1]-=e[1]),n.vega=Jh(t,a,d),n.item=a,n}function Jh(e,t,n){function a(e){var n=d,a;if(e)for(a=t;a;a=a.mark.group)if(a.mark.name===e){n=a;break}return n&&n.mark&&n.mark.interactive?n:{}}function i(e){if(!e)return n;I(e)&&(e=a(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}var d=t?'group'===t.mark.marktype?t:t.mark.group:null;return{view:J(e),item:J(t||{}),group:a,xy:i,x:function(e){return i(e)[0]},y:function(e){return i(e)[1]}}}function Zh(e){return e.item}function Kh(e){var t=e.item.mark.source;return t.source||t}function Qh(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function em(e,t,n){var a=document.createElement(e);for(var i in t)a.setAttribute(i,t[i]);return null!=n&&(a.textContent=n),a}function tm(e,t,n){var a=n.param,i=n.state||(n.state={elements:null,set:null,update:function(t){i.source=!0,e.signal(a.signal,t).run()},active:!1});return I(t)&&(t=document.querySelector(t)),nm(i,t,a,e.signal(a.signal)),i.active||(e.on(e._signals[a.signal],null,function(){i.source?i.source=!1:i.set(e.signal(a.signal))}),i.active=!0),i}function nm(e,t,n,a){var i=em('div',{class:KO});i.appendChild(em('span',{class:QO},n.name||n.signal)),t.appendChild(i);var d=am;switch(n.input){case'checkbox':d=im;break;case'select':d=dm;break;case'radio':d=rm;break;case'range':d=om;}d(e,i,n,a)}function am(e,t,n,a){var i=em('input');for(var d in n)'signal'!==d&&'element'!==d&&i.setAttribute('input'===d?'type':d,n[d]);i.setAttribute('name',n.signal),i.value=a,t.appendChild(i),i.addEventListener('input',function(){e.update(i.value)}),e.elements=[i],e.set=function(e){i.value=e}}function im(e,t,n,a){var i={type:'checkbox',name:n.signal};a&&(i.checked=!0);var d=em('input',i);t.appendChild(d),d.addEventListener('change',function(){e.update(d.checked)}),e.elements=[d],e.set=function(e){d.checked=!!e||null}}function dm(e,t,a,n){var d=em('select',{name:a.signal});a.options.forEach(function(e){var t={value:e};lm(e,n)&&(t.selected=!0),d.appendChild(em('option',t,e+''))}),t.appendChild(d),d.addEventListener('change',function(){e.update(a.options[d.selectedIndex])}),e.elements=[d],e.set=function(e){for(var t=0,i=a.options.length;t<i;++t)if(lm(a.options[t],e))return void(d.selectedIndex=t)}}function rm(e,t,n,a){var i=em('span',{class:eP});t.appendChild(i),e.elements=n.options.map(function(t){var d=tP+n.signal+'-'+t,r={id:d,type:'radio',name:n.signal,value:t};lm(t,a)&&(r.checked=!0);var o=em('input',r);return o.addEventListener('change',function(){e.update(t)}),i.appendChild(o),i.appendChild(em('label',{for:d},t+'')),o}),e.set=function(t){for(var a=e.elements,d=0,i=a.length;d<i;++d)lm(a[d].value,t)&&(a[d].checked=!0)}}function om(e,t,n,a){function i(){s.textContent=l.value,e.update(+l.value)}a=a===void 0?(+n.max+ +n.min)/2:a;var d=n.min||Zx(0,+a)||0,r=n.max||nv(100,+a)||100,o=n.step||u(d,r,100),l=em('input',{type:'range',name:n.signal,min:d,max:r,step:o});l.value=a;var s=em('label',{},+a);t.appendChild(l),t.appendChild(s),l.addEventListener('input',i),l.addEventListener('change',i),e.elements=[l],e.set=function(e){l.value=e,s.textContent=e}}function lm(e,t){return e===t||e+''===t+''}function sm(e,t,n,a){return t=t||new a(e.loader()),t.initialize(n,Gh(e),Wh(e),Hh(e)).background(e._background)}function fm(e,t,n,a){var i=new a().scene(e.scenegraph().root).initialize(n,Hh(e),e);return t&&(i.handleTooltip=t.handleTooltip,t.handlers().forEach(function(e){i.on(e.type,e.handler)})),i}function cm(e,t){return'string'===typeof t&&(t='undefined'===typeof document?e.error('DOM document instance not found.'):document.querySelector(t)),t.innerHTML='',t}function pm(e,t){var n=sd(t);return n&&n.headless?e.runAsync().then(function(){return sm(e,null,null,n.headless).renderAsync(e._scenegraph.root)}):Promise.reject('Unrecognized renderer type: '+t)}function um(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function gm(e,t){return e=e||t.autosize,N(e)?e:(e=e||'pad',{type:e})}function hm(e,t){return e=e||t.padding,N(e)?e:(e=+e||0,{top:e,bottom:e,left:e,right:e})}function mm(e,t){F(e+' for "outer" push: '+Y(t))}function ym(e,t){var n=e.name;if(e.push===nP)t.signals[n]||mm('No prior signal definition',n),aP.forEach(function(t){void 0!==e[t]&&mm('Invalid property ',t)});else{var a=t.addSignal(n,e.value);!1===e.react&&(a.react=!1),e.bind&&t.addBinding(n,e.bind)}}function bm(e){this.type=e}function _m(e){switch(e.type){case'ArrayExpression':return e.elements;case'BinaryExpression':case'LogicalExpression':return[e.left,e.right];case'CallExpression':var t=e.arguments.slice();return t.unshift(e.callee),t;case'ConditionalExpression':return[e.test,e.consequent,e.alternate];case'MemberExpression':return[e.object,e.property];case'ObjectExpression':return e.properties;case'Property':return[e.key,e.value];case'UnaryExpression':return[e.argument];case'Identifier':case'Literal':case'RawCode':default:return[];}}function xm(e,t){if(!e)throw new Error('ASSERT: '+t)}function vm(e){return 48<=e&&57>=e}function km(e){return 0<='0123456789abcdefABCDEF'.indexOf(e)}function wm(e){return 0<='01234567'.indexOf(e)}function Sm(e){return 32===e||9===e||11===e||12===e||160===e||5760<=e&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)}function Em(e){return 10===e||13===e||8232===e||8233===e}function Cm(e){return 36===e||95===e||65<=e&&90>=e||97<=e&&122>=e||92===e||128<=e&&LP.test(Lx(e))}function zm(e){return 36===e||95===e||65<=e&&90>=e||97<=e&&122>=e||48<=e&&57>=e||92===e||128<=e&&qP.test(Lx(e))}function Tm(){for(var e;sM<fM&&(e=lM.charCodeAt(sM),Sm(e)||Em(e));)++sM}function Rm(e){var t=0,n,a,i;for(a='u'===e?4:2,n=0;n<a;++n)sM<fM&&km(lM[sM])?(i=lM[sM++],t=16*t+'0123456789abcdef'.indexOf(i.toLowerCase())):ay({},wP,MP);return Lx(t)}function Am(){var e,t,n,a;for(e=lM[sM],t=0,'}'===e&&ay({},wP,MP);sM<fM&&(e=lM[sM++],!!km(e));)t=16*t+'0123456789abcdef'.indexOf(e.toLowerCase());return((1114111<t||'}'!==e)&&ay({},wP,MP),65535>=t)?Lx(t):(n=(t-65536>>10)+55296,a=(1023&t-65536)+56320,Lx(n,a))}function Om(){var e,t;for(e=lM.charCodeAt(sM++),t=Lx(e),92===e&&(117!==lM.charCodeAt(sM)&&ay({},wP,MP),++sM,e=Rm('u'),(!e||'\\'===e||!Cm(e.charCodeAt(0)))&&ay({},wP,MP),t=e);sM<fM&&(e=lM.charCodeAt(sM),!!zm(e));)++sM,t+=Lx(e),92===e&&(t=t.substr(0,t.length-1),117!==lM.charCodeAt(sM)&&ay({},wP,MP),++sM,e=Rm('u'),(!e||'\\'===e||!zm(e.charCodeAt(0)))&&ay({},wP,MP),t+=e);return t}function Pm(){var e,t;for(e=sM++;sM<fM;){if(t=lM.charCodeAt(sM),92===t)return sM=e,Om();if(zm(t))++sM;else break}return lM.slice(e,sM)}function Mm(){var e,t,n;return e=sM,t=92===lM.charCodeAt(sM)?Om():Pm(),n=1===t.length?rP:UP.hasOwnProperty(t)?oP:'null'===t?lP:'true'===t||'false'===t?iP:rP,{type:n,value:t,start:e,end:sM}}function Dm(){var e=sM,t=lM.charCodeAt(sM),n=lM[sM],a,i,d,r;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++sM,{type:fP,value:Lx(t),start:e,end:sM};default:if(a=lM.charCodeAt(sM+1),61===a)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return sM+=2,{type:fP,value:Lx(t)+Lx(a),start:e,end:sM};case 33:case 61:return sM+=2,61===lM.charCodeAt(sM)&&++sM,{type:fP,value:lM.slice(e,sM),start:e,end:sM};}}return(r=lM.substr(sM,4),'>>>='===r)?(sM+=4,{type:fP,value:r,start:e,end:sM}):(d=r.substr(0,3),'>>>'===d||'<<='===d||'>>='===d)?(sM+=3,{type:fP,value:d,start:e,end:sM}):(i=d.substr(0,2),n===i[1]&&0<='+-<>&|'.indexOf(n)||'=>'===i?(sM+=2,{type:fP,value:i,start:e,end:sM}):0<='<>=!+-*%&|^/'.indexOf(n)?(++sM,{type:fP,value:n,start:e,end:sM}):void ay({},wP,MP))}function Lm(e){for(var t='';sM<fM&&!!km(lM[sM]);)t+=lM[sM++];return 0===t.length&&ay({},wP,MP),Cm(lM.charCodeAt(sM))&&ay({},wP,MP),{type:sP,value:parseInt('0x'+t,16),start:e,end:sM}}function qm(e){for(var t='0'+lM[sM++];sM<fM&&!!wm(lM[sM]);)t+=lM[sM++];return(Cm(lM.charCodeAt(sM))||vm(lM.charCodeAt(sM)))&&ay({},wP,MP),{type:sP,value:parseInt(t,8),octal:!0,start:e,end:sM}}function Um(){var e,t,n;if(n=lM[sM],xm(vm(n.charCodeAt(0))||'.'===n,'Numeric literal must start with a decimal digit or a decimal point'),t=sM,e='','.'!==n){if(e=lM[sM++],n=lM[sM],'0'===e){if('x'===n||'X'===n)return++sM,Lm(t);if(wm(n))return qm(t);n&&vm(n.charCodeAt(0))&&ay({},wP,MP)}for(;vm(lM.charCodeAt(sM));)e+=lM[sM++];n=lM[sM]}if('.'===n){for(e+=lM[sM++];vm(lM.charCodeAt(sM));)e+=lM[sM++];n=lM[sM]}if('e'===n||'E'===n)if(e+=lM[sM++],n=lM[sM],('+'===n||'-'===n)&&(e+=lM[sM++]),vm(lM.charCodeAt(sM)))for(;vm(lM.charCodeAt(sM));)e+=lM[sM++];else ay({},wP,MP);return Cm(lM.charCodeAt(sM))&&ay({},wP,MP),{type:sP,value:parseFloat(e),start:t,end:sM}}function Fm(){var e='',t=!1,n,a,i,d;for(n=lM[sM],xm('\''===n||'"'===n,'String literal must starts with a quote'),a=sM,++sM;sM<fM;)if(i=lM[sM++],i===n){n='';break}else if('\\'===i)i=lM[sM++],i&&Em(i.charCodeAt(0))?'\r'===i&&'\n'===lM[sM]&&++sM:'u'===i||'x'===i?'{'===lM[sM]?(++sM,e+=Am()):e+=Rm(i):'n'===i?e+='\n':'r'===i?e+='\r':'t'===i?e+='\t':'b'===i?e+='\b':'f'===i?e+='\f':'v'===i?e+='\x0B':wm(i)?(d='01234567'.indexOf(i),0!==d&&(t=!0),sM<fM&&wm(lM[sM])&&(t=!0,d=8*d+'01234567'.indexOf(lM[sM++]),0<='0123'.indexOf(i)&&sM<fM&&wm(lM[sM])&&(d=8*d+'01234567'.indexOf(lM[sM++]))),e+=Lx(d)):e+=i;else if(Em(i.charCodeAt(0)))break;else e+=i;return''!==n&&ay({},wP,MP),{type:cP,value:e,octal:t,start:a,end:sM}}function jm(e,t){var n=e;0<=t.indexOf('u')&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){return 1114111>=parseInt(t,16)?'x':void ay({},RP)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,'x'));try{new RegExp(n)}catch(t){ay({},RP)}try{return new RegExp(e,t)}catch(e){return null}}function $m(){var e,t,n,a,i;for(e=lM[sM],xm('/'===e,'Regular expression literal must start with a slash'),t=lM[sM++],n=!1,a=!1;sM<fM;)if(e=lM[sM++],t+=e,'\\'===e)e=lM[sM++],Em(e.charCodeAt(0))&&ay({},AP),t+=e;else if(Em(e.charCodeAt(0)))ay({},AP);else if(n)']'===e&&(n=!1);else if('/'===e){a=!0;break}else'['===e&&(n=!0);return a||ay({},AP),i=t.substr(1,t.length-2),{value:i,literal:t}}function Nm(){var e,t,n;for(t='',n='';sM<fM&&(e=lM[sM],!!zm(e.charCodeAt(0)));)++sM,'\\'===e&&sM<fM?ay({},wP,MP):(n+=e,t+=e);return 0<=n.search(/[^gimuy]/g)&&ay({},RP,n),{value:n,literal:t}}function Im(){var e,t,n,a;return cM=null,Tm(),e=sM,t=$m(),n=Nm(),a=jm(t.value,n.value),{literal:t.literal+n.literal,value:a,regex:{pattern:t.value,flags:n.value},start:e,end:sM}}function Bm(e){return e.type===rP||e.type===oP||e.type===iP||e.type===lP}function Ym(){var e;return(Tm(),sM>=fM)?{type:dP,start:sM,end:sM}:(e=lM.charCodeAt(sM),Cm(e)?Mm():40===e||41===e||59===e?Dm():39===e||34===e?Fm():46===e?vm(lM.charCodeAt(sM+1))?Um():Dm():vm(e)?Um():Dm())}function Gm(){var e;return e=cM,sM=e.end,cM=Ym(),sM=e.end,e}function Wm(){var e;e=sM,cM=Ym(),sM=e}function Hm(e){var t=new bm(pP);return t.elements=e,t}function Xm(e,t,n){var a=new bm('||'===e||'&&'===e?bP:uP);return a.operator=e,a.left=t,a.right=n,a}function Vm(e,t){var n=new bm(gP);return n.callee=e,n.arguments=t,n}function Jm(e,t,n){var a=new bm(hP);return a.test=e,a.consequent=t,a.alternate=n,a}function Zm(e){var t=new bm(mP);return t.name=e,t}function Km(e){var t=new bm(yP);return t.value=e.value,t.raw=lM.slice(e.start,e.end),e.regex&&('//'===t.raw&&(t.raw='/(?:)/'),t.regex=e.regex),t}function Qm(e,t,n){var a=new bm(_P);return a.computed='['===e,a.object=t,a.property=n,a.computed||(n.member=!0),a}function ey(e){var t=new bm(xP);return t.properties=e,t}function ty(e,t,n){var a=new bm(vP);return a.key=t,a.value=n,a.kind=e,a}function ny(e,t){var n=new bm(kP);return n.operator=e,n.argument=t,n.prefix=!0,n}function ay(e,t){var n=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,function(e,t){return xm(t<n.length,'Message reference must be in range'),n[t]}),i;throw i=new Error(a),i.index=sM,i.description=a,i}function iy(e){e.type===dP&&ay(e,TP),e.type===sP&&ay(e,SP),e.type===cP&&ay(e,EP),e.type===rP&&ay(e,CP),e.type===oP&&ay(e,zP),ay(e,wP,e.value)}function dy(e){var t=Gm();(t.type!==fP||t.value!==e)&&iy(t)}function ry(e){return cM.type===fP&&cM.value===e}function oy(e){return cM.type===oP&&cM.value===e}function ly(){var e=[];for(sM=cM.start,dy('[');!ry(']');)ry(',')?(Gm(),e.push(null)):(e.push(Sy()),ry(']')||dy(','));return Gm(),Hm(e)}function sy(){var e;return sM=cM.start,e=Gm(),e.type===cP||e.type===sP?(e.octal&&ay(e,OP),Km(e)):Zm(e.value)}function fy(){var e,t,n,a;return sM=cM.start,e=cM,e.type===rP?(n=sy(),dy(':'),a=Sy(),ty('init',n,a)):e.type===dP||e.type===fP?void iy(e):(t=sy(),dy(':'),a=Sy(),ty('init',t,a))}function cy(){var e=[],t={},n=String,a,i,d;for(sM=cM.start,dy('{');!ry('}');)a=fy(),i=a.key.type===mP?a.key.name:n(a.key.value),d='$'+i,Object.prototype.hasOwnProperty.call(t,d)?ay({},PP):t[d]=!0,e.push(a),ry('}')||dy(',');return dy('}'),ey(e)}function py(){var e;return dy('('),e=Ey(),dy(')'),e}function uy(){var e,t,n;if(ry('('))return py();if(ry('['))return ly();if(ry('{'))return cy();if(e=cM.type,sM=cM.start,e===rP||FP[cM.value])n=Zm(Gm().value);else if(e===cP||e===sP)cM.octal&&ay(cM,OP),n=Km(Gm());else if(e===oP)throw new Error(DP);else e===iP?(t=Gm(),t.value='true'===t.value,n=Km(t)):e===lP?(t=Gm(),t.value=null,n=Km(t)):ry('/')||ry('/=')?(n=Km(Im()),Wm()):iy(Gm());return n}function gy(){var e=[];if(dy('('),!ry(')'))for(;sM<fM&&(e.push(Sy()),!ry(')'));)dy(',');return dy(')'),e}function hy(){var e;return sM=cM.start,e=Gm(),Bm(e)||iy(e),Zm(e.value)}function my(){return dy('.'),hy()}function yy(){var e;return dy('['),e=Ey(),dy(']'),e}function by(){var e,t,n;for(e=uy();;)if(ry('.'))n=my(),e=Qm('.',e,n);else if(ry('('))t=gy(),e=Vm(e,t);else if(ry('['))n=yy(),e=Qm('[',e,n);else break;return e}function _y(){var e=by();if(cM.type===fP&&(ry('++')||ry('--')))throw new Error(DP);return e}function xy(){var e,t;if(cM.type!==fP&&cM.type!==oP)t=_y();else if(ry('++')||ry('--'))throw new Error(DP);else if(ry('+')||ry('-')||ry('~')||ry('!'))e=Gm(),t=xy(),t=ny(e.value,t);else if(oy('delete')||oy('void')||oy('typeof'))throw new Error(DP);else t=_y();return t}function vy(e){var t=0;if(e.type!==fP&&e.type!==oP)return 0;switch(e.value){case'||':t=1;break;case'&&':t=2;break;case'|':t=3;break;case'^':t=4;break;case'&':t=5;break;case'==':case'!=':case'===':case'!==':t=6;break;case'<':case'>':case'<=':case'>=':case'instanceof':case'in':t=7;break;case'<<':case'>>':case'>>>':t=8;break;case'+':case'-':t=9;break;case'*':case'/':case'%':t=11;break;default:}return t}function wy(){var e,t,n,a,d,r,o,l,s,f;if(e=cM,s=xy(),a=cM,d=vy(a),0===d)return s;for(a.prec=d,Gm(),t=[e,cM],o=xy(),r=[s,a,o];0<(d=vy(cM));){for(;2<r.length&&d<=r[r.length-2].prec;)o=r.pop(),l=r.pop().value,s=r.pop(),t.pop(),n=Xm(l,s,o),r.push(n);a=Gm(),a.prec=d,r.push(a),t.push(cM),n=xy(),r.push(n)}for(f=r.length-1,n=r[f],t.pop();1<f;)t.pop(),n=Xm(r[f-1].value,r[f-2],n),f-=2;return n}function Sy(){var e,t,n;return e=wy(),ry('?')&&(Gm(),t=Sy(),dy(':'),n=Sy(),e=Jm(e,t,n)),e}function Ey(){var e=Sy();if(ry(','))throw new Error(DP);return e}function Cy(e){lM=e,sM=0,fM=lM.length,cM=null,Wm();var t=Ey();if(cM.type!==dP)throw new Error('Unexpect token after expression.');return t}function zy(e){function t(t,n,a,i){var d=e(n[0]);return a&&(d=a+'('+d+')',0===a.lastIndexOf('new ',0)&&(d='('+d+')')),d+'.'+t+(0>i?'':0===i?'()':'('+n.slice(1).map(e).join(',')+')')}function n(e,n,a){return function(i){return t(e,i,n,a)}}var a='new Date',i='String',d='RegExp';return{isNaN:'isNaN',isFinite:'isFinite',abs:'Math.abs',acos:'Math.acos',asin:'Math.asin',atan:'Math.atan',atan2:'Math.atan2',ceil:'Math.ceil',cos:'Math.cos',exp:'Math.exp',floor:'Math.floor',log:'Math.log',max:'Math.max',min:'Math.min',pow:'Math.pow',random:'Math.random',round:'Math.round',sin:'Math.sin',sqrt:'Math.sqrt',tan:'Math.tan',clamp:function(t){3>t.length&&F('Missing arguments to clamp function.'),3<t.length&&F('Too many arguments to clamp function.');var n=t.map(e);return'Math.max('+n[1]+', Math.min('+n[2]+','+n[0]+'))'},now:'Date.now',utc:'Date.UTC',datetime:a,date:n('getDate',a,0),day:n('getDay',a,0),year:n('getFullYear',a,0),month:n('getMonth',a,0),hours:n('getHours',a,0),minutes:n('getMinutes',a,0),seconds:n('getSeconds',a,0),milliseconds:n('getMilliseconds',a,0),time:n('getTime',a,0),timezoneoffset:n('getTimezoneOffset',a,0),utcdate:n('getUTCDate',a,0),utcday:n('getUTCDay',a,0),utcyear:n('getUTCFullYear',a,0),utcmonth:n('getUTCMonth',a,0),utchours:n('getUTCHours',a,0),utcminutes:n('getUTCMinutes',a,0),utcseconds:n('getUTCSeconds',a,0),utcmilliseconds:n('getUTCMilliseconds',a,0),length:n('length',null,-1),indexof:n('indexOf',null),lastindexof:n('lastIndexOf',null),slice:n('slice',null),parseFloat:'parseFloat',parseInt:'parseInt',upper:n('toUpperCase',i,0),lower:n('toLowerCase',i,0),substring:n('substring',i),replace:n('replace',i),regexp:d,test:n('test',d),if:function(t){3>t.length&&F('Missing arguments to if function.'),3<t.length&&F('Too many arguments to if function.');var n=t.map(e);return'('+n[0]+'?'+n[1]+':'+n[2]+')'}}}function Ty(e){function t(e){if(I(e))return e;var t=u[e.type];return null==t&&F('Unsupported type: '+e.type),t(e)}function n(e){var n={code:t(e),globals:Object.keys(s),fields:Object.keys(f)};return s={},f={},n}e=e||{};var a=e.whitelist?he(e.whitelist):{},i=e.blacklist?he(e.blacklist):{},d=e.constants||jP,r=(e.functions||zy)(t),o=e.globalvar,l=e.fieldvar,s={},f={},c=0,p=V(o)?o:function(e){return o+'["'+e+'"]'},u={Literal:function(e){return e.raw},Identifier:function(e){var t=e.name;return 0<c?t:i.hasOwnProperty(t)?F('Illegal identifier: '+t):d.hasOwnProperty(t)?d[t]:a.hasOwnProperty(t)?t:(s[t]=1,p(t))},MemberExpression:function(e){var n=!e.computed,a=t(e.object);n&&(c+=1);var i=t(e.property);return a===l&&(f[i]=1),n&&(c-=1),a+(n?'.'+i:'['+i+']')},CallExpression:function(e){'Identifier'!==e.callee.type&&F('Illegal callee type: '+e.callee.type);var n=e.callee.name,a=e.arguments,i=r.hasOwnProperty(n)&&r[n];return i||F('Unrecognized function: '+n),V(i)?i(a):i+'('+a.map(t).join(',')+')'},ArrayExpression:function(e){return'['+e.elements.map(t).join(',')+']'},BinaryExpression:function(e){return'('+t(e.left)+e.operator+t(e.right)+')'},UnaryExpression:function(e){return'('+e.operator+t(e.argument)+')'},ConditionalExpression:function(e){return'('+t(e.test)+'?'+t(e.consequent)+':'+t(e.alternate)+')'},LogicalExpression:function(e){return'('+t(e.left)+e.operator+t(e.right)+')'},ObjectExpression:function(e){return'{'+e.properties.map(t).join(',')+'}'},Property:function(e){c+=1;var n=t(e.key);return c-=1,n+':'+t(e.value)}};return n.functions=r,n.constants=d,n}function Ry(e){var t={};return function(n,a){var i=t[a]||(t[a]=e(a));return i(n)}}function Ay(e,t,n){return GP.setMonth(e),GP.setDate(t),IP(GP,n)}function Oy(e,t,n){try{e[t].apply(e,['EXPRESSION'].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}function Py(e,t){var n;return V(e)?e:I(e)?(n=t.scales[e])&&n.value:void 0}function My(e,t,n){var a=VP+n;if(!t.hasOwnProperty(a))try{t[a]=e.scaleRef(n)}catch(e){}}function Dy(e,t,n,a){if(t[0].type===HP)My(n,a,t[0].value);else if(t[0].type===XP)for(e in n.scales)My(n,a,e)}function Ly(e){return function(t,n,a){var i=Py(t,(a||this).context);return i&&i.path[e](n)}}function qy(e){var t=this.context.data[e];return t?t.values.value:[]}function Uy(e,t,n,a){t[0].type!==HP&&F('First argument to data functions must be a string literal.');var i=t[0].value,d=JP+i;a.hasOwnProperty(d)||(a[d]=n.getData(i).tuplesRef())}function Fy(e){return e.data}function jy(e,t){var n=qy.call(t,e);return n.root&&n.root.lookup||eM}function $y(e,n){var a=n[0],i=n[n.length-1],d;return a>i&&(d=a,a=i,i=d),a<=e&&e<=i}function Ny(e){return function(t){for(var n in e)if('_id'!==n&&t[n]!==e[n])return!1;return!0}}function Iy(e,t,n,a,i,d){var r=this.context.dataflow,o=this.context.data[e],l=o.input,s=o.changes,f=r.stamp(),c,p;if(!1===r._trigger||!(l.value.length||t||a))return 0;if((!s||s.stamp<f)&&(o.changes=s=r.changeset(),s.stamp=f,r.runAfter(function(){o.modified=!0,r.pulse(l,s).run()})),n&&(c=!0===n?hv:fv(n)||null!=n._id?n:Ny(n),s.remove(c)),t&&s.insert(t),a&&(c=Ny(a),l.value.some(c)?s.remove(c):s.insert(a)),i)for(p in d)s.modify(i,p,d[p]);return 1}function By(e,t){for(var a=t.fields,d=t.values,r=t.getter||(t.getter=[]),o=a.length,n=0;n<o;++n)if(r[n]=r[n]||$(a[n]),r[n](e)!==d[n])return!1;return!0}function Yy(e,t){for(var a=t.intervals,d=a.length,n=0,i;n<d;++n){if(i=a[n].getter||(a[n].getter=$(a[n].field)),a[n].extent[0]===a[n].extent[1])return!0;if(!$y(i(e),a[n].extent))return!1}return!0}function Gy(e,t,a,d,r,o){for(var l=this.context.data[e],s=l?l.values.value:[],f=d!==tM,c=s.length,p=0,i,u;p<c;++p)if(i=s[p],u=t===i.unit,(r!==aM||!u)&&(r!==nM||u)&&(u=o(a,i),f^u))return u;return!c||f}function Wy(e,t,n){return e[0]>t&&(e[0]=t),e[1]<n&&(e[1]=n),e}function Hy(e,t,n){return n<e[0]||e[1]<t?[]:(e[0]<t&&(e[0]=t),e[1]>n&&(e[1]=n),e)}function Xy(e,t,n){return 1===arguments.length?iM[e]:(iM[e]=t,n&&(oM[e]=n),uM&&(uM.functions[e]=rM+e),this)}function Vy(e,t,n){var a={},i,d;try{i=Cy(e)}catch(t){F('Expression parse error: '+Y(e))}return i.visit(function(e){if('CallExpression'===e.type){var n=e.callee.name,i=pM.visitors[n];i&&i(n,e.arguments,t,a)}}),d=uM(i),d.globals.forEach(function(e){var n=gM+e;!a.hasOwnProperty(n)&&t.getSignal(e)&&(a[n]=t.signalRef(e))}),{$expr:n?n+'return('+d.code+');':d.code,$fields:d.fields,$params:a}}function Jy(e,t){return e.signal?t.getSignal(e.signal).id:Ky(e,t)}function Zy(e){return e===mM?hM:e||hM}function Ky(e,t){var n=e.merge?Qy:e.stream?eb:e.type?tb:F('Invalid stream specification: '+Y(e));return n(e,t)}function Qy(e,t){var n=e.merge.map(function(e){return Ky(e,t)}),a=nb({merge:n},e,t);return t.addStream(a).id}function eb(e,t){var n=Ky(e.stream,t),a=nb({stream:n},e,t);return t.addStream(a).id}function tb(e,t){var n=t.event(Zy(e.source),e.type),a=nb({stream:n},e,t);return 1===Object.keys(a).length?n:t.addStream(a).id}function nb(e,t,n){var a=t.between;return a&&(2!==a.length&&F('Stream "between" parameter must have 2 entries: '+Y(t)),e.between=[Ky(a[0],n),Ky(a[1],n)]),a=t.filter?H(t.filter):[],(t.marktype||t.markname||t.markrole)&&a.push(ab(t.marktype,t.markname,t.markrole)),t.source===mM&&a.push('inScope(event.item)'),a.length&&(e.filter=Vy('('+a.join(')&&(')+')').$expr),null!=(a=t.throttle)&&(e.throttle=+a),null!=(a=t.debounce)&&(e.debounce=+a),t.consume&&(e.consume=!0),e}function ab(e,t,n){var a='event.item';return a+(e&&'*'!==e?'&&'+a+'.mark.marktype===\''+e+'\'':'')+(n?'&&'+a+'.mark.role===\''+n+'\'':'')+(t?'&&'+a+'.mark.name===\''+t+'\'':'')}function ib(e,t,n){return FD=t||yM,jD=n||CM,ob(e.trim()).map(lb)}function db(e){return jD.hasOwnProperty(e)}function rb(e,t,a,i,d){for(var r=0,o=e.length,n;t<o;++t){if(n=e[t],!r&&n===a)return t;d&&0<=d.indexOf(n)?--r:i&&0<=i.indexOf(n)&&++r}return t}function ob(e){for(var t=[],a=0,d=e.length,n=0;n<d;)n=rb(e,n,wM,bM+xM,_M+vM),t.push(e.substring(a,n).trim()),a=++n;if(0===t.length)throw'Empty event selector: '+e;return t}function lb(e){return'['===e[0]?sb(e):fb(e)}function sb(e){var t=e.length,n=1,a,i;if(n=rb(e,n,_M,bM,_M),n===t)throw'Empty between selector: '+e;if(a=ob(e.substring(1,n)),2!==a.length)throw'Between selector must have two elements: '+e;if(e=e.slice(n+1).trim(),e[0]!==EM)throw'Expected \'>\' after between selector: '+e;return(a=a.map(lb),i=lb(e.slice(1).trim()),i.between)?{between:a,stream:i}:(i.between=a,i)}function fb(e){var t={source:FD},a=[],d=[0,0],r=0,o=0,l=e.length,s=0,i,f;if(e[l-1]===vM){if(s=e.lastIndexOf(xM),0<=s){try{d=cb(e.substring(s+1,l-1))}catch(t){throw'Invalid throttle specification: '+e}e=e.slice(0,s).trim(),l=e.length}else throw'Unmatched right brace: '+e;s=0}if(!l)throw e;if(e[0]===SM&&(r=++s),i=rb(e,s,kM),i<l&&(a.push(e.substring(o,i).trim()),o=s=++i),s=rb(e,s,bM),s===l)a.push(e.substring(o,l).trim());else if(a.push(e.substring(o,s).trim()),f=[],o=++s,o===l)throw'Unmatched left bracket: '+e;for(;s<l;){if(s=rb(e,s,_M),s===l)throw'Unmatched left bracket: '+e;if(f.push(e.substring(o,s).trim()),s<l-1&&e[++s]!==bM)throw'Expected left bracket: '+e;o=++s}if(!(l=a.length)||GT.test(a[l-1]))throw'Invalid event selector: '+e;return 1<l?(t.type=a[1],r?t.markname=a[0].slice(1):db(a[0])?t.marktype=a[0]:t.source=a[0]):t.type=a[0],'!'===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=f&&(t.filter=f),d[0]&&(t.throttle=d[0]),d[1]&&(t.debounce=d[1]),t}function cb(e){var t=e.split(wM);if(!e.length||2<t.length)throw e;return t.map(function(t){var n=+t;if(n!==n)throw e;return n})}function pb(e,t,n){var a=e.events,i=e.update,d=e.encode,r=[],o='',l;a||F('Signal update missing events specification.'),I(a)&&(a=ib(a)),a=H(a).filter(function(e){return e.signal?(r.push(e),0):1}),a.length&&r.push(1<a.length?{merge:a}:a[0]),null!=d&&(i&&F('Signal encode and update are mutually exclusive.'),i='encode(item(),'+Y(d)+')'),o=I(i)?Vy(i,t,zM):null==i.expr?null==i.value?null==i.signal?F('Invalid signal update specification.'):{$expr:'_.value',$params:{value:t.signalRef(i.signal)}}:i.value:Vy(i.expr,t,zM),l={target:n,update:o},e.force&&(l.options={force:!0}),r.forEach(function(e){e={source:Jy(e,t)},t.addUpdate(Z(e,l))})}function ub(e,t){var n=t.getSignal(e.name);if(e.update){var a=Vy(e.update,t);n.update=a.$expr,n.params=a.$params}e.on&&e.on.forEach(function(e){pb(e,t,n.id)})}function gb(e,t){var n={};for(var a in e)'name'!==a&&(n[a]=hb(e[a],t));t.addProjection(e.name,n)}function hb(e,t){return fv(e)?e.map(function(e){return hb(e,t)}):N(e)?e.signal?t.signalRef(e.signal):F('Unsupported parameter object: '+Y(e)):e}function mb(e,t){var n='';return TM[t]?n:(e.x2&&(e.x?(RM[t]&&(n+='if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;'),n+='o.width=o.x2-o.x;'):e.width?n+='o.x=o.x2-o.width;':n+='o.x=o.x2;'),e.xc&&(e.width?n+='o.x=o.xc-o.width/2;':n+='o.x=o.xc;'),e.y2&&(e.y?(RM[t]&&(n+='if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;'),n+='o.height=o.y2-o.y;'):e.height?n+='o.y=o.y2-o.height;':n+='o.y=o.y2;'),e.yc&&(e.height?n+='o.y=o.yc-o.height/2;':n+='o.y=o.yc;'),n)}function yb(e,t,n,i){function a(e,d,r,o){var l=Cb(null,d,t,n,i),a=Cb(null,r,t,n,i),s=Cb(null,o,t,n,i);return'this.'+e+'('+[l,a,s].join(',')+').toString()'}return e.c?a('hcl',e.h,e.c,e.l):e.h||e.s?a('hsl',e.h,e.s,e.l):e.l||e.a?a('lab',e.l,e.a,e.b):e.r||e.g||e.b?a('rgb',e.r,e.g,e.b):null}function bb(e,t,n,a){var i=Vy(e,t);return i.$fields.forEach(function(e){a[e]=1}),Z(n,i.$params),i.$expr}function _b(e,t,n,a){return xb(N(e)?e:{datum:e},t,n,a)}function xb(e,t,n,a){var i,d,r;if(e.signal)i='datum',r=bb(e.signal,t,n,a);else if(e.group||e.parent){for(d=nv(1,e.level||1),i='item';0<d--;)i+='.mark.group';e.parent?(r=e.parent,i+='.datum'):r=e.group}else e.datum?(i='datum',r=e.datum):F('Invalid field reference: '+Y(e));return e.signal||(I(r)?(a[r]=1,r=j(r).map(Y).join('][')):r=xb(r,t,n,a)),i+'['+r+']'}function vb(e,t,n,a,i){var d=wb(e.scale,n,a,i),r,o,l;return null==e.range?(void 0!==t&&(t=d+'('+t+')'),e.band&&(l=kb(e.scale,n))&&(o=d+'.bandwidth',r=+e.band,r=o+'()'+(1===r?'':'*'+r),0>l&&(r='('+o+'?'+r+':0)'),t=(t?t+'+':'')+r,e.extra&&(t='(datum.extra?'+d+'(datum.extra.value):'+t+')')),null==t&&(t='0')):(r=+e.range,o=d+'.range()',t=0===r?o+'[0]':'($='+o+','+(1===r?'$[$.length-1]':'$[0]+'+r+'*($[$.length-1]-$[0])')+')'),t}function kb(e,t){if(!I(e))return-1;var n=t.scaleType(e);return'band'===n||'point'===n?1:0}function wb(e,t,n,a){if(I(e))i=VP+e,n.hasOwnProperty(i)||(n[i]=t.scaleRef(e)),i=Y(i);else{for(var i in t.scales)n[VP+i]=t.scaleRef(i);i=Y(VP)+'+'+(e.signal?'('+bb(e.signal,t,n,a)+')':_b(e,t,n,a))}return'_['+i+']'}function Sb(e,t,n,a){return'this.gradient('+wb(e.gradient,t,n,a)+','+Y(e.start)+','+Y(e.stop)+','+Y(e.count)+')'}function Eb(e,t,n,a){return N(e)?'('+Cb(null,e,t,n,a)+')':e}function Cb(e,t,n,a,i){if(null!=t.gradient)return Sb(t,n,a,i);var d=t.signal?bb(t.signal,n,a,i):t.color?yb(t.color,n,a,i):null==t.field?void 0===t.value?void 0:Y(t.value):_b(t.field,n,a,i);return null!=t.scale&&(d=vb(t,d,n,a,i)),void 0===d&&(d=null),null!=t.exponent&&(d='Math.pow('+d+','+Eb(t.exponent,n,a,i)+')'),null!=t.mult&&(d+='*'+Eb(t.mult,n,a,i)),null!=t.offset&&(d+='+'+Eb(t.offset,n,a,i)),t.round&&(d='Math.round('+d+')'),d}function zb(e,t,n){return e+'['+Y(t)+']='+n+';'}function Tb(e,t,n,a,i){var d='';return t.forEach(function(t){var r=Cb(e,t,n,a,i);d+=t.test?bb(t.test,n,a,i)+'?'+r+':':r}),zb('o',e,d)}function Rb(e,t,n,a){var i={},d='var o=item,datum=o.datum,$;',r,o,l;for(r in e)o=e[r],fv(o)?d+=Tb(r,o,a,n,i):(l=Cb(r,o,a,n,i),d+=zb('o',r,l));return d+=mb(e,t),d+='return 1;',{$expr:d,$fields:Object.keys(i),$output:Object.keys(e)}}function Ab(e){return N(e)?e:{value:e}}function Ob(e,t,n){return null==n?0:(e[t]={value:n},1)}function Pb(e,t,n){for(var a in t)n&&n.hasOwnProperty(a)||(e[a]=Z(e[a]||{},t[a]));return e}function Mb(e,t,n,a,i){var d,r;for(r in i=i||{},i.encoders={$encode:d={}},e=Db(e,t,n,a.config),e)d[r]=Rb(e[r],t,i,a);return i}function Db(e,t,n,a){var i,d,r;for(d in('legend'==n||0===(n+'').indexOf('axis'))&&(n=null),a=n===OM?a.group:n===AM||a[t=n]?Z({},a.mark,a[t]):{},i={},a)r=Lb(d,e)||('fill'===d||'stroke'===d)&&(Lb('fill',e)||Lb('stroke',e)),r||(i[d]={value:a[d]});return e=Z({},e),e.enter=Z(i,e.enter),e}function Lb(e,t){return t.enter&&t.enter[e]||t.update&&t.update[e]}function qb(e,t,n,a,i,d){return{type:e,name:d?d.name:void 0,role:t,key:n,from:a,interactive:!!(d&&d.interactive),encode:Pb(i,d,WM)}}function Ub(e,t,n){var a={value:0},i={},d,r;return i.enter=d={opacity:a,x:a,y:a},Ob(d,'width',t.gradientWidth),Ob(d,'height',t.gradientHeight),Ob(d,'stroke',t.gradientStrokeColor),Ob(d,'strokeWidth',t.gradientStrokeWidth),i.exit={opacity:a},i.update=r={x:a,y:a,fill:{gradient:e},opacity:{value:1}},Ob(r,'width',t.gradientWidth),Ob(r,'height',t.gradientHeight),qb(XM,NM,void 0,void 0,i,n)}function Fb(e,t,n,a){var i={value:0},d={},r,o;return d.enter=r={opacity:i,text:{field:aD}},Ob(r,'fill',t.labelColor),Ob(r,'font',t.labelFont),Ob(r,'fontSize',t.labelFontSize),Ob(r,'baseline',t.gradientLabelBaseline),Ob(r,'limit',t.gradientLabelLimit),d.exit={opacity:i},d.update=o={opacity:{value:1}},r.x=o.x={field:dD,mult:t.gradientWidth},r.y=o.y={value:t.gradientHeight,offset:t.gradientLabelOffset},r.align=o.align={signal:fD},qb(ZM,IM,dD,a,d,n)}function jb(e,t,n,a){var i={value:0},d={},r,o;return d.enter=r={opacity:i,text:{field:aD}},Ob(r,'align',t.labelAlign),Ob(r,'baseline',t.labelBaseline),Ob(r,'fill',t.labelColor),Ob(r,'font',t.labelFont),Ob(r,'fontSize',t.labelFontSize),Ob(r,'limit',t.labelLimit),d.exit={opacity:i},d.update=o={opacity:{value:1}},r.x=o.x={field:iD,offset:t.labelOffset},r.y=o.y={field:rD,mult:0.5,offset:{field:oD,offset:{field:{group:'entryPadding'},mult:{field:nD}}}},qb(ZM,IM,lD,a,d,n)}function $b(e,t,n,a){var i={value:0},d={},r,o;return d.enter=r={opacity:i},Ob(r,'shape',t.symbolType),Ob(r,'size',t.symbolSize),Ob(r,'strokeWidth',t.symbolStrokeWidth),e.fill||Ob(r,'stroke',t.symbolColor),d.exit={opacity:i},d.update=o={opacity:{value:1}},r.x=o.x={field:iD,mult:0.5},r.y=o.y={field:rD,mult:0.5,offset:{field:oD,offset:{field:{group:'entryPadding'},mult:{field:nD}}}},sD.forEach(function(t){e[t]&&(o[t]=r[t]={scale:e[t],field:lD})}),qb(JM,BM,lD,a,d,n)}function Nb(e,t,n,a){var i={value:0},d=e.title,r={},o;return r.enter=o={x:{field:{group:'padding'}},y:{field:{group:'padding'}},opacity:i},Ob(o,'align',t.titleAlign),Ob(o,'baseline',t.titleBaseline),Ob(o,'fill',t.titleColor),Ob(o,'font',t.titleFont),Ob(o,'fontSize',t.titleFontSize),Ob(o,'fontWeight',t.titleFontWeight),Ob(o,'limit',t.titleLimit),r.exit={opacity:i},r.update={opacity:{value:1},text:d&&d.signal?{signal:d.signal}:{value:d+''}},qb(ZM,YM,null,a,r,n)}function Ib(e,t,n,a,i,d){return{type:HM,name:t,role:e,from:n,interactive:a,encode:i,marks:d}}function Bb(e){var t=e.role||'';return t.indexOf('axis')&&t.indexOf('legend')?e.type===HM?PM:t||AM:t}function Yb(e){return{clip:e.clip||!1,interactive:!1!==e.interactive,marktype:e.type,name:e.name||void 0,role:e.role||Bb(e),zindex:+e.zindex||void 0}}function Gb(e){return e}function Wb(e,t,n,a){this.id=-1,this.type=e,this.value=t,this.params=n,a&&(this.parent=a)}function Hb(e,t,n,a){return new Wb(e,t,n,a)}function Xb(e,t){return Hb('Operator',e,t)}function Vb(e){var t={$ref:e.id};return 0>e.id&&(e.refs=e.refs||[]).push(t),t}function Jb(e,t){return t?{$field:e,$name:t}:{$field:e}}function Zb(e,t){return{$compare:e,$order:t}}function Kb(e){return{$key:e}}function Qb(e){return N(e)?(e.order===pD?'-':'+')+e_(e.op,e.field):''}function e_(e,t){return(e&&e.signal?'$'+e.signal:e||'')+(e&&t?'_':'')+(t&&t.signal?'$'+t.signal:t||'')}function t_(e){return e&&e.signal}function n_(e){return function(t,n,a){return Hb(e,n,t||void 0,a)}}function a_(e,n){var a=Nd(e.type);a||F('Unrecognized transform type: '+Y(e.type));var i=Hb(a.type,null,i_(a,e,n));return e.signal&&n.addSignal(e.signal,n.proxy(i)),i.metadata=a.metadata||{},i}function i_(e,t,a){var d={},r,o,i;for(o=0,i=e.params.length;o<i;++o)r=e.params[o],d[r.name]=d_(r,t,a);return d}function d_(e,t,n){var a=e.type,i=t[e.name];if('index'===a)return o_(e,t,n);return void 0===i?void(e.required&&F('Missing required '+Y(t.type)+' parameter: '+Y(e.name))):'param'===a?l_(e,t,n):'projection'===a?n.projectionRef(t[e.name]):e.array&&!t_(i)?i.map(function(t){return r_(e,t,n)}):r_(e,i,n)}function r_(e,t,n){var a=e.type;if(t_(t))return u_(a)?F('Expression references can not be signals.'):g_(a)?n.fieldRef(t):h_(a)?n.compareRef(t):n.signalRef(t.signal);var i=e.expr||g_(a);return i&&f_(t)?Vy(t.expr,n):i&&c_(t)?Jb(t.field):u_(a)?Vy(t,n):p_(a)?Vb(n.getData(t).values):g_(a)?Jb(t):h_(a)?n.compareRef(t):t}function o_(e,t,n){return I(t.from)||F('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function l_(e,t,n){var a=t[e.name];return e.array?(fv(a)||F('Expected an array of sub-parameters. Instead: '+Y(a)),a.map(function(t){return s_(e,t,n)})):s_(e,a,n)}function s_(e,t,a){var d,r,o,l,i;for(l=0,i=e.params.length;l<i;++l){for(o in r=e.params[l],r.key)if(r.key[o]!==t[o]){r=null;break}if(r)break}return r||F('Unsupported parameter: '+Y(t)),d=Z(i_(r,t,a),r.key),Vb(a.add(zD(d)))}function f_(e){return e&&e.expr}function c_(e){return e&&e.field}function p_(e){return'data'===e}function u_(e){return'expr'===e}function g_(e){return'field'===e}function h_(e){return'compare'===e}function m_(e,t,n){var a,i,d,r,o;return e?(a=e.facet)&&(!t&&F('Only group marks can be faceted.'),null==a.field?(i=n.keyRef(a.groupby),e.data?o=Vb(n.getData(e.data).aggregate):(d=a_(Z({type:'aggregate',groupby:H(a.groupby)},a.aggregate)),d.params.key=i,d.params.pulse=Vb(n.getData(a.data).output),r=o=Vb(n.add(d)))):r=o=Vb(n.getData(a.data).output)):r=Vb(n.add(mD(null,[{}]))),r||(r=e.$ref?e:e.mark?Vb(n.getData(Gb(e.mark)).output):Vb(n.getData(e.data).output)),{key:i,pulse:r,parent:o}}function y_(e,t,n,a,i){this.scope=e,this.input=t,this.output=n,this.values=a,this.aggregate=i,this.index={}}function b_(e){return I(e)?e:null}function __(e,t,a){var d=e_(a.op,a.field),r;if(t.ops){for(var o=0,i=t.as.length;o<i;++o)if(t.as[o]===d)return;}else t.ops=['count'],t.fields=[null],t.as=['count'];a.op&&(t.ops.push((r=a.op.signal)?e.signalRef(r):a.op),t.fields.push(e.fieldRef(a.field)),t.as.push(d))}function x_(e,t,n,a,i,d,r){var o=t[n]||(t[n]={}),l=Qb(d),s=b_(i),f,c;if(null!=s&&(e=t.scope,s+=l?'|'+l:'',f=o[s]),!f){var p=d?{field:cD,pulse:t.countsRef(e,i,d)}:{field:e.fieldRef(i),pulse:Vb(t.output)};l&&(p.sort=e.sortRef(d)),c=e.add(Hb(a,void 0,p)),r&&(t.index[i]=c),f=Vb(c),null!=s&&(o[s]=f)}return f}function v_(e,t,n){var a=e.from.facet,i=a.name,d=Vb(t.getData(a.data).output),r,o,l,s;a.name||F('Facet must have a name: '+Y(a)),a.data||F('Facet must reference a data set: '+Y(a)),a.field?s=t.add(TD({field:t.fieldRef(a.field),pulse:d})):a.groupby?s=t.add(xD({key:t.keyRef(a.groupby),group:Vb(t.proxy(n.parent)),pulse:d})):F('Facet must specify groupby or field: '+Y(a)),r=t.fork(),o=r.add(mD()),l=r.add(DD({pulse:Vb(o)})),r.addData(i,new y_(r,o,o,l)),r.addSignal('parent',null),s.params.subflow={$subflow:dx(e,r).toRuntime()}}function k_(e,t,n){var a=t.add(TD({pulse:n.pulse})),i=t.fork();i.add(DD()),i.addSignal('parent',null),a.params.subflow={$subflow:dx(e,i).toRuntime()}}function w_(e,t,n){var a=e.remove,i=e.insert,d=e.toggle,r=e.modify,o=e.values,l=t.add(Xb()),s,f;s='if('+e.trigger+',modify("'+n+'",'+[i,a,d,r,o].map(function(e){return null==e?'null':e}).join(',')+'),0)',f=Vy(s,t),l.update=f.$expr,l.params=f.$params}function S_(e,t){var n=Bb(e),a=e.type===HM,i=e.from&&e.from.facet,d=e.layout||n===PM||n===OM,r=n===AM||d||i,o,l,s,f,c,p,u,g,h,m,y,b,_;s=m_(e.from,a,t),l=t.add(bD({key:s.key||(e.key?Jb(e.key):void 0),pulse:s.pulse,clean:!a})),h=Vb(l),l=f=t.add(mD({pulse:h})),l=t.add(SD({markdef:Yb(e),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef('parent'):null,index:t.markpath(),pulse:Vb(l)})),m=Vb(l),l=t.add(_D(Mb(e.encode,e.type,n,t,{pulse:m}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(function(e){var n=a_(e,t);(n.metadata.generates||n.metadata.changes)&&F('Mark transforms should not generate new data.'),n.params.pulse=Vb(l),t.add(l=n)}),e.sort&&(l=t.add(LD({sort:t.compareRef(e.sort),pulse:Vb(l)}))),y=Vb(l),(i||d)&&(d=t.add(qD({layout:t.objectProperty(e.layout),legendMargin:t.config.legendMargin,mark:m,pulse:y})),b=Vb(d)),c=t.add(hD({mark:m,pulse:b||y})),_=Vb(c),a&&(r&&(o=t.operators,o.pop(),d&&o.pop()),t.pushState(y,b||_,h),i?v_(e,t,s):r?k_(e,t,s):dx(e,t),t.popState(),r&&(d&&o.push(d),o.push(c))),p=t.add(PD({pulse:_})),u=t.add(DD({pulse:_},void 0,t.parent())),null!=e.name&&(g=Gb(e.name),t.addData(g,new y_(t,f,p,u)),e.on&&e.on.forEach(function(e){(e.insert||e.remove||e.toggle)&&F('Marks only support modify triggers.'),w_(e,t,g)}))}function E_(e,t){var n=e.type||'symbol',a=t.config.legend,i=e.name||void 0,d=e.encode||{},r=!!e.interactive,o=e.size||e.shape||e.fill||e.stroke||e.strokeDash||e.opacity,l,s,f,c,p,u,g,h;return o||F('Missing valid scale for legend.'),l={orient:C_(e.orient,a.orient),title:null!=e.title},s=Vb(t.add(mD(null,[l]))),u=Pb({enter:T_(a),update:{offset:Ab(C_(e.offset,a.offset)),padding:Ab(C_(e.padding,a.padding)),titlePadding:Ab(C_(e.titlePadding,a.titlePadding))}},d.legend),g={update:{x:{field:{group:'padding'}},y:{field:{group:'padding'}},entryPadding:Ab(C_(e.entryPadding,a.entryPadding))}},'gradient'===n?(f=Vb(t.add(wD({type:'gradient',scale:t.scaleRef(o),count:t.property(e.tickCount),values:t.property(e.values),formatSpecifier:t.property(e.format)}))),h=[Ub(o,a,d.gradient),Fb(e,a,d.labels,f)]):(f=Vb(t.add(wD({size:z_(e,a,d.labels),scale:t.scaleRef(o),count:t.property(e.tickCount),values:t.property(e.values),formatSpecifier:t.property(e.format)}))),h=[$b(e,a,d.symbols,f),jb(e,a,d.labels,f)]),h=[Ib($M,null,s,r,g,h)],l.title&&(p=Nb(e,a,d.title,s),g.update.y.offset={field:{group:'titlePadding'},offset:p.encode.update.fontSize||p.encode.enter.fontSize},h.push(p)),c=Ib(jM,i,s,r,u,h),e.zindex&&(c.zindex=e.zindex),S_(c,t)}function C_(e,t){return null==e?t:e}function z_(e,t,n){var a=+t.symbolSize,i;return i=n&&n.update&&n.update.fontSize,i||(i=n&&n.enter&&n.enter.fontSize),i&&(i=i.value),i||(i=+t.labelFontSize),e.size?{$expr:'Math.max(Math.ceil(Math.sqrt(_.scale(datum))),'+i+')'}:nv(tv(Hx(a)),i)}function T_(e){var t={},n=Ob(t,'fill',e.fillColor)+Ob(t,'stroke',e.strokeColor)+Ob(t,'strokeWidth',e.strokeWidth)+Ob(t,'strokeDash',e.strokeDash)+Ob(t,'cornerRadius',e.cornerRadius);return n?t:void 0}function R_(e){return YD.hasOwnProperty(e)}function A_(e){return'quantile'===e}function O_(e,t){var n=e.type||'linear',a,i;for(i in BD.hasOwnProperty(n)||F('Unrecognized scale type: '+Y(n)),a={type:n,domain:L_(e.domain,e,t)},null!=e.range&&(a.range=G_(e,t,a)),null!=e.interpolate&&Y_(e.interpolate,a),e)a.hasOwnProperty(i)||'name'===i||(a[i]=P_(e[i],t));t.addScale(e.name,a)}function P_(e,t){return N(e)?e.signal?t.signalRef(e.signal):F('Unsupported object: '+Y(e)):e}function M_(e,t){return e.signal?t.signalRef(e.signal):e.map(function(e){return P_(e,t)})}function D_(e){F('Can not find data set: '+Y(e))}function L_(e,t,n){return e?e.signal?n.signalRef(e.signal):(fv(e)?q_:e.fields?F_:U_)(e,t,n):void((null!=t.domainMin||null!=t.domainMax)&&F('No scale domain defined for domainMin/domainMax to override.'))}function q_(e,t,n){return e.map(function(e){return P_(e,n)})}function U_(e,t,n){var a=n.getData(e.data);return a||D_(e.data),R_(t.type)?a.valuesRef(n,e.field,N_(e.sort,!1)):A_(t.type)?a.domainRef(n,e.field):a.extentRef(n,e.field)}function F_(e,t,n){var a=e.data,i=e.fields.reduce(function(e,t){return t=I(t)?{data:a,field:t}:fv(t)||t.signal?j_(t,n):t,e.push(t),e},[]);return(R_(t.type)?$_:A_(t.type)?I_:B_)(e,n,i)}function j_(e,t){var n='_:vega:_'+ND++,a=mD({});return fv(e)?a.value={$ingest:e}:e.signal&&t.signalRef('modify('+Y(n)+','+e.signal+', true)'),t.addDataPipeline(n,[a,DD({})]),{data:n,field:'data'}}function $_(e,t,n){var i,d,a,r;return i=n.map(function(e){var n=t.getData(e.data);return n||D_(e.data),n.countsRef(t,e.field)}),d=t.add(uD({groupby:cD,ops:['sum'],fields:[t.fieldRef('count')],as:['count'],pulse:i})),a=t.add(mD({pulse:Vb(d)})),r=t.add(UD({field:cD,sort:t.sortRef(N_(e.sort,!0)),pulse:Vb(a)})),Vb(r)}function N_(e,t){return e&&(e.field||e.op?e.field||'count'===e.op?t&&e.field?F('Multiple domain scales can not sort by field.'):t&&e.op&&'count'!==e.op&&F('Multiple domain scales support op count only.'):F('No field provided for sort aggregate op: '+e.op):N(e)?e.field='key':e={field:'key'}),e}function I_(e,t,n){var a=n.map(function(e){var n=t.getData(e.data);return n||D_(e.data),n.domainRef(t,e.field)});return Vb(t.add(CD({values:a})))}function B_(e,t,n){var a=n.map(function(e){var n=t.getData(e.data);return n||D_(e.data),n.extentRef(t,e.field)});return Vb(t.add(ED({extents:a})))}function Y_(e,t){t.interpolate=P_(e.type||e),null!=e.gamma&&(t.interpolateGamma=P_(e.gamma))}function G_(e,t,n){var a=e.range,i=t.config.range;if(a.signal)return t.signalRef(a.signal);if(I(a)){if(i&&i.hasOwnProperty(a))return e=Z({},e,{range:i[a]}),G_(e,t,n);'width'===a?a=[0,{signal:'width'}]:'height'===a?a=R_(e.type)?[0,{signal:'height'}]:[{signal:'height'},0]:F('Unrecognized scale range value: '+Y(a))}else{if(a.scheme)return n.scheme=P_(a.scheme,t),a.extent&&(n.schemeExtent=M_(a.extent,t)),void(a.count&&(n.schemeCount=P_(a.count,t)));if(a.step)return void(n.rangeStep=P_(a.step,t));if(R_(e.type)&&!fv(a))return L_(a,e,t);fv(a)||F('Unsupported range type: '+Y(a))}return a.map(function(e){return P_(e,t)})}function W_(e,t){e=I(e)?{text:e}:e;var n=t.config.title,a=Z({},e.encode),i,d,r;return i={orient:null==e.orient?n.orient:e.orient},d=Vb(t.add(mD(null,[i]))),a.name=e.name,a.interactive=e.interactive,r=H_(e,n,a,d),e.zindex&&(r.zindex=e.zindex),S_(r,t)}function H_(e,t,n,a){var i=e.text,d=e.orient||t.orient,r=e.anchor||t.anchor,o=d===QM||d===KM?-1:1,l=d===KM||d===tD,s={group:l?'width':'height'},f={},c,p,u,g,h,m;return f.enter=c={opacity:{value:0}},Ob(c,'fill',t.color),Ob(c,'font',t.font),Ob(c,'fontSize',t.fontSize),Ob(c,'fontWeight',t.fontWeight),f.exit={opacity:{value:0}},f.update=p={opacity:{value:1},text:N(i)?i:{value:i+''},offset:Ab(e.offset||0)},'start'===r?(h=0,m='left'):'end'===r?(h=1,m='right'):(h=0.5,m='center'),u={field:s,mult:h},g=0>o?{value:0}:l?{field:{group:'height'}}:{field:{group:'width'}},l?(p.x=u,p.y=g,p.angle={value:0},p.baseline={value:d===KM?'bottom':'top'}):(p.x=g,p.y=u,p.angle={value:90*o},p.baseline={value:'bottom'}),p.align={value:m},p.limit={field:s},Ob(p,'angle',t.angle),Ob(p,'baseline',t.baseline),Ob(p,'limit',t.limit),qb(ZM,GM,null,a,f,n)}function X_(e,t){var n=[];e.transform&&e.transform.forEach(function(e){n.push(a_(e,t))}),e.on&&e.on.forEach(function(n){w_(n,t,e.name)}),t.addDataPipeline(e.name,V_(e,t,n))}function V_(e,a,d){var r=[],o=null,l=!1,s=!1,f,c,i,n,t;for(e.values?r.push(o=J_({$ingest:e.values,$format:e.format})):e.url?r.push(o=J_({$request:e.url,$format:e.format})):e.source&&(f=a.getData(e.source),o=f.output,r.push(null)),c=0,i=d.length;c<i;++c)n=d[c],t=n.metadata,o||t.source||r.push(o=J_()),r.push(n),t.generates&&(s=!0),t.modifies&&!s&&(l=!0),t.source?o=n:t.changes&&(o=null);return f&&(r[0]=OD({derive:l,pulse:Vb(f.output)}),l&&r.splice(1,0,J_())),o||r.push(J_()),r.push(DD({})),r}function J_(e){var t=mD({},e);return t.metadata={source:!0},t}function Z_(e,t){var n=t.config,a=e.orient,i=a===KM||a===tD?n.axisX:n.axisY,d=n['axis'+a[0].toUpperCase()+a.slice(1)],r='band'===t.scaleType(e.scale)&&n.axisBand;return i||d||r?Z({},n.axis,i,d,r):n.axis}function K_(e,t,n,a){var i=e.orient,d={value:0},r={},o,l,s,f,c;return r.enter=o={opacity:d},Ob(o,'stroke',t.tickColor),Ob(o,'strokeWidth',t.tickWidth),r.exit={opacity:d},r.update=l={opacity:{value:1}},i===KM||i===tD?(s='x',c='y'):(s='y',c='x'),f=s+'2',o[c]=d,l[s]=o[s]=Q_(e,0),l[f]=o[f]=Q_(e,1),qb(VM,DM,null,a,r,n)}function Q_(e,t){return{scale:e.scale,range:t}}function ex(e,t,n,a){var i=e.orient,d=e.gridScale,r=i===QM||i===KM?1:-1,o=r*e.offset||0,l={value:0},f={},c,p,g,h,m,u,y,b;return f.enter=c={opacity:l},Ob(c,'stroke',t.gridColor),Ob(c,'strokeWidth',t.gridWidth),Ob(c,'strokeDash',t.gridDash),f.exit=p={opacity:l},f.update=g={},Ob(g,'opacity',t.gridOpacity),h={scale:e.scale,field:lD,band:t.bandPosition,round:t.tickRound,extra:t.tickExtra},i===KM||i===tD?(m='x',u='y',b='height'):(m='y',u='x',b='width'),y=u+'2',g[m]=c[m]=p[m]=h,d?(c[u]={scale:d,range:0,mult:r,offset:o},g[y]=c[y]={scale:d,range:1,mult:r,offset:o}):(c[u]={value:o},g[y]=c[y]={signal:b,mult:r,offset:o}),qb(VM,LM,lD,a,f,n)}function tx(e,t,n,a,i){var d=e.orient,r=d===QM||d===KM?-1:1,o={value:0},l={},s,f,c,p,u;return l.enter=s={opacity:o},Ob(s,'stroke',t.tickColor),Ob(s,'strokeWidth',t.tickWidth),l.exit=f={opacity:o},l.update=c={opacity:{value:1}},p=Ab(i),p.mult=r,u={scale:e.scale,field:lD,band:t.bandPosition,round:t.tickRound,extra:t.tickExtra},d===KM||d===tD?(c.y=s.y=o,c.y2=s.y2=p,c.x=s.x=f.x=u):(c.x=s.x=o,c.x2=s.x2=p,c.y=s.y=f.y=u),qb(VM,UM,lD,a,l,n)}function nx(e,t,n,a,i){var d=e.orient,r=d===QM||d===KM?-1:1,o=null==e.labelPadding?t.labelPadding:e.labelPadding,l={value:0},s={},f,c,p,u,g;return s.enter=f={opacity:l},Ob(f,'angle',t.labelAngle),Ob(f,'fill',t.labelColor),Ob(f,'font',t.labelFont),Ob(f,'fontSize',t.labelFontSize),Ob(f,'limit',t.labelLimit),s.exit=c={opacity:l},s.update=p={opacity:{value:1},text:{field:aD}},u=Ab(i),u.mult=r,u.offset=Ab(o),u.offset.mult=r,g={scale:e.scale,field:lD,band:0.5},d===KM||d===tD?(p.y=f.y=u,p.x=f.x=c.x=g,Ob(p,'align','center'),Ob(p,'baseline',d===KM?'bottom':'top')):(p.x=f.x=u,p.y=f.y=c.y=g,Ob(p,'align',d===eD?'left':'right'),Ob(p,'baseline','middle')),qb(ZM,qM,lD,a,s,n)}function ax(e,t,n,a){var i=e.orient,d=e.title,r=i===QM||i===KM?-1:1,o=i===KM||i===tD,l={},s,f,c;return l.enter=s={opacity:{value:0}},Ob(s,'align',t.titleAlign),Ob(s,'fill',t.titleColor),Ob(s,'font',t.titleFont),Ob(s,'fontSize',t.titleFontSize),Ob(s,'fontWeight',t.titleFontWeight),Ob(s,'limit',t.titleLimit),l.exit={opacity:{value:0}},l.update=f={opacity:{value:1},text:d&&d.signal?{signal:d.signal}:{value:d+''}},c={scale:e.scale,range:0.5},o?(f.x=c,f.angle={value:0},f.baseline={value:i===KM?'bottom':'top'}):(f.y=c,f.angle={value:90*r},f.baseline={value:'bottom'}),Ob(f,'angle',t.titleAngle),Ob(f,'baseline',t.titleBaseline),Ob(f,'x',t.titleX)||!o||Lb(n,'x')||(l.enter.auto={value:!0}),Ob(f,'y',t.titleY)||o||Lb(n,'y')||(l.enter.auto={value:!0}),qb(ZM,FM,null,a,l,n)}function ix(e,t){var n=Z_(e,t),a=e.name||void 0,i=e.encode||{},d=!!e.interactive,r,o,l,s,f,c,p;return r={orient:e.orient,ticks:null==e.ticks?n.ticks:!!e.ticks,labels:null==e.labels?n.labels:!!e.labels,grid:null==e.grid?n.grid:!!e.grid,domain:null==e.domain?n.domain:!!e.domain,title:null!=e.title},o=Vb(t.add(mD({},[r]))),c=Pb({update:{range:{signal:'abs(span(range("'+e.scale+'")))'},offset:Ab(e.offset||0),position:Ab(e.position||0),titlePadding:Ab(e.titlePadding||n.titlePadding),minExtent:Ab(e.minExtent||n.minExtent),maxExtent:Ab(e.maxExtent||n.maxExtent)}},i.axis),l=Vb(t.add(gD({scale:t.scaleRef(e.scale),extra:n.tickExtra,count:t.property(e.tickCount),values:t.property(e.values),formatSpecifier:t.property(e.format)}))),p=[],r.grid&&p.push(ex(e,n,i.grid,l)),r.ticks&&(s=null==e.tickSize?n.tickSize:e.tickSize,p.push(tx(e,n,i.ticks,l,s))),r.labels&&(s=r.ticks?s:0,p.push(nx(e,n,i.labels,l,s))),r.domain&&p.push(K_(e,n,i.domain,o)),r.title&&p.push(ax(e,n,i.title,o)),f=Ib(MM,a,o,d,c,p),e.zindex&&(f.zindex=e.zindex),S_(f,t)}function dx(e,t,n){var a=H(e.signals);return n||a.forEach(function(e){ym(e,t)}),H(e.projections).forEach(function(e){gb(e,t)}),H(e.data).forEach(function(e){X_(e,t)}),H(e.scales).forEach(function(e){O_(e,t)}),a.forEach(function(e){ub(e,t)}),H(e.axes).forEach(function(e){ix(e,t)}),H(e.marks).forEach(function(e){S_(e,t)}),H(e.legends).forEach(function(e){E_(e,t)}),e.title&&W_(e.title,t),(t.parseLambdas(),t)}function rx(e,t){var n=t.config,a,i,d,r,o;return t.background=e.background||n.background,o=Vb(t.root=t.add(Xb())),t.addSignal('width',e.width||-1),t.addSignal('height',e.height||-1),t.addSignal('padding',hm(e.padding,n)),H(e.signals).forEach(function(e){GD[e.name]||ym(e,t)}),i=t.add(mD()),d=Pb({enter:{x:{value:0},y:{value:0}},update:{width:{signal:'width'},height:{signal:'height'}}},e.encode),d=t.add(_D(Mb(d,HM,OM,t,{pulse:Vb(i)}))),r=t.add(qD({layout:t.objectProperty(e.layout),legendMargin:n.legendMargin,autosize:gm(e.autosize,n),mark:o,pulse:Vb(d)})),t.operators.pop(),t.pushState(Vb(d),Vb(r),null),dx(e,t,!0),t.operators.push(r),a=t.add(hD({mark:o,pulse:Vb(r)})),a=t.add(PD({pulse:Vb(a)})),a=t.add(DD({pulse:Vb(a)})),t.addData('root',new y_(t,i,i,a)),t}function ox(e){this.config=e,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.background=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function lx(e){this.config=e.config,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function sx(e){var t='{',n=0,a,i;for(a in e)i=e[a],t+=(1<++n?',':'')+Y(a)+':'+(N(i)?i.signal||sx(i):Y(i));return t+'}'}function fx(e){var t=cx(),n;for(n in e)t[n]=N(t[n])?Z(t[n],e[n]):t[n]=e[n];return t}function cx(){return{padding:0,autosize:'pad',background:null,group:null,mark:null,arc:{fill:VD},area:{fill:VD},image:null,line:{stroke:VD,strokeWidth:XD},path:{stroke:VD},rect:{fill:VD},rule:{stroke:JD},shape:{stroke:VD},symbol:{fill:VD,size:64},text:{fill:JD,font:'sans-serif',fontSize:11},point:{size:HD,strokeWidth:XD,shape:'circle'},circle:{size:HD,strokeWidth:XD},square:{size:HD,strokeWidth:XD},axis:{minExtent:0,maxExtent:200,bandPosition:0.5,domain:!0,domainWidth:1,domainColor:JD,grid:!1,gridWidth:1,gridColor:KD,gridDash:[],gridOpacity:1,labels:!0,labelAngle:0,labelColor:JD,labelFont:'sans-serif',labelFontSize:10,labelPadding:2,labelLimit:180,ticks:!0,tickRound:!0,tickSize:5,tickWidth:1,tickColor:JD,titleAlign:'center',titlePadding:2,titleColor:JD,titleFont:'sans-serif',titleFontSize:11,titleFontWeight:'bold'},legend:{orient:'right',offset:18,padding:0,entryPadding:5,titlePadding:5,gradientWidth:100,gradientHeight:20,gradientStrokeColor:KD,gradientStrokeWidth:0,gradientLabelBaseline:'top',gradientLabelOffset:2,labelColor:JD,labelFontSize:10,labelFont:'sans-serif',labelAlign:'left',labelBaseline:'middle',labelOffset:8,labelLimit:160,symbolType:'circle',symbolSize:100,symbolColor:ZD,symbolStrokeWidth:1.5,titleColor:JD,titleFont:'sans-serif',titleFontSize:11,titleFontWeight:'bold',titleAlign:'left',titleBaseline:'top',titleLimit:180},title:{orient:'top',anchor:'middle',offset:2,color:JD,font:'sans-serif',fontSize:13,fontWeight:'bold'},range:{category:{scheme:'tableau10'},ordinal:{scheme:'blues',extent:[0.2,1]},heatmap:{scheme:'viridis'},ramp:{scheme:'blues',extent:[0.2,1]},diverging:{scheme:'blueorange'},symbol:['circle','square','triangle-up','cross','diamond','triangle-right','triangle-down','triangle-left']}}}function px(e,t,n){';'!==t[t.length-1]&&(t='return('+t+');');var a=Function.apply(null,e.concat(t));return n&&n.functions?a.bind(n.functions):a}function ux(e,t){return px(['_'],e,t)}function gx(e,t){return px(['datum','_'],e,t)}function hx(e,t){return px(['event'],e,t)}function mx(e,t){return px(['_','event'],e,t)}function yx(e,t){return px(['item','_'],e,t)}function bx(e,t,n){n=n||{};var a,i;for(a in e)i=e[a],i&&i.$expr&&i.$params&&bx(i.$params,t,n),n[a]=fv(i)?i.map(function(e){return _x(e,t)}):_x(i,t);return n}function _x(e,t){if(!e||!N(e))return e;for(var a=0,i=QD.length,n;a<i;++a)if(n=QD[a],e.hasOwnProperty(n.key))return n.parse(e,t);return e}function xx(e,t){'Operator'!==e.type&&e.type?t.transform(e,e.type):t.operator(e,e.update?ux(e.update,t):null)}function vx(e,t){var n,a;e.params&&(!(n=t.get(e.id))&&F('Invalid operator id: '+e.id),a=bx(e.params,t),t.dataflow.connect(n,n.parameters(a)))}function wx(e,t){var n=null==e.filter?void 0:hx(e.filter,t),a=null==e.stream?void 0:t.get(e.stream),i;e.source?a=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(t.get.bind(t)),a=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(t.get.bind(t)),a=a.between(i[0],i[1])),e.filter&&(a=a.filter(n)),null!=e.throttle&&(a=a.throttle(+e.throttle)),null!=e.debounce&&(a=a.debounce(+e.debounce)),null==a&&F('Invalid stream definition: '+JSON.stringify(e)),e.consume&&a.consume(!0),t.stream(e,a)}function Sx(e,t){var n=t.get(e.source),a=null,i=e.update,d;n||F('Source not defined: '+e.source),a=e.target&&e.target.$expr?hx(e.target.$expr,t):t.get(e.target),i&&i.$expr&&(i.$params&&(d=bx(i.$params,t)),i=mx(i.$expr,t)),t.update(e,n,a,i,d)}function Ex(e,t){var n=e.operators||[];return e.background&&(t.background=e.background),n.forEach(function(e){xx(e,t)}),n.forEach(function(e){vx(e,t)}),(e.streams||[]).forEach(function(e){wx(e,t)}),(e.updates||[]).forEach(function(e){Sx(e,t)}),t.resolve()}function Cx(e,t,n){return new zx(e,t,n)}function zx(e,t,n){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Tx(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.functions=e.functions,this.events=e.events,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function Rx(e,t,n){return Ex(t,Cx(e,TS,n||iM))}function Ax(e,t){var n=e.add(null,function(n){e['_'+t]=n.size,e._autosize=e._resize=1},{size:e._signals[t]});return n.rank=0,n}function Ox(e,t){return t.modified&&fv(t.input.value)&&e.indexOf('_:vega:_')}function Px(e,t){return!('parent'===e||t instanceof TS.Proxy)}function Mx(e,t){t=t||{},Ud.call(this),this.loader(t.loader||this._loader),this.logLevel(t.logLevel||0),this._el=null,this._renderType=t.renderer||eS.Canvas,this._scenegraph=new Mi;var n=this._scenegraph.root;this._renderer=null,this._queue=null,this._handler=new Fi().scene(n),this._eventListeners=[],this._preventDefault=!0;var a=Rx(this,e,t.functions);this._runtime=a,this._signals=a.signals,this._bind=(e.bindings||[]).map(function(e){return{state:null,param:Z({},e)}}),a.root&&a.root.set(n),n.source=a.data.root.input,this.pulse(a.data.root.input,this.changeset().insert(n.items)),this._background=a.background||null,this._width=this.width(),this._height=this.height(),this._origin=[0,0],this._resize=0,this._autosize=1,this._resizeWidth=Ax(this,'width'),this._resizeHeight=Ax(this,'height'),Nh(this)}function Dx(e,t){return e._signals.hasOwnProperty(t)?e._signals[t]:e.error('Unrecognized signal name: '+Y(t))}var Lx=String.fromCharCode,qx=Math.E,Ux=Math.atan,Fx=Math.asin,jx=Math.atan2,$x=Math.tan,Nx=Math.acos,Ix=Math.sin,Bx=Math.cos,Yx=Math.SQRT2,Gx=Math.PI,Wx=Math.exp,Hx=Math.sqrt,Xx=Math.LN2,Vx=Math.abs,Jx=Math.LN10,Zx=Math.min,Kx=Math.floor,Qx=Math.pow,ev=Math.round,tv=Math.ceil,nv=Math.max,av=Math.log,iv=n(o),dv=iv.right,rv=iv.left,ov=7.0710678118654755,lv=3.1622776601683795,sv=1.4142135623730951,fv=Array.isArray,cv=[],pv=$('id'),id=L(function(e){return e},cv,'identity'),uv=L(function(){return 0},cv,'zero'),gv=L(function(){return 1},cv,'one'),hv=L(function(){return!0},cv,'true'),mv=L(function(){return!1},cv,'false'),yv=0,bv=1,_v=2,xv=3,vv={},kv='$';be.prototype=_e.prototype={constructor:be,has:function(e){return kv+e in this},get:function(e){return this[kv+e]},set:function(e,t){return this[kv+e]=t,this},remove:function(e){var t=kv+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===kv&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===kv&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===kv&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===kv&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===kv&&++e;return e},empty:function(){for(var e in this)if(e[0]===kv)return!1;return!0},each:function(e){for(var t in this)t[0]===kv&&e(this[t],t.slice(1),this)}};var wv=_e.prototype,Sv={value:function(){}};Ce.prototype=Ee.prototype={constructor:Ce,on:function(e,a){var d=this._,r=ze(e+'',d),o=-1,i=r.length,n;if(2>arguments.length){for(;++o<i;)if((n=(e=r[o]).type)&&(n=Te(d[n],e.name)))return n;return}if(null!=a&&'function'!==typeof a)throw new Error('invalid callback: '+a);for(;++o<i;)if(n=(e=r[o]).type)d[n]=Re(d[n],e.name,a);else if(null==a)for(n in d)d[n]=Re(d[n],e.name,null);return this},copy:function(){var e={},n=this._;for(var a in n)e[a]=n[a].slice();return new Ce(e)},call:function(e,a){if(0<(i=arguments.length-2))for(var d=Array(i),r=0,i,n;r<i;++r)d[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error('unknown type: '+e);for(n=this._[e],r=0,i=n.length;r<i;++r)n[r].value.apply(a,d)},apply:function(e,a,d){if(!this._.hasOwnProperty(e))throw new Error('unknown type: '+e);for(var r=this._[e],t=0,i=r.length;t<i;++t)r[t].value.apply(a,d)}};var Ev=qe(','),Cv=qe('\t'),zv=/^([A-Za-z]+:)?\/\//,Tv='file://',Rv=['mimeType','responseType','user','password'],Av={boolean:ce,integer:ue,number:ue,date:pe,string:ge},Ov=[function(e){return'true'===e||'false'===e||!0===e||!1===e},function(e){return Xe(e)&&(e=+e)===~~e},Xe,function(e){return!isNaN(Date.parse(e))}],Pv=['boolean','integer','number','date'],Mv={dsv:Je,csv:Ve(','),tsv:Ve('\t'),json:Ke,topojson:function(e,t){var n,a;return(e=Ke(e,t),t&&(a=t.feature))?(n=e.objects[a])?at(e,n).features:F('Invalid TopoJSON object: '+a):t&&(a=t.mesh)?(n=e.objects[a])?[ot(e,n)]:F('Invalid TopoJSON object: '+a):void F('Missing TopoJSON feature or mesh parameter.')}},Dv=new Date,Lv=new Date,qv=ft(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});qv.every=function(e){return e=Kx(e),isFinite(e)&&0<e?1<e?ft(function(t){t.setTime(Kx(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):qv:null};var Uv=1e3,Fv=6e4,jv=36e5,$v=864e5,Nv=6048e5,Iv=ft(function(e){e.setTime(Kx(e/Uv)*Uv)},function(e,t){e.setTime(+e+t*Uv)},function(e,t){return(t-e)/Uv},function(e){return e.getUTCSeconds()}),Bv=ft(function(e){e.setTime(Kx(e/Fv)*Fv)},function(e,t){e.setTime(+e+t*Fv)},function(e,t){return(t-e)/Fv},function(e){return e.getMinutes()}),Yv=ft(function(e){var t=e.getTimezoneOffset()*Fv%jv;0>t&&(t+=jv),e.setTime(Kx((+e-t)/jv)*jv+t)},function(e,t){e.setTime(+e+t*jv)},function(e,t){return(t-e)/jv},function(e){return e.getHours()}),Gv=ft(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fv)/$v},function(e){return e.getDate()-1}),Wv=ct(0),Hv=ct(1),Xv=ft(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),Vv=ft(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Vv.every=function(e){return isFinite(e=Kx(e))&&0<e?ft(function(t){t.setFullYear(Kx(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var Jv=ft(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Fv)},function(e,t){return(t-e)/Fv},function(e){return e.getUTCMinutes()}),Zv=ft(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*jv)},function(e,t){return(t-e)/jv},function(e){return e.getUTCHours()}),Kv=ft(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/$v},function(e){return e.getUTCDate()-1}),Qv=pt(0),ek=pt(1),tk=ft(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),nk=ft(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});nk.every=function(e){return isFinite(e=Kx(e))&&0<e?ft(function(t){t.setUTCFullYear(Kx(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var ak={0:'0',"-":'',_:' '},ik=/^\s*\d+/,dk=/^%/,rk=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ok,lk,sk,fk,ck;cn({dateTime:'%x, %X',date:'%-m/%-d/%Y',time:'%-I:%M:%S %p',periods:['AM','PM'],days:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],shortDays:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],months:['January','February','March','April','May','June','July','August','September','October','November','December'],shortMonths:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']});var pk='%Y-%m-%dT%H:%M:%S.%LZ',uk=Date.prototype.toISOString?function(e){return e.toISOString()}:fk(pk),gk=+new Date('2000-01-01T00:00:00.000Z')?function(e){var t=new Date(e);return isNaN(t)?null:t}:ck(pk),hk=gn.prototype;hk.clone=function(){return new gn(this)},hk.clear=function(){var e=Number.MAX_VALUE;return this.x1=+e,this.y1=+e,this.x2=-e,this.y2=-e,this},hk.set=function(e,t,n,a){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),a<t?(this.y2=t,this.y1=a):(this.y1=t,this.y2=a),this},hk.add=function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},hk.expand=function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},hk.round=function(){return this.x1=Kx(this.x1),this.y1=Kx(this.y1),this.x2=tv(this.x2),this.y2=tv(this.y2),this},hk.translate=function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},hk.rotate=function(e,t,n){var a=Bx(e),i=Ix(e),d=t-t*a+n*i,r=n-t*i-n*a,o=this.x1,l=this.x2,s=this.y1,f=this.y2;return this.clear().add(a*o-i*s+d,i*o+a*s+r).add(a*o-i*f+d,i*o+a*f+r).add(a*l-i*s+d,i*l+a*s+r).add(a*l-i*f+d,i*l+a*f+r)},hk.union=function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},hk.intersect=function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},hk.encloses=function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},hk.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},hk.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},hk.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},hk.width=function(){return this.x2-this.x1},hk.height=function(){return this.y2-this.y1};var mk=0;ee(yn,mn);var yk;try{yk=require('canvas')}catch(t){yk=null}var bk='undefined'===typeof Image?yk&&yk.Image||null:Image,_k=Sn.prototype;_k.pending=function(){return this._pending},_k.sanitizeURL=function(e){var t=this;return En(t),t._loader.sanitize(e,{context:'href'}).then(function(e){return Cn(t),e}).catch(function(){return Cn(t),null})},_k.loadImage=function(e){var t=this;return En(t),t._loader.sanitize(e,{context:'image'}).then(function(e){var n=e.href;if(!n||!bk)throw'Image unsupported.';var a=new bk;return a.onload=function(){Cn(t),a.loaded=!0},a.onerror=function(){Cn(t),a.loaded=!1},a.src=n,a}).catch(function(){return Cn(t),{loaded:!1,width:0,height:0}})},_k.ready=function(){var e=this;return new Promise(function(t){function n(a){e.pending()?setTimeout(function(){n(!0)},10):t(a)}n(!1)})};var xk=Gx,pi=2*xk,vk=1e-6;zn.prototype=Tn.prototype={constructor:zn,moveTo:function(e,t){this._+='M'+(this._x0=this._x1=+e)+','+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+='Z')},lineTo:function(e,t){this._+='L'+(this._x1=+e)+','+(this._y1=+t)},quadraticCurveTo:function(e,t,n,a){this._+='Q'+ +e+','+ +t+','+(this._x1=+n)+','+(this._y1=+a)},bezierCurveTo:function(e,t,n,a,i,d){this._+='C'+ +e+','+ +t+','+ +n+','+ +a+','+(this._x1=+i)+','+(this._y1=+d)},arcTo:function(e,t,n,a,i){e=+e,t=+t,n=+n,a=+a,i=+i;var d=this._x1,o=this._y1,s=n-e,f=a-t,c=d-e,p=o-t,u=c*c+p*p;if(0>i)throw new Error('negative radius: '+i);if(null===this._x1)this._+='M'+(this._x1=e)+','+(this._y1=t);else if(!(u>vk));else if(!(Vx(p*s-f*c)>vk)||!i)this._+='L'+(this._x1=e)+','+(this._y1=t);else{var g=n-d,h=a-o,m=s*s+f*f,y=Hx(m),b=Hx(u),_=i*$x((xk-Nx((m+u-(g*g+h*h))/(2*y*b)))/2),l=_/b,x=_/y;Vx(l-1)>vk&&(this._+='L'+(e+l*c)+','+(t+l*p)),this._+='A'+i+','+i+',0,0,'+ +(p*g>c*h)+','+(this._x1=e+x*s)+','+(this._y1=t+x*f)}},arc:function(e,t,n,a,i,d){e=+e,t=+t,n=+n;var o=n*Bx(a),l=n*Ix(a),s=e+o,f=t+l,c=1^d,p=d?a-i:i-a;if(0>n)throw new Error('negative radius: '+n);null===this._x1?this._+='M'+s+','+f:(Vx(this._x1-s)>vk||Vx(this._y1-f)>vk)&&(this._+='L'+s+','+f);n&&(0>p&&(p=p%pi+pi),p>pi-vk?this._+='A'+n+','+n+',0,1,'+c+','+(e-o)+','+(t-l)+'A'+n+','+n+',0,1,'+c+','+(this._x1=s)+','+(this._y1=f):p>vk&&(this._+='A'+n+','+n+',0,'+ +(p>=xk)+','+c+','+(this._x1=e+n*Bx(i))+','+(this._y1=t+n*Ix(i))))},rect:function(e,t,n,a){this._+='M'+(this._x0=this._x1=+e)+','+(this._y0=this._y1=+t)+'h'+ +n+'v'+ +a+'h'+-n+'Z'},toString:function(){return this._}};var kk=Vx,wk=jx,Sk=Bx,Ek=nv,Ck=Zx,zk=Ix,Tk=Hx,Rk=1e-12,Ak=Gx,Ok=Ak/2,Pk=2*Ak;jn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);}}};var Mk={draw:function(e,t){var n=Hx(t/Ak);e.moveTo(n,0),e.arc(0,0,n,0,Pk)}},Dk=Ix(Ak/10)/Ix(7*Ak/10),kr=Ix(Pk/10)*Dk,kx=-Bx(Pk/10)*Dk;Vn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Hn(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Hn(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Jn.prototype={areaStart:Wn,areaEnd:Wn,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Hn(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Qn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:Hn(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ea.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,n=this._y,a=e.length-1;if(0<a)for(var d=e[0],r=n[0],o=e[a]-d,l=n[a]-r,s=-1,i;++s<=a;)i=s/a,this._basis.point(this._beta*e[s]+(1-this._beta)*(d+i*o),this._beta*n[s]+(1-this._beta)*(r+i*l));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var ky=function e(t){function n(e){return 1===t?new Vn(e):new ea(e,t)}return n.beta=function(t){return e(+t)},n}(0.85);na.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ta(this,this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:ta(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Lk=function e(t){function n(e){return new na(e,t)}return n.tension=function(t){return e(+t)},n}(0);aa.prototype={areaStart:Wn,areaEnd:Wn,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ta(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var qk=function e(t){function n(e){return new aa(e,t)}return n.tension=function(t){return e(+t)},n}(0);ia.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ta(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Uk=function e(t){function n(e){return new ia(e,t)}return n.tension=function(t){return e(+t)},n}(0);ra.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Hx(this._l23_2a=Qx(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:da(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Fk=function e(t){function n(e){return t?new ra(e,t):new na(e,0)}return n.alpha=function(t){return e(+t)},n}(0.5);oa.prototype={areaStart:Wn,areaEnd:Wn,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Hx(this._l23_2a=Qx(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:da(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var jk=function e(t){function n(e){return t?new oa(e,t):new aa(e,0)}return n.alpha=function(t){return e(+t)},n}(0.5);la.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Hx(this._l23_2a=Qx(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:da(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var $k=function e(t){function n(e){return t?new la(e,t):new ia(e,0)}return n.alpha=function(t){return e(+t)},n}(0.5);sa.prototype={areaStart:Wn,areaEnd:Wn,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},ga.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ua(this,this._t0,pa(this,this._t0));}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,e!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ua(this,pa(this,n=ca(this,e,t)),n);break;default:ua(this,this._t0,n=ca(this,e,t));}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(ha.prototype=Object.create(ga.prototype)).point=function(e,t){ga.prototype.point.call(this,t,e)},ma.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,i,d){this._context.bezierCurveTo(t,e,a,n,d,i)}},ya.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===a)this._context.lineTo(e[1],t[1]);else for(var n=ba(e),i=ba(t),d=0,r=1;r<a;++d,++r)this._context.bezierCurveTo(n[0][d],i[0][d],n[1][d],i[1][d],e[r],t[r]);(this._line||0!==this._line&&1===a)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},_a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&1>this._t&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(0>=this._t)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};var Nk={basis:{curve:function(e){return new Vn(e)}},"basis-closed":{curve:function(e){return new Jn(e)}},"basis-open":{curve:function(e){return new Qn(e)}},bundle:{curve:ky,tension:'beta',value:0.85},cardinal:{curve:Lk,tension:'tension',value:0},"cardinal-open":{curve:Uk,tension:'tension',value:0},"cardinal-closed":{curve:qk,tension:'tension',value:0},"catmull-rom":{curve:Fk,tension:'alpha',value:0.5},"catmull-rom-closed":{curve:jk,tension:'alpha',value:0.5},"catmull-rom-open":{curve:$k,tension:'alpha',value:0.5},linear:{curve:$n},"linear-closed":{curve:function(e){return new sa(e)}},monotone:{horizontal:function(e){return new ha(e)},vertical:function(e){return new ga(e)}},natural:{curve:function(e){return new ya(e)}},step:{curve:function(e){return new _a(e,0.5)}},"step-after":{curve:function(e){return new _a(e,1)}},"step-before":{curve:function(e){return new _a(e,0)}}},Ik={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Bk=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/],Yk={},Gk={},Wk=[].join,Hk=['l',0,0,0,0,0,0,0],Xk=1.7320508075688772/2,Vk={circle:{draw:function(e,t){var n=Hx(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,2*Gx)}},cross:{draw:function(e,t){var n=Hx(t)/2,a=n/2.5;e.moveTo(-n,-a),e.lineTo(-n,a),e.lineTo(-a,a),e.lineTo(-a,n),e.lineTo(a,n),e.lineTo(a,a),e.lineTo(n,a),e.lineTo(n,-a),e.lineTo(a,-a),e.lineTo(a,-n),e.lineTo(-a,-n),e.lineTo(-a,-a),e.closePath()}},diamond:{draw:function(e,t){var n=Hx(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Hx(t),a=-n/2;e.rect(a,a,n,n)}},"triangle-up":{draw:function(e,t){var n=Hx(t)/2,a=Xk*n;e.moveTo(0,-a),e.lineTo(-n,a),e.lineTo(n,a),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Hx(t)/2,a=Xk*n;e.moveTo(0,a),e.lineTo(-n,-a),e.lineTo(n,-a),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Hx(t)/2,a=Xk*n;e.moveTo(a,0),e.lineTo(-a,-n),e.lineTo(-a,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Hx(t)/2,a=Xk*n;e.moveTo(-a,0),e.lineTo(a,-n),e.lineTo(a,n),e.closePath()}}},Jk={},Zk=Gx,Kk=function(){function e(){var e=+t.apply(this,arguments),s=+n.apply(this,arguments),f=d.apply(this,arguments)-Ok,c=o.apply(this,arguments)-Ok,p=kk(c-f),u=c>f,g,h;if(l||(l=g=Tn()),s<e&&(h=s,s=e,e=h),!(s>Rk))l.moveTo(0,0);else if(p>Pk-Rk)l.moveTo(s*Sk(f),s*zk(f)),l.arc(0,0,s,f,c,!u),e>Rk&&(l.moveTo(e*Sk(c),e*zk(c)),l.arc(0,0,e,c,f,u));else{var m=f,y=c,b=f,_=c,x=p,v=p,k=r.apply(this,arguments)/2,w=k>Rk&&(i?+i.apply(this,arguments):Tk(e*e+s*s)),S=Ck(kk(s-e)/2,+a.apply(this,arguments)),E=S,C=S,z,T;if(w>Rk){var R=On(w/e*zk(k)),A=On(w/s*zk(k));(x-=2*R)>Rk?(R*=u?1:-1,b+=R,_-=R):(x=0,b=_=(f+c)/2),(v-=2*A)>Rk?(A*=u?1:-1,m+=A,y-=A):(v=0,m=y=(f+c)/2)}var O=s*Sk(m),P=s*zk(m),M=e*Sk(_),D=e*zk(_);if(S>Rk){var L=s*Sk(y),q=s*zk(y),U=e*Sk(b),F=e*zk(b);if(p<Ak){var j=x>Rk?Un(O,P,U,F,L,q,M,D):[M,D],$=O-j[0],N=P-j[1],I=L-j[0],B=q-j[1],Y=1/zk(An(($*I+N*B)/(Tk($*$+N*N)*Tk(I*I+B*B)))/2),G=Tk(j[0]*j[0]+j[1]*j[1]);E=Ck(S,(e-G)/(Y-1)),C=Ck(S,(s-G)/(Y+1))}}v>Rk?C>Rk?(z=Fn(U,F,O,P,s,C,u),T=Fn(L,q,M,D,s,C,u),l.moveTo(z.cx+z.x01,z.cy+z.y01),C<S?l.arc(z.cx,z.cy,C,wk(z.y01,z.x01),wk(T.y01,T.x01),!u):(l.arc(z.cx,z.cy,C,wk(z.y01,z.x01),wk(z.y11,z.x11),!u),l.arc(0,0,s,wk(z.cy+z.y11,z.cx+z.x11),wk(T.cy+T.y11,T.cx+T.x11),!u),l.arc(T.cx,T.cy,C,wk(T.y11,T.x11),wk(T.y01,T.x01),!u))):(l.moveTo(O,P),l.arc(0,0,s,m,y,!u)):l.moveTo(O,P),e>Rk&&x>Rk?E>Rk?(z=Fn(M,D,L,q,e,-E,u),T=Fn(O,P,U,F,e,-E,u),l.lineTo(z.cx+z.x01,z.cy+z.y01),E<S?l.arc(z.cx,z.cy,E,wk(z.y01,z.x01),wk(T.y01,T.x01),!u):(l.arc(z.cx,z.cy,E,wk(z.y01,z.x01),wk(z.y11,z.x11),!u),l.arc(0,0,e,wk(z.cy+z.y11,z.cx+z.x11),wk(T.cy+T.y11,T.cx+T.x11),u),l.arc(T.cx,T.cy,E,wk(T.y11,T.x11),wk(T.y01,T.x01),!u))):l.arc(0,0,e,_,b,u):l.lineTo(M,D)}return(l.closePath(),g)?(l=null,g+''||null):void 0}var t=Pn,n=Mn,a=Rn(0),i=null,d=Dn,o=Ln,r=qn,l=null;return e.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,i=(+d.apply(this,arguments)+ +o.apply(this,arguments))/2-Ak/2;return[Sk(i)*e,zk(i)*e]},e.innerRadius=function(n){return arguments.length?(t='function'===typeof n?n:Rn(+n),e):t},e.outerRadius=function(t){return arguments.length?(n='function'===typeof t?t:Rn(+t),e):n},e.cornerRadius=function(t){return arguments.length?(a='function'===typeof t?t:Rn(+t),e):a},e.padRadius=function(t){return arguments.length?(i=null==t?null:'function'===typeof t?t:Rn(+t),e):i},e.startAngle=function(t){return arguments.length?(d='function'===typeof t?t:Rn(+t),e):d},e.endAngle=function(t){return arguments.length?(o='function'===typeof t?t:Rn(+t),e):o},e.padAngle=function(t){return arguments.length?(r='function'===typeof t?t:Rn(+t),e):r},e.context=function(t){return arguments.length?(l=null==t?null:t,e):l},e}().cornerRadius(y).padAngle(function(e){return e.padAngle||0}),Qk=Gn().x(qa).y1(x).y0(function(e){return(e.y||0)+(e.height||0)}).defined(Ua),ew=Gn().y(x).x1(qa).x0(function(e){return(e.x||0)+(e.width||0)}).defined(Ua),tw=Bn().x(qa).y(x).defined(Ua),nw=Da().x(qa).y(x).width(function(e){return e.width||0}).height(function(e){return e.height||0}).cornerRadius(y),aw=function(){function e(){var e;if(a||(a=e=Tn()),t.apply(this,arguments).draw(a,+n.apply(this,arguments)),e)return a=null,e+''||null}var t=Rn(Mk),n=Rn(64),a=null;return e.type=function(n){return arguments.length?(t='function'===typeof n?n:Rn(n),e):t},e.size=function(t){return arguments.length?(n='function'===typeof t?t:Rn(+t),e):n},e.context=function(t){return arguments.length?(a=null==t?null:t,e):a},e}().type(function(e){return za(e.shape||'circle')}).size(Fa),iw=La().x(qa).y(x).defined(Ua).size(function(e){return e.size||1}),dw=2*Gx,rw=dw/4,ow;Na.beginPath=Ia,Na.closePath=Ia,Na.moveTo=Ba,Na.lineTo=Ba,Na.rect=function(e,t,n,a){Ba(e,t),Ba(e+n,t+a)},Na.quadraticCurveTo=function(e,t,n,a){Ba(e,t),Ba(n,a)},Na.bezierCurveTo=function(e,t,n,a,i,d){Ba(e,t),Ba(n,a),Ba(i,d)},Na.arc=function(e,t,n,a,d,r){function o(e){i=n*Bx(e),g=n*Ix(e),i<l&&(l=i),i>f&&(f=i),g<c&&(c=g),g>p&&(p=g)}if(Vx(d-a)>dw-1e-8)return Ba(e-n,t-n),void Ba(e+n,t+n);var l=Infinity,f=-Infinity,c=Infinity,p=-Infinity,u,s,i,g;if(o(a),o(d),d!==a)if(a%=dw,0>a&&(a+=dw),d%=dw,0>d&&(d+=dw),d<a&&(r=!r,u=a,a=d,d=u),r)for(d-=dw,u=a-a%rw,s=0;3>s&&u>d;++s,u-=rw)o(u);else for(u=a-a%rw+rw,s=0;3>s&&u<d;++s,u+=rw)o(u);Ba(e+l,t+c),Ba(e+f,t+p)};var sw=[],lw=function(){return!0},fw=ri('arc',function(e,t){return Kk.context(e)(t)}),pw=oi('area',function(e,t){var n=t[0],a=n.interpolate||'linear';return('horizontal'===n.orient?ew:Qk).curve(xa(a,n.orient,n.tension)).context(e)(t)}),uw={type:'image',tag:'image',nested:!1,attr:function(e,t,n){var i=fi(t,n),d=t.x||0,r=t.y||0,o=(null==t.width?i.width:t.width)||0,l=(null==t.height?i.height:t.height)||0,s=!1===t.aspect?'none':'xMidYMid';d-=ci(t.align,o),r-=ui(t.baseline,l),e('href',i.src||'','http://www.w3.org/1999/xlink','xlink:href'),e('transform',ii(d,r)),e('width',o),e('height',l),e('preserveAspectRatio',s)},bound:function(e,t){var n=t.image,a=t.x||0,i=t.y||0,d=(null==t.width?n&&n.width:t.width)||0,r=(null==t.height?n&&n.height:t.height)||0;return a-=ci(t.align,d),i-=ui(t.baseline,r),e.set(a,i,a+d,i+r)},draw:function(e,t,n){var a=this;Ja(t,function(i){if(!n||n.intersects(i.bounds)){var d=fi(i,a),r=i.x||0,o=i.y||0,l=(null==i.width?d.width:i.width)||0,s=(null==i.height?d.height:i.height)||0,f,c,p,u;r-=ci(i.align,l),o-=ui(i.baseline,s),!1!==i.aspect&&(c=d.width/d.height,p=i.width/i.height,c===c&&p===p&&c!==p&&(p<c?(u=l/c,o+=(s-u)/2,s=u):(u=s*c,r+=(l-u)/2,l=u))),d.loaded&&(e.globalAlpha=null==(f=i.opacity)?1:f,e.drawImage(d,r,o,l,s))}})},pick:ti(),get:fi,xOffset:ci,yOffset:ui},gw=oi('line',function(e,t){var n=t[0],a=n.interpolate||'linear';return tw.curve(xa(a,n.orient,n.tension)).context(e)(t)}),hw={type:'path',tag:'path',nested:!1,attr:function(e,t){e('transform',di(t)),e('d',t.path)},bound:function(e,t){return gi(Na(e),t)?e.set(0,0,0,0):$a(e,t)},draw:Ka(gi),pick:ai(gi)},mw={type:'rect',tag:'path',nested:!1,attr:function(e,t){e('d',ja(null,t))},bound:function(e,t){var n,a;return $a(e.set(n=t.x||0,a=t.y||0,n+t.width||0,a+t.height||0),t)},draw:Ka(hi),pick:ai(hi)},yw={type:'rule',tag:'line',nested:!1,attr:function(e,t){e('transform',di(t)),e('x2',null==t.x2?0:t.x2-(t.x||0)),e('y2',null==t.y2?0:t.y2-(t.y||0))},bound:function(e,t){var n,a;return $a(e.set(n=t.x||0,a=t.y||0,null==t.x2?n:t.x2,null==t.y2?a:t.y2),t)},draw:function(e,t,n){Ja(t,function(t){if(!n||n.intersects(t.bounds)){var a=null==t.opacity?1:t.opacity;a&&mi(e,t,a)&&e.stroke()}})},pick:ti(function(e,t,n,a){return!!e.isPointInStroke&&mi(e,t,1)&&e.isPointInStroke(n,a)})},bw=ri('shape',function(e,t){return(t.mark.shape||t.shape).context(e)(t)}),_w=ri('symbol',function(e,t){return aw.context(e)(t)}),xw={height:vi,measureWidth:_i,estimateWidth:yi,width:yi,canvas:ki},vw,kw;ki(!0);var ww={left:'start',center:'middle',right:'end'},Sw=new gn,Ew={type:'text',tag:'text',nested:!1,attr:function(e,n){var i=n.dx||0,d=(n.dy||0)+Ci(n),o=n.x||0,l=n.y||0,s=n.angle||0,a=n.radius||0,r;a&&(r=(n.theta||0)-Gx/2,o+=a*Bx(r),l+=a*Ix(r)),e('text-anchor',ww[n.align]||'start'),s?(r=ii(o,l)+' rotate('+s+')',(i||d)&&(r+=' '+ii(i,d))):r=ii(o+i,l+d),e('transform',r)},bound:zi,draw:function(e,t,n){Ja(t,function(a){var i,d,o,l,r,t;(!n||n.intersects(a.bounds))&&(t=wi(a))&&(i=null==a.opacity?1:a.opacity,0===i||(e.font=Ei(a),e.textAlign=a.align||'left',d=a.x||0,o=a.y||0,(l=a.radius)&&(r=(a.theta||0)-Gx/2,d+=l*Bx(r),o+=l*Ix(r)),a.angle&&(e.save(),e.translate(d,o),e.rotate(a.angle*Gx/180),d=o=0),d+=a.dx||0,o+=(a.dy||0)+Ci(a),a.fill&&Wa(e,a,i)&&e.fillText(t,d,o),a.stroke&&Ha(e,a,i)&&e.strokeText(t,d,o),a.angle&&e.restore()))})},pick:ti(function(e,t,n,i,d,r){if(0>=t.fontSize)return!1;if(!t.angle)return!0;var o=zi(Sw,t,!0),l=-t.angle*Gx/180,a=Bx(l),s=Ix(l),f=t.x,c=t.y;return o.contains(a*d-s*r+(f-f*a+c*s),s*d+a*r+(c-f*s-c*a))})},Cw=oi('trail',function(e,t){return iw.context(e)(t)}),zw={arc:fw,area:pw,group:{type:'group',tag:'g',nested:!1,attr:function(e,t){e('transform',di(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,a=0,i=n.length;a<i;++a)e.union(n[a].bounds);return(t.clip||t.width||t.height)&&$a(e.add(0,0).add(t.width||0,t.height||0),t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){var a=this;Ja(t,function(t){var i=t.x||0,d=t.y||0,r=t.width||0,o=t.height||0,l,s;e.save(),e.translate(i,d),(t.stroke||t.fill)&&(s=null==t.opacity?1:t.opacity,0<s&&(e.beginPath(),l=t.stroke?0.5:0,ja(e,t,l,l),t.fill&&Wa(e,t,s)&&e.fill(),t.stroke&&Ha(e,t,s)&&e.stroke())),t.clip&&(e.beginPath(),e.rect(0,0,r,o),e.clip()),n&&n.translate(-i,-d),Ja(t,function(t){a.draw(e,t,n)}),n&&n.translate(i,d),e.restore()})},pick:function(e,t,n,a,i,d){if(t.bounds&&!t.bounds.contains(i,d)||!t.items)return null;var r=this;return Za(t,function(o){var l,s,f,c;if(c=o.bounds,!c||c.contains(i,d))return(s=o.x||0,f=o.y||0,e.save(),e.translate(s,f),s=i-s,f=d-f,l=Za(o,function(e){return si(e,s,f)?r.pick(e,n,a,s,f):null}),e.restore(),l)?l:(l=!1!==t.interactive&&(o.fill||o.stroke)&&0<=s&&s<=o.width&&0<=f&&f<=o.height,l?o:null)})},background:function(e,t){var n=t.stroke?0.5:0;e('class','background'),e('d',ja(null,t,n,n))},foreground:function(e,t,n){var a=t.clip?li(n,t,t):null;e('clip-path',a)}},image:uw,line:gw,path:hw,rect:mw,rule:yw,shape:bw,symbol:_w,text:Ew,trail:Cw},Tw={mark:null},Rw=['marktype','name','role','interactive','clip','items','zindex','x','y','width','height','align','baseline','fill','fillOpacity','opacity','stroke','strokeOpacity','strokeWidth','strokeCap','strokeDash','strokeDashOffset','startAngle','endAngle','innerRadius','outerRadius','cornerRadius','padAngle','interpolate','tension','orient','defined','url','path','x2','y2','size','shape','text','angle','theta','radius','dx','dy','font','fontSize','fontWeight','fontStyle','fontVariant'],Aw=Mi.prototype;Aw.toJSON=function(e){return Ai(this.root,e||0)},Aw.mark=function(e,t,n){t=t||this.root.items[0];var a=Di(e,t);return t.items[n]=a,a.zindex&&(a.group.zdirty=!0),a};var Ow=Li.prototype;Ow.initialize=function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},Ow.element=function(){return this._el},Ow.origin=function(e){return this._origin=e||[0,0],this},Ow.scene=function(e){return arguments.length?(this._scene=e,this):this._scene},Ow.on=function(){},Ow.off=function(){},Ow.handlers=function(){var e=this._handlers,t=[],n;for(n in e)t.push.apply(t,e[n]);return t},Ow.eventName=function(e){var t=e.indexOf('.');return 0>t?e:e.slice(0,t)},Ow.handleHref=function(t,e,n){this._loader.sanitize(n,{context:'href'}).then(function(n){var i=new MouseEvent(t.type,t),e=bn(null,'a');for(var a in n)e.setAttribute(a,n[a]);e.dispatchEvent(i)}).catch(function(){})},Ow.handleTooltip=function(e,t,n){this._el.setAttribute('title',n||'')};var Pw=qi.prototype;Pw.initialize=function(e,t,n,a){return this._el=e,this.resize(t,n,a)},Pw.element=function(){return this._el},Pw.scene=function(){return this._el&&this._el.firstChild},Pw.background=function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},Pw.resize=function(e,t,n){return this._width=e,this._height=t,this._origin=n||[0,0],this},Pw.render=function(e,t){var n=this;return n._call=function(){n._render(e,t)},n._call(),n._call=null,n},Pw._render=function(){},Pw.renderAsync=function(e,t){var n=this.render(e,t);return this._ready?this._ready.then(function(){return n}):Promise.resolve(n)},Pw._load=function(e,t){var n=this,a=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then(function(e){e&&i(),n._ready=null})}return a},Pw.sanitizeURL=function(e){return this._load('sanitizeURL',e)},Pw.loadImage=function(e){return this._load('loadImage',e)};var Mw=ee(Fi,Li);Mw.initialize=function(e,t,n){var a=this._canvas=e&&_n(e,'canvas');if(a){var i=this;this.events.forEach(function(e){a.addEventListener(e,function(t){Mw[e]?Mw[e].call(i,t):i.fire(e,t)})})}return Li.prototype.initialize.call(this,e,t,n)},Mw.canvas=function(){return this._canvas},Mw.context=function(){return this._canvas.getContext('2d')},Mw.events=['keydown','keypress','keyup','dragenter','dragleave','dragover','mousedown','mouseup','mousemove','mouseout','mouseover','click','dblclick','wheel','mousewheel','touchstart','touchmove','touchend'],Mw.DOMMouseScroll=function(e){this.fire('mousewheel',e)},Mw.mousemove=ji('mousemove','mouseover','mouseout'),Mw.dragover=ji('dragover','dragenter','dragleave'),Mw.mouseout=$i('mouseout'),Mw.dragleave=$i('dragleave'),Mw.mousedown=function(e){this._down=this._active,this.fire('mousedown',e)},Mw.click=function(e){this._down===this._active&&(this.fire('click',e),this._down=null)},Mw.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire('touchstart',e,!0)},Mw.touchmove=function(e){this.fire('touchmove',e,!0)},Mw.touchend=function(e){this.fire('touchend',e,!0),this._touch=null},Mw.fire=function(e,t,n){var d=n?this._touch:this._active,a=this._handlers[e],r,i;if('click'===e&&d&&d.href?this.handleHref(t,d,d.href):('mouseover'===e||'mouseout'===e)&&d&&d.tooltip&&this.handleTooltip(t,d,'mouseover'===e?d.tooltip:null),a)for(t.vegaType=e,r=0,i=a.length;r<i;++r)a[r].handler.call(this._obj,t,d)},Mw.on=function(e,t){var n=this.eventName(e),a=this._handlers;return(a[n]||(a[n]=[])).push({type:e,handler:t}),this},Mw.off=function(e,t){var n=this.eventName(e),a=this._handlers[n],d;if(a){for(d=a.length;0<=--d;)a[d].type===e&&(t&&a[d].handler!==t||a.splice(d,1));return this}},Mw.pickEvent=function(e){var t=Ui(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},Mw.pick=function(e,t,n,a,i){var d=this.context(),r=zw[e.marktype];return r.pick.call(this,d,e,t,n,a,i)};var Dw='undefined'===typeof window?1:window.devicePixelRatio||1,Lw=ee(Bi,qi),qw=qi.prototype,Uw=new gn;Lw.initialize=function(e,t,n,a){return this._canvas=wn(1,1),e&&(vn(e,0).appendChild(this._canvas),this._canvas.setAttribute('class','marks')),qw.initialize.call(this,e,t,n,a)},Lw.resize=function(e,t,n){return qw.resize.call(this,e,t,n),Ii(this._canvas,this._width,this._height,this._origin),(this._redraw=!0,this)},Lw.canvas=function(){return this._canvas},Lw.context=function(){return this._canvas?this._canvas.getContext('2d'):null},Lw._render=function(e,t){var n=this.context(),a=this._origin,i=this._width,d=this._height,r;return n.save(),r=!t||this._redraw?(this._redraw=!1,null):Yi(n,t),this.clear(-a[0],-a[1],i,d),this.draw(n,e,r),n.restore(),this},Lw.draw=function(e,t,n){var a=zw[t.marktype];t.clip&&Ni(e,t),a.draw.call(this,e,t,n),t.clip&&e.restore()},Lw.clear=function(e,t,n,a){var i=this.context();i.clearRect(e,t,n,a),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,a))};var Fw=ee(Wi,Li);Fw.initialize=function(e,t,n){var a=this._svg;return a&&(a.removeEventListener('click',this._hrefHandler),a.removeEventListener('mouseover',this._tooltipHandler),a.removeEventListener('mouseout',this._tooltipHandler)),this._svg=a=e&&_n(e,'svg'),a&&(a.addEventListener('click',this._hrefHandler),a.addEventListener('mouseover',this._tooltipHandler),a.addEventListener('mouseout',this._tooltipHandler)),Li.prototype.initialize.call(this,e,t,n)},Fw.svg=function(){return this._svg},Fw.on=function(e,t){var n=this.eventName(e),a=this._handlers,i={type:e,handler:t,listener:Hi(this,t)};return(a[n]||(a[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener),this},Fw.off=function(e,t){var n=this.eventName(e),a=this._svg,d=this._handlers[n],r;if(d){for(r=d.length;0<=--r;)(d[r].type!==e||t)&&d[r].handler!==t||(this._svg&&a.removeEventListener(n,d[r].listener),d.splice(r,1));return this}};var jw={version:'1.1',xmlns:'http://www.w3.org/2000/svg',"xmlns:xlink":'http://www.w3.org/1999/xlink'},$w={fill:'fill',fillOpacity:'fill-opacity',stroke:'stroke',strokeWidth:'stroke-width',strokeOpacity:'stroke-opacity',strokeCap:'stroke-linecap',strokeJoin:'stroke-linejoin',strokeDash:'stroke-dasharray',strokeDashOffset:'stroke-dashoffset',strokeMiterLimit:'stroke-miterlimit',opacity:'opacity'},Nw=Object.keys($w),Iw=jw.xmlns,ns=ee(Ji,qi),Bw=qi.prototype;ns.initialize=function(e,t,n,a){return e&&(this._svg=xn(e,0,'svg',Iw),this._svg.setAttribute('class','marks'),vn(e,1),this._root=xn(this._svg,0,'g',Iw),vn(this._svg,1)),this._defs={clip_id:1,gradient:{},clipping:{}},this.background(this._bgcolor),Bw.initialize.call(this,e,t,n,a)},ns.background=function(e){return arguments.length&&this._svg&&this._svg.style.setProperty('background-color',e),Bw.background.apply(this,arguments)},ns.resize=function(e,t,n){return Bw.resize.call(this,e,t,n),this._svg&&(this._svg.setAttribute('width',this._width),this._svg.setAttribute('height',this._height),this._svg.setAttribute('viewBox','0 0 '+this._width+' '+this._height),this._root.setAttribute('transform','translate('+this._origin+')')),this},ns.svg=function(){if(!this._svg)return null;var e={class:'marks',width:this._width,height:this._height,viewBox:'0 0 '+this._width+' '+this._height};for(var t in jw)e[t]=jw[t];return Xi('svg',e)+this._svg.innerHTML+Vi('svg')},ns._render=function(e,t){return this._dirtyCheck(t)&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,e),vn(this._root,1)),this.updateDefs(),this},ns.updateDefs=function(){var e=this._svg,t=this._defs,n=t.el,a=0,i;for(i in t.gradient)n||(t.el=n=xn(e,0,'defs',Iw)),Zi(n,t.gradient[i],a++);for(i in t.clipping)n||(t.el=n=xn(e,0,'defs',Iw)),Ki(n,t.clipping[i],a++);n&&(0===a?(e.removeChild(n),t.el=null):vn(n,a))},ns._resetDefs=function(){var e=this._defs;e.clip_id=1,e.gradient={},e.clipping={}},ns.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},ns._dirtyCheck=function(e){if(this._dirtyAll=!0,!e)return!0;var t=++this._dirtyID,a,d,r,l,s,i,n;for(s=0,i=e.length;s<i;++s){if(a=e[s],d=a.mark,d.marktype!==r&&(r=d.marktype,l=zw[r]),d.zdirty&&d.dirty!==t&&(this._dirtyAll=!1,d.dirty=t,Qi(d.group,t)),a.exit){l.nested&&d.items.length?(n=d.items[0],n._svg&&this._update(l,n._svg,n)):a._svg&&a._svg.parentNode.removeChild(a._svg),a._svg=null;continue}a=l.nested?d.items[0]:a,a._update===t||(a._svg&&a._svg.ownerSVGElement?this._update(l,a._svg,a):(this._dirtyAll=!1,Qi(a,t)),a._update=t)}return!this._dirtyAll},ns.draw=function(e,t,n){function a(e){var t=d.isDirty(e),n=td(e,i,s,r.tag);t&&(d._update(r,n,e),l&&ed(d,n,e)),s=n,++f}if(!this.isDirty(t))return t._svg;var d=this,r=zw[t.marktype],o=!1===t.interactive?'none':null,l='g'===r.tag,s=null,f=0,i;return i=td(t,e,n,'g'),i.setAttribute('class',kn(t)),!l&&o&&i.style.setProperty('pointer-events',o),t.clip&&i.setAttribute('clip-path',li(d,t,t.group)),r.nested?t.items.length&&a(t.items[0]):Ja(t,a),vn(i,f),i};var Yw=null,Gw=null,Ww={group:function(e,t,n){Gw=t.__values__,Yw=t.childNodes[1],e.foreground(nd,n,this),Yw=t.childNodes[0],e.background(nd,n,this);var a=!1===n.mark.interactive?'none':null;a!==Gw.events&&(Yw.style.setProperty('pointer-events',a),Gw.events=a)},text:function(e,t,n){var a=wi(n);a!==Gw.text&&(t.textContent=a,Gw.text=a),a=Ei(n),a!==Gw.font&&(t.style.setProperty('font',a),Gw.font=a)}};ns._update=function(e,t,n){Yw=t,Gw=t.__values__,e.attr(nd,n,this);var a=Ww[e.type];a&&a.call(this,e,t,n),this.style(Yw,n)},ns.style=function(e,t){if(null!=t){var a,i,n,d,r;for(a=0,i=Nw.length;a<i;++a)n=Nw[a],r=t[n],r===Gw[n]||(d=$w[n],null==r?'fill'===d?e.style.setProperty(d,'none'):e.style.removeProperty(d):(r.id&&(this._defs.gradient[r.id]=r,r='url('+ad()+'#'+r.id+')'),e.style.setProperty(d,r+'')),Gw[n]=r)}};var Hw=ee(dd,qi),Xw=qi.prototype;Hw.resize=function(e,n,a){Xw.resize.call(this,e,n,a);var i=this._origin,d=this._text,t={class:'marks',width:this._width,height:this._height,viewBox:'0 0 '+this._width+' '+this._height};for(var r in jw)t[r]=jw[r];return d.head=Xi('svg',t),d.root=Xi('g',{transform:'translate('+i+')'}),d.foot=Vi('g')+Vi('svg'),this},Hw.svg=function(){var e=this._text;return e.head+e.defs+e.root+e.body+e.foot},Hw._render=function(e){return this._text.body=this.mark(e),this._text.defs=this.buildDefs(),this},Hw.reset=function(){return this._defs.clip_id=0,this},Hw.buildDefs=function(){var e=this._defs,t='',n,a,i,d;for(a in e.gradient){for(i=e.gradient[a],d=i.stops,t+=Xi('linearGradient',{id:a,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2}),n=0;n<d.length;++n)t+=Xi('stop',{offset:d[n].offset,"stop-color":d[n].color})+Vi('stop');t+=Vi('linearGradient')}for(a in e.clipping)i=e.clipping[a],t+=Xi('clipPath',{id:a}),t+=Xi('rect',{x:0,y:0,width:i.width,height:i.height})+Vi('rect'),t+=Vi('clipPath');return 0<t.length?Xi('defs')+t+Vi('defs'):''};var Vw;Hw.attributes=function(e,t){return Vw={},e(rd,t,this),Vw},Hw.href=function(e){var t=this,n=e.href,a;if(n){if(a=t._hrefs&&t._hrefs[n])return a;t.sanitizeURL(n).then(function(e){e['xlink:href']=e.href,e.href=null,(t._hrefs||(t._hrefs={}))[n]=e})}return null},Hw.mark=function(e){function t(t){var l=n.href(t);l&&(r+=Xi('a',l)),o='g'===i?null:od(t,e,i,d),r+=Xi(i,n.attributes(a.attr,t),o),'text'===i?r+=ld(wi(t)):'g'===i&&(r+=Xi('path',n.attributes(a.background,t),od(t,e,'bgrect',d))+Vi('path'),r+=Xi('g',n.attributes(a.foreground,t))+n.markGroup(t)+Vi('g')),r+=Vi(i),l&&(r+=Vi('a'))}var n=this,a=zw[e.marktype],i=a.tag,d=this._defs,r='',o;return'g'!==i&&!1===e.interactive&&(o='style="pointer-events: none;"'),r+=Xi('g',{class:kn(e),"clip-path":e.clip?li(n,e,e.group):null},o),a.nested?e.items&&e.items.length&&t(e.items[0]):Ja(e,t),r+Vi('g')},Hw.markGroup=function(e){var t=this,n='';return Ja(e,function(e){n+=t.mark(e)}),n};var Jw='canvas',Zw='png',Kw='svg',Qw='none',eS={Canvas:Jw,PNG:Zw,SVG:Kw,None:Qw},tS={};tS[Jw]=tS[Zw]={renderer:Bi,headless:Bi,handler:Fi},tS[Kw]={renderer:Ji,headless:dd,handler:Wi},tS[Qw]={};var nS=1e-9,aS=1,iS='_:mod:_',dS=kd.prototype;dS.set=function(e,t,n,a){var i=this,d=i[e],r=i[iS];return null!=t&&0<=t?(d[t]!==n||a)&&(d[t]=n,r[t+':'+e]=-1,r[e]=-1):(d!==n||a)&&(i[e]=n,r[e]=fv(n)?n.length:-1),i},dS.modified=function(e,t){var n=this[iS],a;if(!arguments.length){for(a in n)if(n[a])return!0;return!1}if(fv(e)){for(a=0;a<e.length;++a)if(n[e[a]])return!0;return!1}return null!=t&&0<=t?t<n[e]||!!n[t+':'+e]:!!n[e]},dS.clear=function(){return this[iS]={},this};var rS=0,oS=new kd,lS=wd.prototype;lS.targets=function(){return this._targets||(this._targets=ud(pv))},lS.set=function(e){return this.value===e?0:(this.value=e,1)},lS.skip=Sd(1),lS.modified=Sd(2),lS.parameters=function(e,t){function a(e,n,a){a instanceof wd?(a!==d&&(t&&a.targets().add(d),l.push(a)),o.push({op:a,name:e,index:n})):r.set(e,n,a)}t=!1!==t;var d=this,r=d._argval=d._argval||new kd,o=d._argops=d._argops||[],l=[],s,f,c,n;for(s in e)if(f=e[s],s==='pulse')H(f).forEach(function(e){e instanceof wd?e!==d&&(e.targets().add(d),l.push(e)):F('Pulse parameters must be operator instances.')}),d.source=f;else if(fv(f))for(r.set(s,-1,Array(c=f.length)),n=0;n<c;++n)a(s,n,f[n]);else a(s,-1,f);return this.marshall().clear(),l},lS.marshall=function(e){var t=this._argval||oS,a=this._argops,d,r,i,n,o;if(a&&(i=a.length))for(r=0;r<i;++r)d=a[r],n=d.op,o=n.modified()&&n.stamp===e,t.set(d.name,d.index,n.value,o);return t},lS.evaluate=function(e){if(this._update){var t=this.marshall(e.stamp),n=this._update(t,e);if(t.clear(),n!==this.value)this.value=n;else if(!this.modified())return e.StopPropagation}},lS.run=function(e){if(e.stamp<=this.stamp)return e.StopPropagation;var t=this.skip()?(this.skip(!1),0):this.evaluate(e);return this.stamp=e.stamp,this.pulse=t||e};var sS=0,fS=Ed.prototype;fS._filter=hv,fS._apply=id,fS.targets=function(){return this._targets||(this._targets=ud(pv))},fS.consume=function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},fS.receive=function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),a=this._targets,d=a?a.length:0,n=0;n<d;++n)a[n].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},fS.filter=function(e){var t=Cd(e);return this.targets().add(t),t},fS.apply=function(e){var t=Cd(null,e);return this.targets().add(t),t},fS.merge=function(){var e=Cd();this.targets().add(e);for(var t=0,a=arguments.length;t<a;++t)arguments[t].targets().add(e);return e},fS.throttle=function(e){var n=-1;return this.filter(function(){var t=Date.now();return t-n>e?(n=t,1):0})},fS.debounce=function(t){function n(){var t=a.dataflow;e.receive(a),a=null,i=null,t&&t.run&&t.run()}var e=Cd(),a=null,i=null;return this.targets().add(Cd(null,null,function(d){a=d,i&&clearTimeout(i),i=setTimeout(n,t)})),e},fS.between=function(e,t){var n=!1;return e.targets().add(Cd(null,null,function(){n=!0})),t.targets().add(Cd(null,null,function(){n=!1})),this.filter(function(){return n})};var cS={skip:!0},pS={},uS=1,gS=2,hS=4,mS=uS|hS,yS=uS|gS|hS,bS=8,_S=16,xS=32,vS=64,kS=Rd.prototype;kS.StopPropagation=pS,kS.ADD=uS,kS.REM=gS,kS.MOD=hS,kS.ADD_REM=uS|gS,kS.ADD_MOD=mS,kS.ALL=yS,kS.REFLOW=bS,kS.SOURCE=_S,kS.NO_SOURCE=xS,kS.NO_FIELDS=vS,kS.fork=function(e){return new Rd(this.dataflow).init(this,e)},kS.addAll=function(){var e=this;return this.source&&this.source.length!==this.add.length?(e=new Rd(this.dataflow).init(this),e.add=e.source,e):e},kS.init=function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&vS)&&(n.fields=e.fields),n.add=t&uS?(n.addF=e.addF,e.add):(n.addF=null,[]),n.rem=t&gS?(n.remF=e.remF,e.rem):(n.remF=null,[]),n.mod=t&hS?(n.modF=e.modF,e.mod):(n.modF=null,[]),n.source=t&xS?(n.srcF=null,null):(n.srcF=e.srcF,e.source),n},kS.runAfter=function(e){this.dataflow.runAfter(e)},kS.changed=function(e){var t=e||yS;return t&uS&&this.add.length||t&gS&&this.rem.length||t&hS&&this.mod.length},kS.reflow=function(e){if(e)return this.fork(yS).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(hS,Od(this,uS))),this},kS.modifies=function(e){var t=H(e),n=this.fields||(this.fields={});return t.forEach(function(e){n[e]=!0}),this},kS.modified=function(e){var t=this.fields;return this.mod.length&&t&&(arguments.length?fv(e)?e.some(function(e){return t[e]}):t[e]:!!t)},kS.filter=function(e,t){var n=this;return e&uS&&(n.addF=Ad(n.addF,t)),e&gS&&(n.remF=Ad(n.remF,t)),e&hS&&(n.modF=Ad(n.modF,t)),e&_S&&(n.srcF=Ad(n.srcF,t)),n},kS.materialize=function(e){e=e||yS;var t=this;return e&uS&&t.addF&&(t.add=t.add.filter(t.addF),t.addF=null),e&gS&&t.remF&&(t.rem=t.rem.filter(t.remF),t.remF=null),e&hS&&t.modF&&(t.mod=t.mod.filter(t.modF),t.modF=null),e&_S&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},kS.visit=function(e,t){var n=t,a,i;return e&_S?(ye(this.source,this.srcF,n),this):(e&uS&&ye(this.add,this.addF,n),e&gS&&ye(this.rem,this.remF,n),e&hS&&ye(this.mod,this.modF,n),e&bS&&(a=this.source)&&(i=this.add.length+this.mod.length,i===a.length||(i?ye(a,Od(this,mS),n):ye(a,this.srcF,n))),this)};var wS={skip:!1,force:!1},SS=ee(Md,Rd);SS.fork=function(){return arguments.length&&arguments[0]&Rd.prototype.ALL&&F('MultiPulse fork does not support tuple change sets.'),new Rd(this.dataflow).init(this,0)},SS.changed=function(e){return this.changes&e},SS.modified=function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?fv(e)?e.some(function(e){return n[e]}):n[e]:0},SS.filter=function(){F('MultiPulse does not support filtering.')},SS.materialize=function(){F('MultiPulse does not support materialization.')},SS.visit=function(e,t){var a=this.pulses,d,i;for(d=0,i=a.length;d<i;++d)a[d].stamp===this.stamp&&a[d].visit(e,t);return this};var ES=Dd.prototype;ES.size=function(){return this.nodes.length},ES.clear=function(){return this.nodes=[],this},ES.peek=function(){return this.nodes[0]},ES.push=function(e){var t=this.nodes;return t.push(e),Ld(t,0,t.length-1,this.cmp)},ES.pop=function(){var e=this.nodes,t=e.pop(),n;return e.length?(n=e[0],e[0]=t,qd(e,0,this.cmp)):n=t,n},ES.replace=function(e){var t=this.nodes,n=t[0];return t[0]=e,qd(t,0,this.cmp),n},ES.pushpop=function(e){var t=this.nodes,n=t[0];return t.length&&0>this.cmp(n,e)&&(t[0]=e,e=n,qd(t,0,this.cmp)),e};var CS=Ud.prototype;CS.stamp=function(){return this._clock},CS.loader=function(e){return arguments.length?(this._loader=e,this):this._loader},CS.cleanThreshold=1e4,CS.add=function(e,t,n,a){var i=1,d=e instanceof wd?e:e&&e.prototype instanceof wd?new e:V(e)?new wd(null,e):(i=0,new wd(e,t));return this.rank(d),i&&(a=n,n=t),n&&this.connect(d,d.parameters(n,a)),this.touch(d),d},CS.connect=function(e,t){var a=e.rank,d,i;for(d=0,i=t.length;d<i;++d)if(a<t[d].rank)return void this.rerank(e)},CS.rank=function(e){e.rank=++this._rank},CS.rerank=function(e){for(var t=[e],n,a,d;t.length;)if(this.rank(n=t.pop()),a=n._targets)for(d=a.length;0<=--d;)t.push(a[d])},CS.pulse=function(e,t,n){var a=new Rd(this,this._clock+(this._pulse?0:1));return a.target=e,this._pulses[e.id]=t.pulse(a,e.value),this.touch(e,n||wS)},CS.touch=function(e,t){return this._pulse?this._enqueue(e):this._touched.add(e),(t||wS).skip&&e.skip(!0),this},CS.update=function(e,t,n){var a=n||wS;return(e.set(t)||a.force)&&this.touch(e,a),this},CS.changeset=vd,CS.ingest=function(e,t,n){return this.pulse(e,this.changeset().insert(pn(t,n)))},CS.request=function(e,t,n){var a=this,i=a._pending||Pd(a);i.requests+=1,a.loader().load(t,{context:'dataflow'}).then(function(t){a.ingest(e,t,n)},function(e){a.warn('Loading failed: '+t,e),i.done()}).then(i.done).catch(function(e){a.warn(e)})},CS.events=function(e,t,a,d){var r=this,o=Cd(a,d),l=function(t){t.dataflow=r,o.receive(t),r.run()},s;s='string'===typeof e&&'undefined'!==typeof document?document.querySelectorAll(e):H(e);for(var f=0,i=s.length;f<i;++f)s[f].addEventListener(t,l);return o},CS.on=function(e,t,n,a,i){var d=e instanceof wd?Td:zd;return d(this,e,t,n,a,i),this},CS.run=function(e){if(!this._touched.length)return 0;if(this._pending)return this.info('Awaiting requests, delaying dataflow run.'),0;var t=this,n=0,a=t.logLevel(),i,d,r;t._pulse=new Rd(t,++t._clock,e),a>=_v&&(r=Date.now(),t.debug('-- START PROPAGATION ('+t._clock+') -----')),t._touched.forEach(function(e){t._enqueue(e,!0)}),t._touched=ud(pv);try{for(;0<t._heap.size();){if(i=t._heap.pop(),i.rank!==i.qrank){t._enqueue(i,!0);continue}d=i.run(t._getPulse(i,e)),a>=xv&&t.debug(i.id,d===pS?'STOP':d,i),d!==pS&&(t._pulse=d,i._targets&&i._targets.forEach(function(e){t._enqueue(e)})),++n}}catch(e){t.error(e)}if(t._pulses={},t._pulse=null,a>=_v&&(r=Date.now()-r,t.info('> Pulse '+t._clock+': '+n+' operators; '+r+'ms')),t._postrun.length){var o=t._postrun;t._postrun=[],o.forEach(function(e){try{e(t)}catch(e){t.error(e)}})}return n},CS.runAsync=function(){return this._pending||Promise.resolve(this.run())},CS.runAfter=function(e){if(this._pulse)this._postrun.push(e);else try{e(this)}catch(e){this.error(e)}},CS._enqueue=function(e,t){var n=!this._pulses[e.id];n&&(this._pulses[e.id]=this._pulse),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},CS._getPulse=function(e,t){var n=e.source,a=this._clock,i;return n&&fv(n)?(i=n.map(function(e){return e.pulse}),new Md(this,a,i,t)):(n=n&&n.pulse,i=this._pulses[e.id],n&&n!==pS&&(n.stamp===a&&i.target!==e?i=n:i.source=n.source),i)},CS.warn=Fd('warn'),CS.info=Fd('info'),CS.debug=Fd('debug'),CS.logLevel=Fd('level'),CS.error=function(e){throw e};var zS=ee(jd,wd);zS.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},zS.transform=function(){};var TS={},RS={},AS=Bd.prototype;AS.add=function(e){this._add.push(e)},AS.rem=function(e){this._rem.push(e)},AS.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e=this._add,t=this._rem,a=this._key,d=e.length,n=t.length,r=Array(d-n),o={},l,i,s;for(l=0;l<n;++l)o[t[l][a]]=1;for(l=0,i=0;l<d;++l)o[(s=e[l])[a]]?o[s[a]]=0:r[i++]=s;return this._rem=[],this._add=r},AS.distinct=function(e){for(var t=this.values(),a=t.length,n={},i=0,d;0<=--a;)d=e(t[a])+'',n.hasOwnProperty(d)||(n[d]=1,++i);return i},AS.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=K(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},AS.argmin=function(e){return this.extent(e)[0]||{}},AS.argmax=function(e){return this.extent(e)[1]||{}},AS.min=function(e){var t=this.extent(e)[0];return null==t?+Infinity:e(t)},AS.max=function(e){var t=this.extent(e)[1];return null==t?-Infinity:e(t)},AS.quartile=function(e){return this._get===e&&this._q||(this._q=T(this.values(),e),this._get=e),this._q},AS.q1=function(e){return this.quartile(e)[0]},AS.q2=function(e){return this.quartile(e)[1]},AS.q3=function(e){return this.quartile(e)[2]},AS.ci=function(e){return this._get===e&&this._ci||(this._ci=S(this.values(),1e3,0.05,e),this._get=e),this._ci},AS.ci0=function(e){return this.ci(e)[0]},AS.ci1=function(e){return this.ci(e)[1]};var OS={values:Gd({name:'values',init:'cell.store = true;',set:'cell.data.values()',idx:-1}),count:Gd({name:'count',set:'cell.num'}),missing:Gd({name:'missing',set:'this.missing'}),valid:Gd({name:'valid',set:'this.valid'}),sum:Gd({name:'sum',init:'this.sum = 0;',add:'this.sum += v;',rem:'this.sum -= v;',set:'this.sum'}),mean:Gd({name:'mean',init:'this.mean = 0;',add:'var d = v - this.mean; this.mean += d / this.valid;',rem:'var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;',set:'this.mean'}),average:Gd({name:'average',set:'this.mean',req:['mean'],idx:1}),variance:Gd({name:'variance',init:'this.dev = 0;',add:'this.dev += d * (v - this.mean);',rem:'this.dev -= d * (v - this.mean);',set:'this.valid > 1 ? this.dev / (this.valid-1) : 0',req:['mean'],idx:1}),variancep:Gd({name:'variancep',set:'this.valid > 1 ? this.dev / this.valid : 0',req:['variance'],idx:2}),stdev:Gd({name:'stdev',set:'this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : 0',req:['variance'],idx:2}),stdevp:Gd({name:'stdevp',set:'this.valid > 1 ? Math.sqrt(this.dev / this.valid) : 0',req:['variance'],idx:2}),stderr:Gd({name:'stderr',set:'this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : 0',req:['variance'],idx:2}),distinct:Gd({name:'distinct',set:'cell.data.distinct(this.get)',req:['values'],idx:3}),ci0:Gd({name:'ci0',set:'cell.data.ci0(this.get)',req:['values'],idx:3}),ci1:Gd({name:'ci1',set:'cell.data.ci1(this.get)',req:['values'],idx:3}),median:Gd({name:'median',set:'cell.data.q2(this.get)',req:['values'],idx:3}),q1:Gd({name:'q1',set:'cell.data.q1(this.get)',req:['values'],idx:3}),q3:Gd({name:'q3',set:'cell.data.q3(this.get)',req:['values'],idx:3}),argmin:Gd({name:'argmin',add:'if (v < this.min) this.argmin = t;',rem:'if (v <= this.min) this.argmin = null;',set:'this.argmin || cell.data.argmin(this.get)',req:['min'],str:['values'],idx:3}),argmax:Gd({name:'argmax',add:'if (v > this.max) this.argmax = t;',rem:'if (v >= this.max) this.argmax = null;',set:'this.argmax || cell.data.argmax(this.get)',req:['max'],str:['values'],idx:3}),min:Gd({name:'min',init:'this.min = null;',add:'if (v < this.min || this.min === null) this.min = v;',rem:'if (v <= this.min) this.min = NaN;',set:'this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)',str:['values'],idx:4}),max:Gd({name:'max',init:'this.max = null;',add:'if (v > this.max || this.max === null) this.max = v;',rem:'if (v >= this.max) this.max = NaN;',set:'this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)',str:['values'],idx:4})},PS=ee(Vd,jd);PS.transform=function(e,t){var n=this,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i;return this.stamp=a.stamp,this.value&&((i=e.modified())||t.modified(this._inputs))?(this._prev=this.value,this.value=i?this.init(e):{},t.visit(t.SOURCE,function(e){n.add(e)})):(this.value=this.value||this.init(e),t.visit(t.REM,function(e){n.rem(e)}),t.visit(t.ADD,function(e){n.add(e)})),a.modifies(this._outputs),n._drop=!1!==e.drop,e.cross&&1<n._dims.length&&(n._drop=!1,this.cross()),n.changes(a)},PS.cross=function(){function e(e){var n,a,i,t;for(n in e)for(i=e[n].tuple,a=0;a<o;++a)r[a][t=i[d[a]]]=t}function t(e,n,l){var s=d[l],f=r[l++],c,p;for(c in f)n[s]=f[c],p=e?e+'|'+c:c,l<o?t(p,n,l):!i[p]&&a.cell(p,n)}var a=this,i=a.value,d=a._dnames,r=d.map(function(){return{}}),o=d.length;e(a._prev),e(i),t('',{},0)},PS.init=function(e){function t(e){for(var t=e.fields,r=0,i=t.length,n;r<i;++r)d[n=t[r]]||(d[n]=1,a.push(n))}var a=this._inputs=[],r=this._outputs=[],d={};this._dims=H(e.groupby),this._dnames=this._dims.map(function(e){var n=q(e);return t(e),r.push(n),n}),this.cellkey=e.key?e.key:0===this._dims.length?function(){return''}:1===this._dims.length?this._dims[0]:Zd,this._countOnly=!0,this._counts=[],this._measures=[];var o=e.fields||[null],l=e.ops||['count'],s=e.as||[],f=o.length,n={},c,p,u,g,h,m;for(f!==l.length&&F('Unmatched number of fields and aggregate ops.'),m=0;m<f;++m){if(c=o[m],p=l[m],null==c&&'count'!==p&&F('Null aggregate field specified.'),g=q(c),h=Jd(p,g,s[m]),r.push(h),'count'===p){this._counts.push(h);continue}u=n[g],u||(t(c),u=n[g]=[],u.field=c,this._measures.push(u)),'count'!==p&&(this._countOnly=!1),u.push(Yd(p,h))}return this._measures=this._measures.map(function(e){return Xd(e,e.field)}),{}},PS.cellkey=Zd,PS.cell=function(e,n){var t=this.value[e];return t?0===t.num&&this._drop&&t.stamp<this.stamp?(t.stamp=this.stamp,this._adds[this._alen++]=t):t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t):(t=this.value[e]=this.newcell(e,n),this._adds[this._alen++]=t),t},PS.newcell=function(e,a){var t={key:e,num:0,agg:null,tuple:this.newtuple(a,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var d=this._measures,r=d.length,n;for(t.agg=Array(r),n=0;n<r;++n)t.agg[n]=new d[n](t,t.tuple)}return t.store&&(t.data=new Bd),t},PS.newtuple=function(e,t){var a=this._dnames,d=this._dims,r={},o,i;for(o=0,i=d.length;o<i;++o)r[a[o]]=d[o](e);return t?_d(t.tuple,r):md(r)},PS.add=function(e){var t=this.cellkey(e),a=this.cell(t,e),d,r,i;if(a.num+=1,!this._countOnly)for(a.store&&a.data.add(e),d=a.agg,(r=0,i=d.length);r<i;++r)d[r].add(d[r].get(e),e)},PS.rem=function(e){var t=this.cellkey(e),a=this.cell(t,e),d,r,i;if(a.num-=1,!this._countOnly)for(a.store&&a.data.rem(e),d=a.agg,(r=0,i=d.length);r<i;++r)d[r].rem(d[r].get(e),e)},PS.celltuple=function(e){var t=e.tuple,a=this._counts,d,r,i;for(e.store&&e.data.values(),r=0,i=a.length;r<i;++r)t[a[r]]=e.num;if(!this._countOnly)for(d=e.agg,r=0,i=d.length;r<i;++r)d[r].set();return t},PS.changes=function(e){var t=this._adds,a=this._mods,d=this._prev,r=this._drop,o=e.add,l=e.rem,s=e.mod,f,c,p,i;if(d)for(c in d)l.push(d[c].tuple);for(p=0,i=this._alen;p<i;++p)o.push(this.celltuple(t[p])),t[p]=null;for(p=0,i=this._mlen;p<i;++p)f=a[p],(0===f.num&&r?l:s).push(this.celltuple(f)),a[p]=null;return this._alen=this._mlen=0,this._prev=null,e};var MS=ee(Kd,jd);MS.transform=function(e,t){var n=this._bins(e),a=n.step,i=e.as||['bin0','bin1'],d=i[0],r=i[1],o=e.modified()?(t=t.reflow(!0),t.SOURCE):t.modified(U(e.field))?t.ADD_MOD:t.ADD;return t.visit(o,function(e){var t=n(e);e[d]=t,e[r]=null==t?null:t+a}),t.modifies(i)},MS._bins=function(e){if(this.value&&!e.modified())return this.value;var n=e.field,i=t(e),r=i.start,o=i.stop,l=i.step,s,a;null!=(s=e.anchor)&&(a=s-(r+l*Kx((s-r)/l)),r+=a,o+=a);var d=function(e){var t=n(e);return null==t?null:(t=nv(r,Zx(+t,o-l)),r+l*Kx((t-r)/l))};return d.start=r,d.stop=o,d.step=l,this.value=L(d,U(n),e.name||'bin_'+q(n))};var DS=ee(Qd,jd);DS.transform=function(e,t){var a=t.fork(t.ALL),i=t.changed(t.ADD),d=t.changed(),r=e.sort,o=this.value,l=0,n;return a.rem.length&&(n={},a.visit(a.REM,function(e){n[e._id]=1,++l}),o=o.filter(function(e){return!n[e._id]})),r?((e.modified('sort')||t.modified(r.fields))&&(o.sort(r),d=!0),i&&(o=oe(r,o,a.add.sort(r)))):i&&a.visit(a.ADD,function(e){o.push(e)}),this.modified(d),this.value=a.source=o,a},ee(er,wd);var LS=ee(nr,jd);LS.transform=function(e,t){function n(a){return function(l){for(var s=ar(o(l),e.case,d)||[],f=0,i=s.length,n;f<i;++f)r.test(n=s[f])||a(n)}}var a=this._parameterCheck(e,t),i=this._counts,d=this._match,r=this._stop,o=e.field,l=e.as||['text','count'],s=n(function(e){i[e]=1+(i[e]||0)}),f=n(function(e){i[e]-=1});return a?t.visit(t.SOURCE,s):(t.visit(t.ADD,s),t.visit(t.REM,f)),this._finish(t,l)},LS._parameterCheck=function(e,t){var n=!1;return(e.modified('stopwords')||!this._stop)&&(this._stop=new RegExp('^'+(e.stopwords||'')+'$','i'),n=!0),(e.modified('pattern')||!this._match)&&(this._match=new RegExp(e.pattern||'[\\w\']+','g'),n=!0),(e.modified('field')||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},LS._finish=function(e,n){var a=this._counts,i=this._tuples||(this._tuples={}),d=n[0],r=n[1],o=e.fork(),l,s,f;for(l in a)s=i[l],f=a[l]||0,!s&&f?(i[l]=s=md({}),s[d]=l,s[r]=f,o.add.push(s)):0===f?(s&&o.rem.push(s),a[l]=null,i[l]=null):s[r]!==f&&(s[r]=f,o.mod.push(s));return o.modifies(n)};var qS=ee(ir,jd);qS.transform=function(e,t){var n=t.fork(t.NO_SOURCE),i=this.value,d=e.as||['a','b'],r=d[0],a=d[1],o=!i||t.changed(t.ADD_REM)||e.modified('as')||e.modified('filter');return o?(i&&(n.rem=i),n.add=this.value=dr(t.source,r,a,e.filter||hv)):n.mod=i,n.source=this.value,n.modifies(d)};var US={kde:R,mixture:P,normal:z,uniform:M},FS='distributions',jS='function',$S='field',NS=ee(or,jd);NS.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var a=rr(e.distribution,lr(t)),i=e.method||'pdf';'pdf'!==i&&'cdf'!==i&&F('Invalid density method: '+i),e.extent||a.data||F('Missing density extent parameter.'),i=a[i];var d=e.as||['value','density'],r=e.extent||s(a.data()),o=(r[1]-r[0])/(e.steps||100),l=f(r[0],r[1]+o/2,o).map(function(e){var t={};return t[d[0]]=e,t[d[1]]=i(e),md(t)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n};var IS=ee(sr,jd);IS.transform=function(e,t){var n=this.value,a=e.field,i=n[0],d=n[1],r=t.ADD,o;o=t.changed()||t.modified(a.fields)||e.modified('field'),o&&(r=t.SOURCE,i=+Infinity,d=-Infinity),t.visit(r,function(e){var t=a(e);t<i&&(i=t),t>d&&(d=t)}),this.value=[i,d]};var BS=ee(fr,wd);BS.connect=function(e){return this.targets().add(e),e.source=this},BS.add=function(e){this.value.add.push(e)},BS.rem=function(e){this.value.rem.push(e)},BS.mod=function(e){this.value.mod.push(e)},BS.init=function(e){this.value.init(e,e.NO_SOURCE)},BS.evaluate=function(){return this.value};var YS=ee(cr,jd);YS.activate=function(e){this._targets[this._targets.active++]=e},YS.subflow=function(e,t,n,a){var i=this.value,d=i.hasOwnProperty(e)&&i[e],r,o;return d?d.value.stamp<n.stamp&&(d.init(n),this.activate(d)):(o=a||(o=this._group[e])&&o.tuple,r=n.dataflow,d=r.add(new fr(n.fork(n.NO_SOURCE),this)).connect(t(r,e,o)),i[e]=d,this.activate(d)),d},YS.transform=function(e,t){function n(e){return i.subflow(e,r,t)}var a=t.dataflow,i=this,d=e.key,r=e.subflow,o=this._keys,l=e.modified('key');return this._group=e.group||{},this._targets.active=0,t.visit(t.ADD,function(e){var t=d(e);o.set(e._id,t),n(t).add(e)}),t.visit(t.REM,function(e){var t=o.get(e._id);o.delete(e._id),n(t).rem(e)}),l||t.modified(d.fields)?t.visit(t.MOD,function(e){var t=o.get(e._id),a=d(e);t===a?n(a).mod(e):(o.set(e._id,a),n(t).rem(e),n(a).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,function(e){n(o.get(e._id)).mod(e)}),l&&t.visit(t.REFLOW,function(e){var t=o.get(e._id),a=d(e);t!==a&&(o.set(e._id,a),n(t).rem(e),n(a).add(e))}),o.empty>a.cleanThreshold&&a.runAfter(o.clean),t},ee(pr,wd);var GS=ee(gr,jd);GS.transform=function(e,t){function n(n){var t=f(n,e),a=i.get(n._id);t&&a?(i.delete(n._id),r.push(n)):t||a?c&&t&&!a&&l.push(n):(i.set(n._id,1),o.push(n))}var a=t.dataflow,i=this.value,d=t.fork(),r=d.add,o=d.rem,l=d.mod,f=e.expr,c=!0;return t.visit(t.REM,function(e){i.has(e._id)?i.delete(e._id):o.push(e)}),t.visit(t.ADD,function(n){f(n,e)?r.push(n):i.set(n._id,1)}),t.visit(t.MOD,n),e.modified()&&(c=!1,t.visit(t.REFLOW,n)),i.empty>a.cleanThreshold&&a.runAfter(i.clean),d};var WS=ee(hr,jd);WS.transform=function(e,t){function a(e){for(var t=r[e._id]=Array(g),n=0,a;n<g;++n)a=t[n]=yd(e),a[c]=u[n],a[p]=l[n](e),h.add.push(a)}function d(e){for(var t=r[e._id],a=0,i;a<g;++a)m&1<<a&&(i=bd(e,t[a],n),i[c]=u[a],i[p]=l[a](e),h.mod.push(i))}var r=this.value,o=e.modified('fields'),l=e.fields,s=e.as||['key','value'],c=s[0],p=s[1],u=l.map(mr),g=l.length,n=t.stamp,h=t.fork(t.NO_SOURCE),f=0,m=0,i;if(o){for(i in r)h.rem.push.apply(h.rem,r[i]);r=this.value={},t.visit(t.SOURCE,a)}else{for(t.visit(t.ADD,a);f<g;++f)t.modified(l[f].fields)&&(m|=1<<f);m&&t.visit(t.MOD,d),t.visit(t.REM,function(e){h.rem.push.apply(h.rem,r[e._id]),r[e._id]=null})}return h.modifies(s)};var HS=ee(yr,jd);HS.transform=function(e,t){var n=e.expr,a=e.as,i=e.modified(),d=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),t.visit(d,function(i){i[a]=n(i,e)}).modifies(a)};var XS=ee(br,jd);XS.transform=function(e,n){var a=this.value,i=n.fork(n.ALL),d=e.size-a.length,r=e.generator,o,l,s;if(0<d){for(o=[];0<=--d;)o.push(s=md(r(e))),a.push(s);i.add=i.add.length?i.materialize(i.ADD).add.concat(o):o}else l=a.slice(0,-d),i.rem=i.rem.length?i.materialize(i.REM).rem.concat(l):l,a=a.slice(-d);return i.source=this.value=a,i};var VS={value:'value',median:function(e,t){var a=e.length,n=-1,i=[],d;if(null==t)for(;++n<a;)isNaN(d=l(e[n]))||i.push(d);else for(;++n<a;)isNaN(d=l(t(e[n],n,e)))||i.push(d);return h(i.sort(o),0.5)},mean:function(e,t){var a=e.length,n=a,d=-1,i=0,r;if(null==t)for(;++d<a;)isNaN(r=l(e[d]))?--n:i+=r;else for(;++d<a;)isNaN(r=l(t(e[d],d,e)))?--n:i+=r;return n?i/n:void 0},min:v,max:m},JS=[],ZS=ee(_r,jd);ZS.transform=function(e,a){var d=a.fork(a.ALL),r=xr(e),o=vr(e),s=q(e.field),f=e.groupby.map(q),c=e.orderby.map(q),p=wr(a.source,e.groupby,e.orderby),u=[],h=this.value,y=p.domain.length,m,b,_,x,v,g,i,k,l,n;for(v=0,k=p.length;v<k;++v)for(m=p[v],_=m.values,b=NaN,i=0;i<y;++i)if(null==m[i]){for(x=p.domain[i],n={_impute:!0},(g=0,l=_.length);g<l;++g)n[f[g]]=_[g];for(g=0,l=x.length;g<l;++g)n[c[g]]=x[g];n[s]=isNaN(b)?b=r(m,o):b,u.push(md(n))}return u.length&&(d.add=d.materialize(d.ADD).add.concat(u)),h.length&&(d.rem=d.materialize(d.REM).rem.concat(h)),this.value=u,d},ee(Sr,wd);var KS=ee(Cr,jd);KS.transform=function(e,t){var a=t,d=e.as,r=e.fields,o=e.index,i=e.values,l=null==e.default?null:e.default,s=e.modified(),f=s?t.SOURCE:t.ADD,c=r.length,n,p,u;return i?(p=i.length,1<c&&!d&&F('Multi-field lookup requires explicit "as" parameter.'),d&&d.length!==c*p&&F('The "as" parameter has too few output field names.'),d=d||i.map(q),n=function(e){for(var t=0,n=0,a,s;t<c;++t)if(s=o.get(r[t](e)),null==s)for(a=0;a<p;++a,++n)e[d[n]]=l;else for(a=0;a<p;++a,++n)e[d[n]]=i[a](s)}):(!d&&F('Missing output field names.'),n=function(e){for(var t=0,n;t<c;++t)n=o.get(r[t](e)),e[d[t]]=null==n?l:n}),s?a=t.reflow(!0):(u=r.some(function(e){return t.modified(e.fields)}),f|=u?t.MOD:0),t.visit(f,n),a.modifies(d)},ee(zr,wd),ee(Rr,wd),ee(Or,jd),Or.prototype.transform=function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)};var QS=ee(Pr,cr);QS.transform=function(e,n){var a=this,i=e.subflow,d=e.field;return e.modified('field')&&F('PreFacet does not support field modification.'),this._targets.active=0,n.visit(n.MOD,function(e){var t=a.subflow(e._id,i,n,e);d?d(e).forEach(function(e){t.mod(e)}):t.mod(e)}),n.visit(n.ADD,function(e){var t=a.subflow(e._id,i,n,e);d?d(e).forEach(function(e){t.add(md(e))}):t.add(e)}),n.visit(n.REM,function(e){var t=a.subflow(e._id,i,n,e);d?d(e).forEach(function(e){t.rem(e)}):t.rem(e)}),n};var eE=ee(Mr,jd);eE.transform=function(e,t){return this.value=e.value,e.modified('value')?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};var tE=ee(Dr,jd);tE.transform=function(e,t){t.source||F('Rank transform requires an upstream data source.');var a=e.normalize,i=e.field,d=e.as||'rank',r={},o=-1,n;return i?(t.visit(t.SOURCE,function(e){var t=i(e);null==r[t]&&(r[t]=++o)}),t.visit(t.SOURCE,a&&--o?function(e){e[d]=r[i(e)]/o}:function(e){e[d]=r[i(e)]})):(o+=t.source.length,n=-1,t.visit(t.SOURCE,a&&o?function(e){e[d]=++n/o}:function(e){e[d]=++n})),t.reflow(e.modified()).modifies(d)};var nE=ee(Lr,jd);nE.transform=function(e,t){var n=this.value||(a=t=t.addAll(),this.value={}),a;return e.derive&&(a=t.fork(),t.visit(t.ADD,function(e){var t=yd(e);n[e._id]=t,a.add.push(t)}),t.visit(t.MOD,function(e){a.mod.push(bd(e,n[e._id]))}),t.visit(t.REM,function(e){a.rem.push(n[e._id]),n[e._id]=null})),a};var aE=ee(qr,jd);aE.transform=function(e,t){function a(e){var t,n;l.length<o?l.push(e):(n=~~(s*Math.random()),n<l.length&&n>=f&&(t=l[n],c[t._id]&&d.rem.push(t),l[n]=e)),++s}var d=t.fork(),r=e.modified('size'),o=e.size,l=this.value,s=this.count,f=0,c=l.reduce(function(e,n){return e[n._id]=1,e},{});if(t.rem.length&&(t.visit(t.REM,function(e){c[e._id]&&(c[e._id]=-1,d.rem.push(e)),--s}),l=l.filter(function(e){return-1!==c[e._id]})),(t.rem.length||r)&&l.length<o&&t.source&&(f=s=l.length,t.visit(t.SOURCE,function(e){c[e._id]||a(e)}),f=-1),r&&l.length>o){for(var p=0,i=l.length-o;p<i;++p)c[l[p]._id]=-1,d.rem.push(l[p]);l=l.slice(i)}return t.mod.length&&t.visit(t.MOD,function(e){c[e._id]&&d.mod.push(e)}),t.add.length&&t.visit(t.ADD,a),(t.add.length||0>f)&&(d.add=l.filter(function(e){return!c[e._id]})),this.count=s,this.value=d.source=l,d};var iE=ee(Ur,jd);iE.transform=function(e,t){if(!this.value||e.modified()){var n=t.materialize().fork(t.MOD);return n.rem=this.value?t.rem.concat(this.value):t.rem,n.source=this.value=f(e.start,e.stop,e.step||1).map(md),n.add=t.add.concat(this.value),n}};var dE=ee(Fr,jd);dE.transform=function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};var rE=ee(jr,jd);rE.transform=function(e,t){function n(e){d.set(i(e),e)}var a=t.dataflow,i=e.field,d=this.value,r=!0;return e.modified('field')||t.modified(i.fields)?(d.clear(),t.visit(t.SOURCE,n)):t.changed()?(t.visit(t.REM,function(e){d.delete(i(e))}),t.visit(t.ADD,n)):r=!1,this.modified(r),d.empty>a.cleanThreshold&&a.runAfter(d.clean),t.fork()};var oE=ee($r,jd);oE.transform=function(e,t){var n=!this.value||e.modified('field')||e.modified('sort')||t.changed()||e.sort&&t.modified(e.sort.fields);n&&(this.value=(e.sort?t.source.slice().sort(e.sort):t.source).map(e.field))};var lE=[{key:{function:'normal'},params:[{name:'mean',type:'number',default:0},{name:'stdev',type:'number',default:1}]},{key:{function:'uniform'},params:[{name:'min',type:'number',default:0},{name:'max',type:'number',default:1}]},{key:{function:'kde'},params:[{name:'field',type:'field',required:!0},{name:'from',type:'data'},{name:'bandwidth',type:'number',default:0}]}],sE={type:'Density',metadata:{generates:!0,source:!0},params:[{name:'extent',type:'number',array:!0,length:2},{name:'steps',type:'number',default:100},{name:'method',type:'string',default:'pdf',values:['pdf','cdf']},{name:'distribution',type:'param',params:lE.concat({key:{function:'mixture'},params:[{name:'distributions',type:'param',array:!0,params:lE},{name:'weights',type:'number',array:!0}]})},{name:'as',type:'string',array:!0,default:['value','density']}]};$d({type:'Aggregate',metadata:{generates:!0,changes:!0},params:[{name:'groupby',type:'field',array:!0},{name:'fields',type:'field',array:!0},{name:'ops',type:'enum',array:!0,values:['count','valid','missing','distinct','sum','mean','average','variance','variancep','stdev','stdevp','stderr','median','q1','q3','ci0','ci1','min','max','argmin','argmax']},{name:'as',type:'string',array:!0},{name:'drop',type:'boolean',default:!0},{name:'cross',type:'boolean',default:!1},{name:'key',type:'field'}]},Vd),$d({type:'Bin',metadata:{modifies:!0},params:[{name:'field',type:'field',required:!0},{name:'anchor',type:'number'},{name:'maxbins',type:'number',default:20},{name:'base',type:'number',default:10},{name:'divide',type:'number',array:!0,default:[5,2]},{name:'extent',type:'number',array:!0,length:2,required:!0},{name:'step',type:'number'},{name:'steps',type:'number',array:!0},{name:'minstep',type:'number',default:0},{name:'nice',type:'boolean',default:!0},{name:'name',type:'string'},{name:'as',type:'string',array:!0,length:2,default:['bin0','bin1']}]},Kd),$d({type:'Collect',metadata:{source:!0},params:[{name:'sort',type:'compare'}]},Qd),$d({type:'CountPattern',metadata:{generates:!0,changes:!0},params:[{name:'field',type:'field',required:!0},{name:'case',type:'enum',values:['upper','lower','mixed'],default:'mixed'},{name:'pattern',type:'string',default:'[\\w"]+'},{name:'stopwords',type:'string',default:''},{name:'as',type:'string',array:!0,length:2,default:['text','count']}]},nr),$d({type:'Cross',metadata:{source:!0,generates:!0,changes:!0},params:[{name:'filter',type:'expr'},{name:'as',type:'string',array:!0,length:2,default:['a','b']}]},ir),$d(sE,or),$d({type:'Extent',metadata:{},params:[{name:'field',type:'field',required:!0}]},sr),$d({type:'Filter',metadata:{changes:!0},params:[{name:'expr',type:'expr',required:!0}]},gr),$d({type:'Fold',metadata:{generates:!0,changes:!0},params:[{name:'fields',type:'field',array:!0,required:!0},{name:'as',type:'string',array:!0,length:2,default:['key','value']}]},hr),$d({type:'Formula',metadata:{modifies:!0},params:[{name:'expr',type:'expr',required:!0},{name:'as',type:'string',required:!0},{name:'initonly',type:'boolean'}]},yr),$d({type:'Impute',metadata:{changes:!0},params:[{name:'field',type:'field',required:!0},{name:'groupby',type:'field',array:!0},{name:'orderby',type:'field',array:!0},{name:'method',type:'enum',default:'value',values:['value','mean','median','max','min']},{name:'value',default:0}]},_r),$d({type:'Lookup',metadata:{modifies:!0},params:[{name:'index',type:'index',params:[{name:'from',type:'data',required:!0},{name:'key',type:'field',required:!0}]},{name:'values',type:'field',array:!0},{name:'fields',type:'field',array:!0,required:!0},{name:'as',type:'string',array:!0},{name:'default',default:null}]},Cr),$d({type:'Rank',metadata:{modifies:!0},params:[{name:'field',type:'field'},{name:'normalize',type:'boolean',default:!1},{name:'as',type:'string',default:'rank'}]},Dr),$d({type:'Sample',metadata:{source:!0,changes:!0},params:[{name:'size',type:'number',default:1000}]},qr),$d({type:'Sequence',metadata:{generates:!0,source:!0},params:[{name:'start',type:'number',required:!0},{name:'stop',type:'number',required:!0},{name:'step',type:'number',default:1}],output:['value']},Ur),Id('Compare',er),Id('Facet',cr),Id('Field',pr),Id('Generate',br),Id('Key',Sr),Id('MultiExtent',zr),Id('MultiValues',Rr),Id('Params',Or),Id('PreFacet',Pr),Id('Proxy',Mr),Id('Relay',Lr),Id('Sieve',Fr),Id('Subflow',fr),Id('TupleIndex',jr),Id('Values',$r);var fE=Array.prototype,cE=fE.map,pE=fE.slice,uE={name:'implicit'},gE=0.7,hE=1/gE,mE=/^#([0-9a-f]{3})$/,yE=/^#([0-9a-f]{6})$/,bE=/^rgb\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*\)$/,_E=/^rgb\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,xE=/^rgba\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,vE=/^rgba\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,kE=/^hsl\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,wE=/^hsla\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,SE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Gr(Hr,Xr,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+''}}),Gr(Qr,Kr,Wr(Hr,{brighter:function(e){return e=null==e?hE:Qx(hE,e),new Qr(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?gE:Qx(gE,e),new Qr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&255>=this.r&&0<=this.g&&255>=this.g&&0<=this.b&&255>=this.b&&0<=this.opacity&&1>=this.opacity},toString:function(){var e=this.opacity;return e=isNaN(e)?1:nv(0,Zx(1,e)),(1===e?'rgb(':'rgba(')+nv(0,Zx(255,ev(this.r)||0))+', '+nv(0,Zx(255,ev(this.g)||0))+', '+nv(0,Zx(255,ev(this.b)||0))+(1===e?')':', '+e+')')}})),Gr(ao,no,Wr(Hr,{brighter:function(e){return e=null==e?hE:Qx(hE,e),new ao(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?gE:Qx(gE,e),new ao(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(0>this.h),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(0.5>n?n:1-n)*t,i=2*n-a;return new Qr(io(240<=e?e-240:e+120,i,a),io(e,i,a),io(120>e?e+240:e-120,i,a),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity}}));var EE=Gx/180,CE=180/Gx,zE=18,Kn=0.95047,Xn=1,Yn=1.08883,Zn=4/29,TE=6/29,RE=3*TE*TE,AE=TE*TE*TE;Gr(lo,oo,Wr(Hr,{brighter:function(e){return new lo(this.l+zE*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new lo(this.l-zE*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return e=Xn*fo(e),t=Kn*fo(t),n=Yn*fo(n),new Qr(co(3.2404542*t-1.5371385*e-0.4985314*n),co(-0.969266*t+1.8760108*e+0.041556*n),co(0.0556434*t-0.2040259*e+1.0572252*n),this.opacity)}})),Gr(ho,go,Wr(Hr,{brighter:function(e){return new ho(this.h,this.c,this.l+zE*(null==e?1:e),this.opacity)},darker:function(e){return new ho(this.h,this.c,this.l-zE*(null==e?1:e),this.opacity)},rgb:function(){return ro(this).rgb()}}));var OE=-0.14861,A=+1.78277,B=-0.29227,C=-0.90649,D=+1.97294,E=D*C,PE=D*A,ME=A*B-C*OE;Gr(bo,yo,Wr(Hr,{brighter:function(e){return e=null==e?hE:Qx(hE,e),new bo(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?gE:Qx(gE,e),new bo(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*EE,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),a=Bx(e),i=Ix(e);return new Qr(255*(t+n*(OE*a+A*i)),255*(t+n*(B*a+C*i)),255*(t+n*(D*a)),this.opacity)}}));var DE=function e(t){function n(e,t){var n=a((e=Kr(e)).r,(t=Kr(t)).r),i=a(e.g,t.g),d=a(e.b,t.b),r=zo(e.opacity,t.opacity);return function(a){return e.r=n(a),e.g=i(a),e.b=d(a),e.opacity=r(a),e+''}}var a=Co(t);return n.gamma=e,n}(1),LE=To(xo),qE=To(vo),UE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,FE=new RegExp(UE.source,'g'),jE=180/Gx,$E={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},NE=jo(function(e){return'none'===e?$E:(re||(re=document.createElement('DIV'),nC=document.documentElement,aC=document.defaultView),re.style.transform=e,e=aC.getComputedStyle(nC.appendChild(re),null).getPropertyValue('transform'),nC.removeChild(re),e=e.slice(7,-1).split(','),Fo(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},'px, ','px)','deg)'),IE=jo(function(e){return null==e?$E:(iC||(iC=document.createElementNS('http://www.w3.org/2000/svg','g')),iC.setAttribute('transform',e),!(e=iC.transform.baseVal.consolidate()))?$E:(e=e.matrix,Fo(e.a,e.b,e.c,e.d,e.e,e.f))},', ',')',')'),BE=Yx,YE=2,GE=4,WE=Bo(Eo),HE=Bo(zo),XE=Yo(Eo),VE=Yo(zo),JE=Go(Eo),ZE=Go(zo),KE=Object.freeze({interpolate:qo,interpolateArray:Ro,interpolateBasis:xo,interpolateBasisClosed:vo,interpolateDate:Ao,interpolateNumber:Oo,interpolateObject:Po,interpolateRound:Uo,interpolateString:Lo,interpolateTransformCss:NE,interpolateTransformSvg:IE,interpolateZoom:function(e,t){var n=e[0],a=e[1],d=e[2],r=t[0],o=t[1],l=t[2],f=r-n,c=o-a,s=f*f+c*c,p,i;if(s<1e-12)i=av(l/d)/BE,p=function(e){return[n+e*f,a+e*c,d*Wx(BE*e*i)]};else{var g=Hx(s),u=(l*l-d*d+GE*s)/(2*d*YE*g),h=(l*l-d*d-GE*s)/(2*l*YE*g),m=av(Hx(u*u+1)-u),y=av(Hx(h*h+1)-h);i=(y-m)/BE,p=function(e){var t=e*i,r=$o(m),o=d/(YE*g)*(r*Io(BE*t+m)-No(m));return[n+o*f,a+o*c,d*r/$o(BE*t+m)]}}return p.duration=1e3*i,p},interpolateRgb:DE,interpolateRgbBasis:LE,interpolateRgbBasisClosed:qE,interpolateHsl:WE,interpolateHslLong:HE,interpolateLab:function(e,t){var n=zo((e=oo(e)).l,(t=oo(t)).l),i=zo(e.a,t.a),a=zo(e.b,t.b),d=zo(e.opacity,t.opacity);return function(r){return e.l=n(r),e.a=i(r),e.b=a(r),e.opacity=d(r),e+''}},interpolateHcl:XE,interpolateHclLong:VE,interpolateCubehelix:JE,interpolateCubehelixLong:ZE,quantize:function(e,t){for(var n=Array(t),a=0;a<t;++a)n[a]=e(a/(t-1));return n}}),QE=[0,1],eC={"":function(e,t){e=e.toPrecision(t);out:for(var a=e.length,n=1,i=-1,d;n<a;++n)switch(e[n]){case'.':i=d=n;break;case'0':0===i&&(i=n),d=n;break;case'e':break out;default:0<i&&(i=0);}return 0<i?e.slice(0,i)+e.slice(d+1):e},"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return ev(e).toString(2)},c:function(e){return e+''},d:function(e){return ev(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return ev(e).toString(8)},p:function(e,t){return dl(100*e,t)},r:dl,s:function(e,t){var a=tl(e,t);if(!a)return e+'';var r=a[0],o=a[1],l=o-(dC=3*nv(-8,Zx(8,Kx(o/3))))+1,i=r.length;return l===i?r:l>i?r+Array(l-i+1).join('0'):0<l?r.slice(0,l)+'.'+r.slice(l):'0.'+Array(1-l).join('0')+tl(e,nv(0,t+l-1))[0]},X:function(e){return ev(e).toString(16).toUpperCase()},x:function(e){return ev(e).toString(16)}},tC=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i,re,nC,aC,iC,dC;rl.prototype=ol.prototype,ol.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?'0':'')+(null==this.width?'':nv(1,0|this.width))+(this.comma?',':'')+(null==this.precision?'':'.'+nv(0,0|this.precision))+this.type};var rC=['y','z','a','f','p','n','\xB5','m','','k','M','G','T','P','E','Z','Y'],oC,lC,sC;fl({decimal:'.',thousands:',',grouping:[3],currency:['$','']});var fC=1e3,cC=60*fC,pC=60*cC,uC=24*pC,gC=7*uC,hC=30*uC,mC=365*uC,yC=Dl('1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf'),bC=Dl('393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6'),_C=Dl('3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9'),xC=Dl('1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5');ZE(yo(300,0.5,0),yo(-240,0.5,1));var vC=ZE(yo(-100,0.75,0.35),yo(80,1.5,0.8)),kC=ZE(yo(260,0.75,0.35),yo(80,1.5,0.8)),wC=yo(),SC=Ll(Dl('44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725')),EC=Ll(Dl('00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf')),CC=Ll(Dl('00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4')),zC=Ll(Dl('0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921')),TC=Array.prototype.map,RC=Array.prototype.slice,AC={identity:yl,linear:ml,log:El,ordinal:Yr,pow:zl,sqrt:function(){return zl().exponent(0.5)},quantile:Tl,quantize:Rl,threshold:Al,time:function(){return Ml(Vv,Xv,Wv,Gv,Yv,Bv,Iv,qv,lk).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},utc:function(){return Ml(nk,tk,Qv,Kv,Zv,Jv,Iv,qv,fk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},band:ql,point:function(){return Ul(ql().paddingInner(1))},sequential:Nl,"bin-linear":jl,"bin-ordinal":$l};for(var OC in AC)Bl(OC,AC[OC]);var PC=Yl('4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac'),MC=Yl('4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5'),DC=[,,,].concat('67a9cff7f7f7f1a340','0571b092c5defdb863e66101','0571b092c5def7f7f7fdb863e66101','2166ac67a9cfd1e5f0fee0b6f1a340b35806','2166ac67a9cfd1e5f0f7f7f7fee0b6f1a340b35806','2166ac4393c392c5ded1e5f0fee0b6fdb863e08214b35806','2166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b35806','0530612166ac4393c392c5ded1e5f0fee0b6fdb863e08214b358067f3b08','0530612166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b358067f3b08').map(Yl),LC=Gl('7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666'),qC=Gl('1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666'),UC=Gl('a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928'),FC=Gl('fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2'),jC=Gl('b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc'),$C=Gl('e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999'),NC=Gl('66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3'),IC=Gl('8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f'),BC=[,,,].concat('d8b365f5f5f55ab4ac','a6611adfc27d80cdc1018571','a6611adfc27df5f5f580cdc1018571','8c510ad8b365f6e8c3c7eae55ab4ac01665e','8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e','8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e','8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e','5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30','5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30').map(Gl),YC=Wl(BC),GC=[,,,].concat('af8dc3f7f7f77fbf7b','7b3294c2a5cfa6dba0008837','7b3294c2a5cff7f7f7a6dba0008837','762a83af8dc3e7d4e8d9f0d37fbf7b1b7837','762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837','762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837','762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837','40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b','40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b').map(Gl),WC=Wl(GC),HC=[,,,].concat('e9a3c9f7f7f7a1d76a','d01c8bf1b6dab8e1864dac26','d01c8bf1b6daf7f7f7b8e1864dac26','c51b7de9a3c9fde0efe6f5d0a1d76a4d9221','c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221','c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221','c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221','8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419','8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419').map(Gl),XC=Wl(HC),VC=[,,,].concat('998ec3f7f7f7f1a340','5e3c99b2abd2fdb863e66101','5e3c99b2abd2f7f7f7fdb863e66101','542788998ec3d8daebfee0b6f1a340b35806','542788998ec3d8daebf7f7f7fee0b6f1a340b35806','5427888073acb2abd2d8daebfee0b6fdb863e08214b35806','5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806','2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08','2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08').map(Gl),JC=Wl(VC),ZC=[,,,].concat('ef8a62f7f7f767a9cf','ca0020f4a58292c5de0571b0','ca0020f4a582f7f7f792c5de0571b0','b2182bef8a62fddbc7d1e5f067a9cf2166ac','b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac','b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac','b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac','67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061','67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061').map(Gl),KC=Wl(ZC),QC=[,,,].concat('ef8a62ffffff999999','ca0020f4a582bababa404040','ca0020f4a582ffffffbababa404040','b2182bef8a62fddbc7e0e0e09999994d4d4d','b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d','b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d','b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d','67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a','67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a').map(Gl),ez=Wl(QC),tz=[,,,].concat('fc8d59ffffbf91bfdb','d7191cfdae61abd9e92c7bb6','d7191cfdae61ffffbfabd9e92c7bb6','d73027fc8d59fee090e0f3f891bfdb4575b4','d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4','d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4','d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4','a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695','a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695').map(Gl),nz=Wl(tz),az=[,,,].concat('fc8d59ffffbf91cf60','d7191cfdae61a6d96a1a9641','d7191cfdae61ffffbfa6d96a1a9641','d73027fc8d59fee08bd9ef8b91cf601a9850','d73027fc8d59fee08bffffbfd9ef8b91cf601a9850','d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850','d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850','a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837','a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837').map(Gl),iz=Wl(az),dz=[,,,].concat('fc8d59ffffbf99d594','d7191cfdae61abdda42b83ba','d7191cfdae61ffffbfabdda42b83ba','d53e4ffc8d59fee08be6f59899d5943288bd','d53e4ffc8d59fee08bffffbfe6f59899d5943288bd','d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd','d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd','9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2','9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2').map(Gl),rz=Wl(dz),oz=[,,,].concat('e5f5f999d8c92ca25f','edf8fbb2e2e266c2a4238b45','edf8fbb2e2e266c2a42ca25f006d2c','edf8fbccece699d8c966c2a42ca25f006d2c','edf8fbccece699d8c966c2a441ae76238b45005824','f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824','f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b').map(Gl),lz=Wl(oz),sz=[,,,].concat('e0ecf49ebcda8856a7','edf8fbb3cde38c96c688419d','edf8fbb3cde38c96c68856a7810f7c','edf8fbbfd3e69ebcda8c96c68856a7810f7c','edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b','f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b','f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b').map(Gl),fz=Wl(sz),cz=[,,,].concat('e0f3dba8ddb543a2ca','f0f9e8bae4bc7bccc42b8cbe','f0f9e8bae4bc7bccc443a2ca0868ac','f0f9e8ccebc5a8ddb57bccc443a2ca0868ac','f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e','f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e','f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081').map(Gl),pz=Wl(cz),uz=[,,,].concat('fee8c8fdbb84e34a33','fef0d9fdcc8afc8d59d7301f','fef0d9fdcc8afc8d59e34a33b30000','fef0d9fdd49efdbb84fc8d59e34a33b30000','fef0d9fdd49efdbb84fc8d59ef6548d7301f990000','fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000','fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000').map(Gl),gz=Wl(uz),hz=[,,,].concat('ece2f0a6bddb1c9099','f6eff7bdc9e167a9cf02818a','f6eff7bdc9e167a9cf1c9099016c59','f6eff7d0d1e6a6bddb67a9cf1c9099016c59','f6eff7d0d1e6a6bddb67a9cf3690c002818a016450','fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450','fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636').map(Gl),mz=Wl(hz),yz=[,,,].concat('ece7f2a6bddb2b8cbe','f1eef6bdc9e174a9cf0570b0','f1eef6bdc9e174a9cf2b8cbe045a8d','f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d','f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b','fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b','fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858').map(Gl),bz=Wl(yz),_z=[,,,].concat('e7e1efc994c7dd1c77','f1eef6d7b5d8df65b0ce1256','f1eef6d7b5d8df65b0dd1c77980043','f1eef6d4b9dac994c7df65b0dd1c77980043','f1eef6d4b9dac994c7df65b0e7298ace125691003f','f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f','f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f').map(Gl),xz=Wl(_z),vz=[,,,].concat('fde0ddfa9fb5c51b8a','feebe2fbb4b9f768a1ae017e','feebe2fbb4b9f768a1c51b8a7a0177','feebe2fcc5c0fa9fb5f768a1c51b8a7a0177','feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177','fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177','fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a').map(Gl),kz=Wl(vz),wz=[,,,].concat('edf8b17fcdbb2c7fb8','ffffcca1dab441b6c4225ea8','ffffcca1dab441b6c42c7fb8253494','ffffccc7e9b47fcdbb41b6c42c7fb8253494','ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84','ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84','ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58').map(Gl),Sz=Wl(wz),Ez=[,,,].concat('f7fcb9addd8e31a354','ffffccc2e69978c679238443','ffffccc2e69978c67931a354006837','ffffccd9f0a3addd8e78c67931a354006837','ffffccd9f0a3addd8e78c67941ab5d238443005a32','ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32','ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529').map(Gl),Cz=Wl(Ez),zz=[,,,].concat('fff7bcfec44fd95f0e','ffffd4fed98efe9929cc4c02','ffffd4fed98efe9929d95f0e993404','ffffd4fee391fec44ffe9929d95f0e993404','ffffd4fee391fec44ffe9929ec7014cc4c028c2d04','ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04','ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506').map(Gl),Tz=Wl(zz),Rz=[,,,].concat('ffeda0feb24cf03b20','ffffb2fecc5cfd8d3ce31a1c','ffffb2fecc5cfd8d3cf03b20bd0026','ffffb2fed976feb24cfd8d3cf03b20bd0026','ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026','ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026','ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026').map(Gl),Az=Wl(Rz),Oz=[,,,].concat('deebf79ecae13182bd','eff3ffbdd7e76baed62171b5','eff3ffbdd7e76baed63182bd08519c','eff3ffc6dbef9ecae16baed63182bd08519c','eff3ffc6dbef9ecae16baed64292c62171b5084594','f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594','f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b').map(Gl),Pz=Wl(Oz),Mz=[,,,].concat('e5f5e0a1d99b31a354','edf8e9bae4b374c476238b45','edf8e9bae4b374c47631a354006d2c','edf8e9c7e9c0a1d99b74c47631a354006d2c','edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32','f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32','f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b').map(Gl),Dz=Wl(Mz),Lz=[,,,].concat('f0f0f0bdbdbd636363','f7f7f7cccccc969696525252','f7f7f7cccccc969696636363252525','f7f7f7d9d9d9bdbdbd969696636363252525','f7f7f7d9d9d9bdbdbd969696737373525252252525','fffffff0f0f0d9d9d9bdbdbd969696737373525252252525','fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000').map(Gl),qz=Wl(Lz),Uz=[,,,].concat('efedf5bcbddc756bb1','f2f0f7cbc9e29e9ac86a51a3','f2f0f7cbc9e29e9ac8756bb154278f','f2f0f7dadaebbcbddc9e9ac8756bb154278f','f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486','fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486','fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d').map(Gl),Fz=Wl(Uz),jz=[,,,].concat('fee0d2fc9272de2d26','fee5d9fcae91fb6a4acb181d','fee5d9fcae91fb6a4ade2d26a50f15','fee5d9fcbba1fc9272fb6a4ade2d26a50f15','fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d','fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d','fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d').map(Gl),$z=Wl(jz),Nz=[,,,].concat('fee6cefdae6be6550d','feeddefdbe85fd8d3cd94701','feeddefdbe85fd8d3ce6550da63603','feeddefdd0a2fdae6bfd8d3ce6550da63603','feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04','fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04','fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704').map(Gl),Iz=Wl(Nz),Bz=Object.freeze({schemeAccent:LC,schemeDark2:qC,schemePaired:UC,schemePastel1:FC,schemePastel2:jC,schemeSet1:$C,schemeSet2:NC,schemeSet3:IC,interpolateBrBG:YC,schemeBrBG:BC,interpolatePRGn:WC,schemePRGn:GC,interpolatePiYG:XC,schemePiYG:HC,interpolatePuOr:JC,schemePuOr:VC,interpolateRdBu:KC,schemeRdBu:ZC,interpolateRdGy:ez,schemeRdGy:QC,interpolateRdYlBu:nz,schemeRdYlBu:tz,interpolateRdYlGn:iz,schemeRdYlGn:az,interpolateSpectral:rz,schemeSpectral:dz,interpolateBuGn:lz,schemeBuGn:oz,interpolateBuPu:fz,schemeBuPu:sz,interpolateGnBu:pz,schemeGnBu:cz,interpolateOrRd:gz,schemeOrRd:uz,interpolatePuBuGn:mz,schemePuBuGn:hz,interpolatePuBu:bz,schemePuBu:yz,interpolatePuRd:xz,schemePuRd:_z,interpolateRdPu:kz,schemeRdPu:vz,interpolateYlGnBu:Sz,schemeYlGnBu:wz,interpolateYlGn:Cz,schemeYlGn:Ez,interpolateYlOrBr:Tz,schemeYlOrBr:zz,interpolateYlOrRd:Az,schemeYlOrRd:Rz,interpolateBlues:Pz,schemeBlues:Oz,interpolateGreens:Dz,schemeGreens:Mz,interpolateGreys:qz,schemeGreys:Lz,interpolatePurples:Fz,schemePurples:Uz,interpolateReds:$z,schemeReds:jz,interpolateOranges:Iz,schemeOranges:Nz}),_={blueorange:DC},Yz={category10:yC,category20:xC,category20b:bC,category20c:_C,accent:LC,dark2:qC,paired:UC,pastel1:FC,pastel2:jC,set1:$C,set2:NC,set3:IC,tableau10:PC,tableau20:MC,viridis:SC,magma:EC,inferno:CC,plasma:zC,blueorange:LE(fe(DC))};Hl('blues','Blues'),Hl('greens','Greens'),Hl('greys','Greys'),Hl('purples','Purples'),Hl('reds','Reds'),Hl('oranges','Oranges'),Hl('brownbluegreen','BrBG'),Hl('purplegreen','PRGn'),Hl('pinkyellowgreen','PiYG'),Hl('purpleorange','PuOr'),Hl('redblue','RdBu'),Hl('redgrey','RdGy'),Hl('redyellowblue','RdYlBu'),Hl('redyellowgreen','RdYlGn'),Hl('spectral','Spectral'),Hl('bluegreen','BuGn'),Hl('bluepurple','BuPu'),Hl('greenblue','GnBu'),Hl('orangered','OrRd'),Hl('purplebluegreen','PuBuGn'),Hl('purpleblue','PuBu'),Hl('purplered','PuRd'),Hl('redpurple','RdPu'),Hl('yellowgreenblue','YlGnBu'),Hl('yellowgreen','YlGn'),Hl('yelloworangebrown','YlOrBr'),Hl('yelloworangered','YlOrRd');var Gz=Array.prototype,Wz=Gz.slice,Hz=[[],[[[1,1.5],[0.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[0.5,1]]],[[[1,0.5],[1.5,1]]],[[[1,0.5],[0.5,1]],[[1,1.5],[1.5,1]]],[[[1,0.5],[1,1.5]]],[[[1,0.5],[0.5,1]]],[[[0.5,1],[1,0.5]]],[[[1,1.5],[1,0.5]]],[[[0.5,1],[1,1.5]],[[1.5,1],[1,0.5]]],[[[1.5,1],[1,0.5]]],[[[0.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[0.5,1],[1,1.5]]],[]],Xz=['values','size','thresholds'],Vz=['x','y','size','cellSize','bandwidth','thresholds'],Jz=ee(ms,jd);Jz.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a,i,d;return e.values?(a=fs(),i=Xz,d=e.values):(a=hs(),i=Vz,d=t.materialize(t.SOURCE).source),i.forEach(function(t){null!=e[t]&&a[t](e[t])}),this.value&&(n.rem=this.value),this.value=n.source=n.add=a(d).map(md),n},bs.prototype={constructor:bs,reset:function(){this.s=this.t=0},add:function(e){_s(Zz,e,this.t),_s(this,Zz.s,this.s),this.s?this.t+=Zz.t:this.s=Zz.t},valueOf:function(){return this.s}};var Zz=new bs,Kz=1e-6,Qz=Gx,eT=Qz/2,tT=Qz/4,nT=2*Qz,aT=180/Qz,iT=Qz/180,dT=Vx,rT=Ux,oT=jx,lT=Bx,sT=tv,fT=Wx,cT=av,pT=Qx,uT=Ix,gT=Math.sign||function(e){return 0<e?1:0>e?-1:0},hT=Hx,mT=$x,yT={Feature:function(e,t){ws(e.geometry,t)},FeatureCollection:function(e,t){for(var a=e.features,d=-1,i=a.length;++d<i;)ws(a[d].geometry,t)}},bT={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var a=e.coordinates,d=-1,i=a.length;++d<i;)e=a[d],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ss(e.coordinates,t,0)},MultiLineString:function(e,t){for(var a=e.coordinates,d=-1,i=a.length;++d<i;)Ss(a[d],t,0)},Polygon:function(e,t){Es(e.coordinates,t)},MultiPolygon:function(e,t){for(var a=e.coordinates,d=-1,i=a.length;++d<i;)Es(a[d],t)},GeometryCollection:function(e,t){for(var a=e.geometries,d=-1,i=a.length;++d<i;)ws(a[d],t)}},_T=ys(),xT=ys(),vT={point:ks,lineStart:ks,lineEnd:ks,polygonStart:function(){_T.reset(),vT.lineStart=zs,vT.lineEnd=Ts},polygonEnd:function(){var e=+_T;xT.add(0>e?nT+e:e),this.lineStart=this.lineEnd=this.point=ks},sphere:function(){xT.add(nT)}},kT=ys(),wT={point:Fs,lineStart:$s,lineEnd:Ns,polygonStart:function(){wT.point=Is,wT.lineStart=Bs,wT.lineEnd=Ys,kT.reset(),vT.polygonStart()},polygonEnd:function(){vT.polygonEnd(),wT.point=Fs,wT.lineStart=$s,wT.lineEnd=Ns,0>_T?(AT=-(PT=180),OT=-(MT=90)):kT>Kz?MT=90:kT<-Kz&&(OT=-90),jT[0]=AT,jT[1]=PT}},ST={sphere:ks,point:Ws,lineStart:Xs,lineEnd:Zs,polygonStart:function(){ST.lineStart=Ks,ST.lineEnd=Qs},polygonEnd:function(){ST.lineStart=Xs,ST.lineEnd=Zs}},ET,CT,zT,TT,RT,AT,OT,PT,MT,DT,LT,qT,UT,FT,jT,$T,NT,IT,BT,YT,WT,HT,XT,VT,JT,ZT,KT,QT,eR,tR,nR;af.invert=af;var aR=1e9,iR=-aR,dR=ys(),rR=ys(),oR={sphere:ks,point:ks,lineStart:function(){oR.point=vf,oR.lineEnd=xf},lineEnd:ks,polygonStart:ks,polygonEnd:ks},lR=ys(),sR=ys(),fR={point:ks,lineStart:ks,lineEnd:ks,polygonStart:function(){fR.lineStart=zf,fR.lineEnd=Af},polygonEnd:function(){fR.lineStart=fR.lineEnd=fR.point=ks,lR.add(dT(sR)),sR.reset()},result:function(){return lR.reset(),lR/2}},cR=Infinity,pR=cR,uR=-cR,gR=uR,hR={point:function(e,t){e<cR&&(cR=e),e>uR&&(uR=e),t<pR&&(pR=t),t>gR&&(gR=t)},lineStart:ks,lineEnd:ks,polygonStart:ks,polygonEnd:ks,result:function(){var e=[[cR,pR],[uR,gR]];return uR=gR=-(pR=cR=Infinity),e}},mR=0,yR=0,bR=0,_R=0,xR=0,vR=0,kR=0,wR=0,SR=0,ER={point:Of,lineStart:Pf,lineEnd:Lf,polygonStart:function(){ER.lineStart=qf,ER.lineEnd=Uf},polygonEnd:function(){ER.point=Of,ER.lineStart=Pf,ER.lineEnd=Lf},result:function(){var e=SR?[kR/SR,wR/SR]:vR?[_R/vR,xR/vR]:bR?[mR/bR,yR/bR]:[NaN,NaN];return mR=yR=bR=_R=xR=vR=kR=wR=SR=0,e}},CR,zR,TR,RR,AR,OR,PR,MR,DR,LR,qR;$f.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,nT);break}}},result:ks};var UR=ys(),FR={point:ks,lineStart:function(){FR.point=Nf},lineEnd:function(){jR&&If($R,NR),FR.point=ks},polygonStart:function(){jR=!0},polygonEnd:function(){jR=null},result:function(){return UR.reset(),+UR}},jR,$R,NR,IR,BR;Bf.prototype={_circle:Yf(4.5),pointRadius:function(e){return this._circle=Yf(e),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push('Z'),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push('M',e,',',t),this._point=1;break}case 1:{this._string.push('L',e,',',t);break}default:{this._string.push('M',e,',',t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join('');return this._string=[],e}}};var YR=Wf(function(){return!0},function(e){var t=NaN,n=NaN,a=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(d,r){var o=0<d?Qz:-Qz,l=dT(d-t);dT(l-Qz)<Kz?(e.point(t,n=0<(n+r)/2?eT:-eT),e.point(a,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(d,n),i=0):a!==o&&l>=Qz&&(dT(t-a)<Kz&&(t-=a*Kz),dT(d-o)<Kz&&(d-=o*Kz),n=Vf(t,n,d,r),e.point(a,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=d,n=r),a=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}},function(e,t,n,a){var i;if(null==e)i=n*eT,a.point(-Qz,i),a.point(0,i),a.point(Qz,i),a.point(Qz,0),a.point(Qz,-i),a.point(0,-i),a.point(-Qz,-i),a.point(-Qz,0),a.point(-Qz,i);else if(dT(e[0]-t[0])>Kz){var d=e[0]<t[0]?Qz:-Qz;i=n*d/2,a.point(-d,i),a.point(0,i),a.point(d,i)}else a.point(t[0],t[1])},[-Qz,-eT]);Kf.prototype={constructor:Kf,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var GR=16,WR=lT(30*iT),HR=Zf({point:function(e,t){this.stream.point(e*iT,t*iT)}}),XR=pc(function(e){return hT(2/(1+e))});XR.invert=uc(function(e){return 2*vs(e/2)});var VR=pc(function(e){return(e=xs(e))&&e/uT(e)});VR.invert=uc(function(e){return e}),gc.invert=function(e,t){return[e,2*rT(fT(t))-eT]},bc.invert=bc,xc.invert=uc(rT),vc.invert=uc(vs),kc.invert=uc(function(e){return 2*rT(e)}),wc.invert=function(e,t){return[-t,2*rT(fT(e))-eT]};var JR=Gf(),ZR=['clipAngle','clipExtent','scale','translate','center','rotate','parallels','precision','coefficient','distance','fraction','lobes','parallel','radius','ratio','spacing','tilt'],KR={albers:fc,albersusa:function(){function e(e){var t=e[0],n=e[1];return c=null,(l.point(t,n),c)||(s.point(t,n),c)||(f.point(t,n),c)}function t(){return r=o=null,e}var n=fc(),a=sc().rotate([154,0]).center([-2,58.5]).parallels([55,65]),i=sc().rotate([157,0]).center([-3,19.9]).parallels([8,18]),d={point:function(e,t){c=[e,t]}},r,o,l,s,f,c;return e.invert=function(e){var d=n.scale(),r=n.translate(),t=(e[0]-r[0])/d,o=(e[1]-r[1])/d;return(0.12<=o&&0.234>o&&-0.425<=t&&-0.214>t?a:0.166<=o&&0.234>o&&-0.214<=t&&-0.115>t?i:n).invert(e)},e.stream=function(e){return r&&o===e?r:r=cc([n.stream(o=e),a.stream(e),i.stream(e)])},e.precision=function(e){return arguments.length?(n.precision(e),a.precision(e),i.precision(e),t()):n.precision()},e.scale=function(t){return arguments.length?(n.scale(t),a.scale(0.35*t),i.scale(t),e.translate(n.translate())):n.scale()},e.translate=function(e){if(!arguments.length)return n.translate();var r=n.scale(),o=+e[0],c=+e[1];return l=n.translate(e).clipExtent([[o-0.455*r,c-0.238*r],[o+0.455*r,c+0.238*r]]).stream(d),s=a.translate([o-0.307*r,c+0.201*r]).clipExtent([[o-0.425*r+Kz,c+0.12*r+Kz],[o-0.214*r-Kz,c+0.234*r-Kz]]).stream(d),f=i.translate([o-0.205*r,c+0.212*r]).clipExtent([[o-0.214*r+Kz,c+0.166*r+Kz],[o-0.115*r-Kz,c+0.234*r-Kz]]).stream(d),t()},e.fitExtent=function(t,n){return Qf(e,t,n)},e.fitSize=function(t,n){return ec(e,t,n)},e.scale(1070)},azimuthalequalarea:function(){return ic(XR).scale(124.75).clipAngle(180-1e-3)},azimuthalequidistant:function(){return ic(VR).scale(79.4188).clipAngle(180-1e-3)},conicconformal:function(){return rc(yc).scale(109.5).parallels([30,30])},conicequalarea:sc,conicequidistant:function(){return rc(_c).scale(131.154).center([0,13.9389])},equirectangular:function(){return ic(bc).scale(152.63)},gnomonic:function(){return ic(xc).scale(144.049).clipAngle(60)},mercator:function(){return hc(gc).scale(961/nT)},orthographic:function(){return ic(vc).scale(249.5).clipAngle(90+Kz)},stereographic:function(){return ic(kc).scale(250).clipAngle(142)},transversemercator:function(){var e=hc(wc),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return arguments.length?n([e[0],e[1],2<e.length?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])},n([0,0,90]).scale(159.155)}};for(var QR in KR)Ec(QR,KR[QR]);var eA=ee(zc,jd);eA.transform=function(e,t){function n(e){e[r]=i(d(e))}var a=t.fork(t.ALL),i=this.value,d=e.field||id,r=e.as||'path',o;return!i||e.modified()?(this.value=i=Cc(e.projection),a.materialize().reflow().visit(a.SOURCE,n)):(o=d===id||t.modified(d.fields),a.visit(o?a.ADD_MOD:a.ADD,n)),a.modifies(r)};var tA=ee(Tc,jd);tA.transform=function(e,t){function n(e){var t=a([i(e),d(e)]);t?(e[o]=t[0],e[l]=t[1]):(e[o]=void 0,e[l]=void 0)}var a=e.projection,i=e.fields[0],d=e.fields[1],r=e.as||['x','y'],o=r[0],l=r[1],s;return e.modified()?t.materialize().reflow(!0).visit(t.SOURCE,n):(s=t.modified(i.fields)||t.modified(d.fields),t.visit(s?t.ADD_MOD:t.ADD,n)),t.modifies(r)};var nA=ee(Rc,jd);nA.transform=function(e,t){var n=t.fork(t.ALL),a=this.value,i=e.field||$('datum'),d=e.as||'shape',r=n.ADD_MOD;return(!a||e.modified())&&(this.value=a=Ac(Cc(e.projection),i),n.materialize().reflow(),r=n.SOURCE),n.visit(r,function(e){e[d]=a}),n.modifies(d)};var aA=ee(Oc,jd);aA.transform=function(e,n){var a=n.fork(),i=this.value,d=this.generator,r;if(!i.length||e.modified())for(var t in e)V(d[t])&&d[t](e[t]);return r=d(),i.length?(r._id=i[0]._id,a.mod.push(r)):a.add.push(md(r)),i[0]=r,(a.source=i,a)};var iA=ee(Pc,jd);iA.transform=function(e){var t=this.value;!t||e.modified('type')?(this.value=t=Lc(e.type),ZR.forEach(function(n){null!=e[n]&&qc(t,n,e[n])})):ZR.forEach(function(n){e.modified(n)&&qc(t,n,e[n])}),null!=e.pointRadius&&t.path.pointRadius(e.pointRadius),e.fit&&Mc(t,e)};$d({type:'Contour',metadata:{generates:!0,source:!0},params:[{name:'size',type:'number',array:!0,length:2,required:!0},{name:'values',type:'number',array:!0},{name:'x',type:'field'},{name:'y',type:'field'},{name:'cellSize',type:'number'},{name:'bandwidth',type:'number'},{name:'thresholds',type:'number'}]},ms),$d({type:'GeoPath',metadata:{modifies:!0},params:[{name:'projection',type:'projection'},{name:'field',type:'field'},{name:'as',type:'string',default:'path'}]},zc),$d({type:'GeoPoint',metadata:{modifies:!0},params:[{name:'projection',type:'projection',required:!0},{name:'fields',type:'field',array:!0,required:!0,length:2},{name:'as',type:'string',array:!0,length:2,default:['x','y']}]},Tc),$d({type:'GeoShape',metadata:{modifies:!0},params:[{name:'projection',type:'projection'},{name:'field',type:'field',default:'datum'},{name:'as',type:'string',default:'shape'}]},Rc),$d({type:'Graticule',metadata:{source:!0,generates:!0,changes:!0},params:[{name:'extent',type:'array',array:!0,length:2,content:{type:'number',array:!0,length:2}},{name:'extentMajor',type:'array',array:!0,length:2,content:{type:'number',array:!0,length:2}},{name:'extentMinor',type:'array',array:!0,length:2,content:{type:'number',array:!0,length:2}},{name:'step',type:'number',array:!0,length:2},{name:'stepMajor',type:'number',array:!0,length:2,default:[90,360]},{name:'stepMinor',type:'number',array:!0,length:2,default:[10,10]},{name:'precision',type:'number',default:2.5}]},Oc),Id('Projection',Pc);var dA='log',rA='band',oA='point',lA='linear',sA='ordinal',fA='quantile',cA='quantize',pA='threshold',uA='bin-ordinal',gA='sequential',hA=ee(Bc,jd);hA.transform=function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=this.value,i=e.scale,d=e.count,r=e.format||Fc(i,d,e.formatSpecifier),o=e.values||Uc(i,d);return a&&(n.rem=a),a=o.map(function(e){return md({value:e,label:r(e)})}),e.extra&&a.push(md({extra:{value:a[0].value},label:''})),(n.source=n.add=this.value=a,n)};var mA=ee(Yc,jd);mA.transform=function(e,t){var n=t.dataflow,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Gc,d=e.key||gd,r=this.value;return r||(t=t.addAll(),this.value=r=Q().test(Wc),r.lookup=function(e){return r.get(d(e))}),(e.modified('key')||t.modified(d))&&F('DataJoin does not support modified key function or fields.'),t.visit(t.ADD,function(e){var t=d(e),n=r.get(t);n?(n.exit?(--r.empty,a.add):a.mod).push(n):(r.set(t,n=i(e)),a.add.push(n)),n.datum=e,n.exit=!1}),t.visit(t.MOD,function(e){var t=d(e),n=r.get(t);n&&(n.datum=e,a.mod.push(n))}),t.visit(t.REM,function(e){var t=d(e),n=r.get(t);e!==n.datum||n.exit||(a.rem.push(n),n.exit=!0,++r.empty)}),t.changed(t.ADD_MOD)&&a.modifies('datum'),e.clean&&r.empty>n.cleanThreshold&&n.runAfter(r.clean),a};var yA=ee(Hc,jd);yA.transform=function(e,t){var n=t.fork(t.ADD_REM),a=t.encode,i='enter'===a,d=e.encoders.update||mv,r=e.encoders.enter||mv,o=e.encoders.exit||mv,l=(a&&!i?e.encoders[a]:d)||mv;if(t.changed(t.ADD)&&(t.visit(t.ADD,function(n){r(n,e),d(n,e),l!==mv&&l!==d&&l(n,e)}),n.modifies(r.output),n.modifies(d.output),l!==mv&&l!==d&&n.modifies(l.output)),t.changed(t.REM)&&o!==mv&&(t.visit(t.REM,function(n){o(n,e)}),n.modifies(o.output)),i||l!==mv){var s=t.MOD|(e.modified()?t.REFLOW:0);i?(t.visit(s,function(a){var t=r(a,e);(l(a,e)||t)&&n.mod.push(a)}),n.mod.length&&n.modifies(r.output)):t.visit(s,function(a){l(a,e)&&n.mod.push(a)}),n.mod.length&&n.modifies(l.output)}return n};var bA={};bA[fA]=function(e){var t=e.domain(),n=[t[0]].concat(e.quantiles());return n.max=fe(t),n},bA[cA]=function(e){var t=e.domain(),a=t[0],d=fe(t),r=e.range().length,n=Array(r),o=0;for(n[0]=a;++o<r;)n[o]=(o*d-(o-r)*a)/r;return n.max=d,n},bA[pA]=function(e){var t=[-Infinity].concat(e.domain());return t.max=+Infinity,t},bA['bin-linear']=Vc,bA[uA]=Vc;var _A=ee(ep,jd);_A.transform=function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=0,i=this.value,d='gradient'===e.type,r=e.scale,o=null==e.count?5:e.count,l=e.format||Fc(r,o,e.formatSpecifier),s=e.values||Xc(r,o,d);if(l=Jc(r,l),i&&(n.rem=i),d)var f=e.values?r.domain():s,c=Jl(r,f[0],fe(f));else{var p=e.size,u;V(p)?(!e.values&&0===r(s[0])&&(s=s.slice(1)),u=s.reduce(function(t,n){return nv(t,p(n,e))},0)):p=J(u=p||8)}return i=s.map(function(n,i){var r=md({index:i,label:l(n,i,s),value:n});return d?r.perc=c(n):(r.offset=u,r.size=p(n,e),r.total=ev(a),a+=r.size),r}),n.source=n.add=this.value=i,n};var xA=Q({line:rp,"line-radial":function(e,t,n,a){return rp(t*Bx(e),t*Ix(e),a*Bx(n),a*Ix(n))},arc:op,"arc-radial":function(e,t,n,a){return op(t*Bx(e),t*Ix(e),a*Bx(n),a*Ix(n))},curve:lp,"curve-radial":function(e,t,n,a){return lp(t*Bx(e),t*Ix(e),a*Bx(n),a*Ix(n))},"orthogonal-horizontal":function(e,t,n,a){return'M'+e+','+t+'V'+a+'H'+n},"orthogonal-vertical":function(e,t,n,a){return'M'+e+','+t+'H'+n+'V'+a},"orthogonal-radial":function(e,t,n,a){var i=Bx(e),d=Ix(e),r=Bx(n),o=Ix(n),l=Vx(n-e)>Gx?n<=e:n>e;return'M'+t*i+','+t*d+'A'+t+','+t+' 0 0,'+(l?1:0)+' '+t*r+','+t*o+'L'+a*r+','+a*o},"diagonal-horizontal":function(e,t,n,a){var i=(e+n)/2;return'M'+e+','+t+'C'+i+','+t+' '+i+','+a+' '+n+','+a},"diagonal-vertical":function(e,t,n,a){var i=(t+a)/2;return'M'+e+','+t+'C'+e+','+i+' '+n+','+i+' '+n+','+a},"diagonal-radial":function(e,t,n,a){var i=Bx(e),d=Ix(e),r=Bx(n),o=Ix(n),l=(t+a)/2;return'M'+t*i+','+t*d+'C'+l*i+','+l*d+' '+l*r+','+l*o+' '+a*r+','+a*o}}),vA=ee(dp,jd);vA.transform=function(e,t){var n=e.sourceX||tp,a=e.sourceY||np,i=e.targetX||ap,d=e.targetY||ip,r=e.as||'path',o=e.orient||'vertical',l=e.shape||'line',s=xA.get(l+'-'+o)||xA.get(l);return s||F('LinkPath unsupported type: '+e.shape+(e.orient?'-'+e.orient:'')),t.visit(t.SOURCE,function(e){e[r]=s(n(e),a(e),i(e),d(e))}),t.reflow(e.modified()).modifies(r)};var kA=ee(sp,jd);kA.transform=function(e,d){var r=e.as||['startAngle','endAngle'],o=r[0],l=r[1],s=e.field||gv,c=e.startAngle||0,p=null==e.endAngle?2*Gx:e.endAngle,u=d.source,g=u.map(s),h=g.length,n=c,a=(p-c)/w(g),m=f(h),y,i,t;for(e.sort&&m.sort(function(e,t){return g[e]-g[t]}),y=0;y<h;++y)t=g[m[y]],i=u[m[y]],i[o]=n,i[l]=n+=t*a;return this.value=g,d.reflow(e.modified()).modifies(r)};var wA=5,SA=he([lA,'pow','sqrt']),EA=he(['set','modified','clear','type','scheme','schemeExtent','schemeCount','domain','domainMin','domainMid','domainMax','domainRaw','nice','zero','range','rangeStep','round','reverse','interpolate','interpolateGamma']),CA=ee(fp,jd);CA.transform=function(e,t){var n=t.dataflow,a=this.value,i;for(i in(!a||e.modified('type'))&&(this.value=a=Bl((e.type||lA).toLowerCase())()),e)EA[i]||(V(a[i])?a[i](e[i]):n.warn('Unsupported scale property: '+i));return up(a,e,cp(a,e),n),t.fork(t.NO_SOURCE|t.NO_FIELDS)};var zA=ee(_p,jd);zA.transform=function(e,t){var n=e.modified('sort')||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified('datum');return n&&t.source.sort(e.sort),this.modified(n),t};var TA=ee(xp,jd);TA.transform=function(e,t){var a=e.as||['y0','y1'],d=a[0],r=a[1],o=e.field||gv,l=e.offset==='center'?vp:e.offset==='normalize'?kp:wp,s,f,i,n;for(s=Sp(t.source,e.groupby,e.sort,o),f=0,i=s.length,n=s.max;f<i;++f)l(s[f],n,o,d,r);return t.reflow(e.modified()).modifies(a)};$d({type:'LinkPath',metadata:{modifies:!0},params:[{name:'sourceX',type:'field',default:'source.x'},{name:'sourceY',type:'field',default:'source.y'},{name:'targetX',type:'field',default:'target.x'},{name:'targetY',type:'field',default:'target.y'},{name:'orient',type:'enum',default:'vertical',values:['horizontal','vertical','radial']},{name:'shape',type:'enum',default:'line',values:['line','arc','curve','diagonal','orthogonal']},{name:'as',type:'string',default:'path'}]},dp),$d({type:'Pie',metadata:{modifies:!0},params:[{name:'field',type:'field'},{name:'startAngle',type:'number',default:0},{name:'endAngle',type:'number',default:6.283185307179586},{name:'sort',type:'boolean',default:!1},{name:'as',type:'string',array:!0,length:2,default:['startAngle','endAngle']}]},sp),$d({type:'Stack',metadata:{modifies:!0},params:[{name:'field',type:'field'},{name:'groupby',type:'field',array:!0},{name:'sort',type:'compare'},{name:'offset',type:'enum',default:'zero',values:['zero','center','normalize']},{name:'as',type:'string',array:!0,length:2,default:['y0','y1']}]},xp),Id('AxisTicks',Bc),Id('DataJoin',Yc),Id('Encode',Hc),Id('LegendEntries',ep),Id('Scale',fp),Id('SortItems',_p);var RA=Op.prototype=Pp.prototype;RA.copy=function(){var e=new Pp(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,a;if(!t)return e;if(!t.length)return e._root=Mp(t),e;for(n=[{source:t,target:e._root=[,,,,]}];t=n.pop();)for(var d=0;4>d;++d)(a=t.source[d])&&(a.length?n.push({source:a,target:t.target[d]=[,,,,]}):t.target[d]=Mp(a));return e},RA.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return zp(this.cover(t,n),t,n,e)},RA.addAll=function(e){var t=e.length,n=Array(t),a=Array(t),r=Infinity,o=Infinity,l=-Infinity,s=-Infinity,f,d,i,c;for(d=0;d<t;++d)isNaN(i=+this._x.call(null,f=e[d]))||isNaN(c=+this._y.call(null,f))||(n[d]=i,a[d]=c,i<r&&(r=i),i>l&&(l=i),c<o&&(o=c),c>s&&(s=c));for(l<r&&(r=this._x0,l=this._x1),s<o&&(o=this._y0,s=this._y1),this.cover(r,o).cover(l,s),d=0;d<t;++d)zp(this,n[d],a[d],e[d]);return this},RA.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,a=this._y0,d=this._x1,r=this._y1;if(isNaN(n))d=(n=Kx(e))+1,r=(a=Kx(t))+1;else if(n>e||e>d||a>t||t>r){var o=d-n,l=this._root,s,f;switch(f=(t<(a+r)/2)<<1|e<(n+d)/2){case 0:{do s=[,,,,],s[f]=l,l=s;while((o*=2,d=n+o,r=a+o,e>d||t>r));break}case 1:{do s=[,,,,],s[f]=l,l=s;while((o*=2,n=d-o,r=a+o,n>e||t>r));break}case 2:{do s=[,,,,],s[f]=l,l=s;while((o*=2,d=n+o,a=r-o,e>d||a>t));break}case 3:{do s=[,,,,],s[f]=l,l=s;while((o*=2,n=d-o,a=r-o,n>e||a>t));break}}this._root&&this._root.length&&(this._root=l)}else return this;return this._x0=n,this._y0=a,this._x1=d,this._y1=r,this},RA.data=function(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e},RA.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},RA.find=function(e,t,n){var a=this._x0,r=this._y0,o=this._x1,l=this._y1,s=[],f=this._root,c,p,u,g,h,m,y;for(f&&s.push(new Tp(f,a,r,o,l)),null==n?n=Infinity:(a=e-n,r=t-n,o=e+n,l=t+n,n*=n);m=s.pop();)if(!(!(f=m.node)||(p=m.x0)>o||(u=m.y0)>l||(g=m.x1)<a||(h=m.y1)<r))if(f.length){var i=(p+g)/2,b=(u+h)/2;s.push(new Tp(f[3],i,b,g,h),new Tp(f[2],p,b,i,h),new Tp(f[1],i,u,g,b),new Tp(f[0],p,u,i,b)),(y=(t>=b)<<1|e>=i)&&(m=s[s.length-1],s[s.length-1]=s[s.length-1-y],s[s.length-1-y]=m)}else{var _=e-+this._x.call(null,f.data),x=t-+this._y.call(null,f.data),v=_*_+x*x;if(v<n){var k=Hx(n=v);a=e-k,r=t-k,o=e+k,l=t+k,c=f.data}}return c},RA.remove=function(e){if(isNaN(c=+this._x.call(null,e))||isNaN(p=+this._y.call(null,e)))return this;var t=this._root,n=this._x0,a=this._y0,d=this._x1,r=this._y1,o,l,s,f,c,p,u,g,h,m,y,i;if(!t)return this;if(t.length)for(;;){if((h=c>=(u=(n+d)/2))?n=u:d=u,(m=p>=(g=(a+r)/2))?a=g:r=g,(o=t,!(t=t[y=m<<1|h])))return this;if(!t.length)break;(o[3&y+1]||o[3&y+2]||o[3&y+3])&&(l=o,i=y)}for(;t.data!==e;)if(s=t,!(t=t.next))return this;return((f=t.next)&&delete t.next,s)?(f?s.next=f:delete s.next,this):o?(f?o[y]=f:delete o[y],(t=o[0]||o[1]||o[2]||o[3])&&t===(o[3]||o[2]||o[1]||o[0])&&!t.length&&(l?l[i]=t:this._root=t),this):(this._root=f,this)},RA.removeAll=function(e){for(var t=0,a=e.length;t<a;++t)this.remove(e[t]);return this},RA.root=function(){return this._root},RA.size=function(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e},RA.visit=function(e){var t=[],n=this._root,a,i,d,r,o,l;for(n&&t.push(new Tp(n,this._x0,this._y0,this._x1,this._y1));a=t.pop();)if(!e(n=a.node,d=a.x0,r=a.y0,o=a.x1,l=a.y1)&&n.length){var s=(d+o)/2,f=(r+l)/2;(i=n[3])&&t.push(new Tp(i,s,f,o,l)),(i=n[2])&&t.push(new Tp(i,d,f,s,l)),(i=n[1])&&t.push(new Tp(i,s,r,o,f)),(i=n[0])&&t.push(new Tp(i,d,r,s,f))}return this},RA.visitAfter=function(e){var t=[],n=[],a;for(this._root&&t.push(new Tp(this._root,this._x0,this._y0,this._x1,this._y1));a=t.pop();){var i=a.node;if(i.length){var d=a.x0,r=a.y0,o=a.x1,l=a.y1,s=(d+o)/2,f=(r+l)/2,c;(c=i[0])&&t.push(new Tp(c,d,r,s,f)),(c=i[1])&&t.push(new Tp(c,s,r,o,f)),(c=i[2])&&t.push(new Tp(c,d,f,s,l)),(c=i[3])&&t.push(new Tp(c,s,f,o,l))}n.push(a)}for(;a=n.pop();)e(a.node,a.x0,a.y0,a.x1,a.y1);return this},RA.x=function(e){return arguments.length?(this._x=e,this):this._x},RA.y=function(e){return arguments.length?(this._y=e,this):this._y};var AA=0,OA=0,PA=0,MA=1e3,DA=0,LA=0,qA=0,UA='object'===typeof performance&&performance.now?performance:Date,FA='function'===typeof requestAnimationFrame?requestAnimationFrame:function(e){setTimeout(e,17)},jA,$A;$p.prototype=Np.prototype={constructor:$p,restart:function(e,t,n){if('function'!==typeof e)throw new TypeError('callback is not a function');n=(null==n?Fp():+n)+(null==t?0:+t),this._next||$A===this||($A?$A._next=this:jA=this,$A=this),this._call=e,this._time=n,Wp()},stop:function(){this._call&&(this._call=null,this._time=Infinity,Wp())}};var NA=10,IA=Gx*(3-2.23606797749979),BA={center:function(e,t){function n(){var d=a.length,n=0,r=0,o,i;for(o=0;o<d;++o)i=a[o],n+=i.x,r+=i.y;for(n=n/d-e,r=r/d-t,o=0;o<d;++o)i=a[o],i.x-=n,i.y-=r}var a;return null==e&&(e=0),null==t&&(t=0),n.initialize=function(e){a=e},n.x=function(t){return arguments.length?(e=+t,n):e},n.y=function(e){return arguments.length?(t=+e,n):t},n},collide:function(e){function t(){function e(e,t,n,a,d){var o=e.data,s=e.r,h=u+s;if(o){if(o.index>f.index){var r=c-o.x-o.vx,m=p-o.y-o.vy,y=r*r+m*m;y<h*h&&(0===r&&(r=Cp(),y+=r*r),0===m&&(m=Cp(),y+=m*m),y=(h-(y=Hx(y)))/y*i,f.vx+=(r*=y)*(h=(s*=s)/(g+s)),f.vy+=(m*=y)*h,o.vx-=r*(h=1-h),o.vy-=m*h)}return}return t>c+h||a<c-h||n>p+h||d<p-h}for(var t=r.length,n=0,l,s,f,c,p,u,g;n<d;++n)for(s=Op(r,Dp,Lp).visitAfter(a),l=0;l<t;++l)f=r[l],u=o[f.index],g=u*u,c=f.x+f.vx,p=f.y+f.vy,s.visit(e)}function a(e){if(e.data)return e.r=o[e.data.index];for(var t=e.r=0;4>t;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function n(){if(r){var t=r.length,n,a;for(o=Array(t),n=0;n<t;++n)a=r[n],o[a.index]=+e(a,n,r)}}var i=1,d=1,r,o;return'function'!==typeof e&&(e=Ep(null==e?1:+e)),t.initialize=function(e){r=e,n()},t.iterations=function(e){return arguments.length?(d=+e,t):d},t.strength=function(e){return arguments.length?(i=+e,t):i},t.radius=function(a){return arguments.length?(e='function'===typeof a?a:Ep(+a),n(),t):e},t},nbody:function(){function e(e){var t=l.length,n=Op(l,Hp,Xp).visitAfter(a),r;for(f=e,r=0;r<t;++r)s=l[r],n.visit(d)}function t(){if(l){var e=l.length,t,n;for(c=Array(e),t=0;t<e;++t)n=l[t],c[n.index]=+r(n,t,l)}}function a(e){var t=0,n,a,d,r,o;if(e.length){for(d=r=o=0;4>o;++o)(n=e[o])&&(a=n.value)&&(t+=a,d+=a*n.x,r+=a*n.y);e.x=d/t,e.y=r/t}else{n=e,n.x=n.data.x,n.y=n.data.y;do t+=c[n.data.index];while(n=n.next)}e.value=t}function d(e,t,a,d){if(!e.value)return!0;var r=e.x-s.x,p=e.y-s.y,u=d-t,g=r*r+p*p;if(u*u/o<g)return g<i&&(0===r&&(r=Cp(),g+=r*r),0===p&&(p=Cp(),g+=p*p),g<n&&(g=Hx(n*g)),s.vx+=r*e.value*f/g,s.vy+=p*e.value*f/g),!0;if(!(e.length||g>=i)){(e.data!==s||e.next)&&(0===r&&(r=Cp(),g+=r*r),0===p&&(p=Cp(),g+=p*p),g<n&&(g=Hx(n*g)));do e.data!==s&&(u=c[e.data.index]*f/g,s.vx+=r*u,s.vy+=p*u);while(e=e.next)}}var r=Ep(-30),n=1,i=Infinity,o=0.81,l,s,f,c;return e.initialize=function(e){l=e,t()},e.strength=function(n){return arguments.length?(r='function'===typeof n?n:Ep(+n),t(),e):r},e.distanceMin=function(t){return arguments.length?(n=t*t,e):Hx(n)},e.distanceMax=function(t){return arguments.length?(i=t*t,e):Hx(i)},e.theta=function(t){return arguments.length?(o=t*t,e):Hx(o)},e},link:function(e){function t(t){for(var a=0,d=e.length;a<s;++a)for(var n=0,i,r,o,p,u,h,l;n<d;++n)i=e[n],r=i.source,o=i.target,p=o.x+o.vx-r.x-r.vx||Cp(),u=o.y+o.vy-r.y-r.vy||Cp(),h=Hx(p*p+u*u),h=(h-c[n])/h*t*f[n],p*=h,u*=h,o.vx-=p*(l=g[n]),o.vy-=u*l,r.vx+=p*(l=1-l),r.vy+=u*l}function n(){if(p){var t=p.length,n=e.length,o=_e(p,r),l,i;for(l=0,u=Array(t);l<n;++l)i=e[l],i.index=l,'object'!==typeof i.source&&(i.source=Up(o,i.source)),'object'!==typeof i.target&&(i.target=Up(o,i.target)),u[i.source.index]=(u[i.source.index]||0)+1,u[i.target.index]=(u[i.target.index]||0)+1;for(l=0,g=Array(n);l<n;++l)i=e[l],g[l]=u[i.source.index]/(u[i.source.index]+u[i.target.index]);f=Array(n),a(),c=Array(n),d()}}function a(){if(p)for(var t=0,a=e.length;t<a;++t)f[t]=+o(e[t],t,e)}function d(){if(p)for(var t=0,a=e.length;t<a;++t)c[t]=+l(e[t],t,e)}var r=qp,o=function(e){return 1/Zx(u[e.source.index],u[e.target.index])},l=Ep(30),s=1,f,c,p,u,g;return null==e&&(e=[]),t.initialize=function(e){p=e,n()},t.links=function(a){return arguments.length?(e=a,n(),t):e},t.id=function(e){return arguments.length?(r=e,t):r},t.iterations=function(e){return arguments.length?(s=+e,t):s},t.strength=function(e){return arguments.length?(o='function'===typeof e?e:Ep(+e),a(),t):o},t.distance=function(e){return arguments.length?(l='function'===typeof e?e:Ep(+e),d(),t):l},t},x:function(e){function t(e){for(var t=0,a=d.length,n;t<a;++t)n=d[t],n.vx+=(o[t]-n.x)*r[t]*e}function n(){if(d){var t=d.length,n;for(r=Array(t),o=Array(t),n=0;n<t;++n)r[n]=isNaN(o[n]=+e(d[n],n,d))?0:+a(d[n],n,d)}}var a=Ep(0.1),d,r,o;return'function'!==typeof e&&(e=Ep(null==e?0:+e)),t.initialize=function(e){d=e,n()},t.strength=function(e){return arguments.length?(a='function'===typeof e?e:Ep(+e),n(),t):a},t.x=function(a){return arguments.length?(e='function'===typeof a?a:Ep(+a),n(),t):e},t},y:function(e){function t(e){for(var t=0,a=d.length,n;t<a;++t)n=d[t],n.vy+=(o[t]-n.y)*r[t]*e}function n(){if(d){var t=d.length,n;for(r=Array(t),o=Array(t),n=0;n<t;++n)r[n]=isNaN(o[n]=+e(d[n],n,d))?0:+a(d[n],n,d)}}var a=Ep(0.1),d,r,o;return'function'!==typeof e&&(e=Ep(null==e?0:+e)),t.initialize=function(e){d=e,n()},t.strength=function(e){return arguments.length?(a='function'===typeof e?e:Ep(+e),n(),t):a},t.y=function(a){return arguments.length?(e='function'===typeof a?a:Ep(+a),n(),t):e},t}},YA='forces',GA=['alpha','alphaMin','alphaTarget','velocityDecay','forces'],WA=['static','iterations'],HA=['x','y','vx','vy'],XA=ee(Jp,jd);XA.transform=function(e,t){var n=this.value,a=t.changed(t.ADD_REM),i=e.modified(GA),d=e.iterations||300;if(n?(a&&(t.modifies('index'),n.nodes(t.source)),i&&Qp(n,e)):(this.value=n=Kp(t.source,e),n.on('tick',Zp(t.dataflow,this)),!e.static&&(a=!0,n.tick()),t.modifies('index')),i||a||e.modified(WA)||t.changed()&&e.restart)if(n.alpha(nv(n.alpha(),e.alpha||1)).alphaDecay(1-Qx(n.alphaMin(),1/d)),e.static)for(n.stop();0<=--d;)n.tick();else if(n.stopped()&&n.restart(),!a)return t.StopPropagation;return this.finish(e,t)},XA.finish=function(e,t){for(var a=t.dataflow,d=this._argops,r=0,o=d.length,l;r<o;++r)if(l=d[r],l.name===YA&&'link'===l.op._argval.force)for(var s=l.op._argops,f=0,i=s.length,n;f<i;++f)if('links'===s[f].name&&(n=s[f].op.source)){a.touch(n);break}return t.reflow(e.modified()).modifies(HA)};$d({type:'Force',metadata:{modifies:!0},params:[{name:'static',type:'boolean',default:!1},{name:'restart',type:'boolean',default:!1},{name:'iterations',type:'number',default:300},{name:'alpha',type:'number',default:1},{name:'alphaMin',type:'number',default:0.001},{name:'alphaTarget',type:'number',default:0},{name:'velocityDecay',type:'number',default:0.4},{name:'forces',type:'param',array:!0,params:[{key:{force:'center'},params:[{name:'x',type:'number',default:0},{name:'y',type:'number',default:0}]},{key:{force:'collide'},params:[{name:'radius',type:'number',expr:!0},{name:'strength',type:'number',default:0.7},{name:'iterations',type:'number',default:1}]},{key:{force:'nbody'},params:[{name:'strength',type:'number',default:-30},{name:'theta',type:'number',default:0.9},{name:'distanceMin',type:'number',default:1},{name:'distanceMax',type:'number'}]},{key:{force:'link'},params:[{name:'links',type:'data'},{name:'id',type:'field'},{name:'distance',type:'number',default:30,expr:!0},{name:'strength',type:'number',expr:!0},{name:'iterations',type:'number',default:1}]},{key:{force:'x'},params:[{name:'strength',type:'number',default:0.1},{name:'x',type:'field'}]},{key:{force:'y'},params:[{name:'strength',type:'number',default:0.1},{name:'y',type:'field'}]}]},{name:'as',type:'string',array:!0,modify:!1,default:['x','y','vx','vy']}]},Jp),hu.prototype=cu.prototype={constructor:hu,count:function(){return this.eachAfter(su)},each:function(e){var t=this,a=[t],d,r,o,i;do for(d=a.reverse(),a=[];t=d.pop();)if(e(t),r=t.children,r)for(o=0,i=r.length;o<i;++o)a.push(r[o]);while(a.length);return this},eachAfter:function(e){for(var t=this,a=[t],d=[],r,o,i;t=a.pop();)if(d.push(t),r=t.children,r)for(o=0,i=r.length;o<i;++o)a.push(r[o]);for(;t=d.pop();)e(t);return this},eachBefore:function(e){for(var t=this,n=[t],a,d;t=n.pop();)if(e(t),a=t.children,a)for(d=a.length-1;0<=d;--d)n.push(a[d]);return this},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,a=t.children,d=a&&a.length;0<=--d;)n+=a[d].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=fu(t,e),a=[t];t!==n;)t=t.parent,a.push(t);for(var i=a.length;e!==n;)a.splice(i,0,e),e=e.parent;return a},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each(function(t){e.push(t)}),e},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return cu(this).eachBefore(uu)}};var VA='$',JA={depth:-1},ZA={};Xu.prototype=Object.create(hu.prototype);var KA=(1+2.23606797749979)/2,QA=function e(t){function n(e,n,a,i,d){Ku(t,e,n,a,i,d)}return n.ratio=function(t){return e(1<(t=+t)?t:1)},n}(KA),eO=function e(t){function n(e,a,d,r,o){if((c=e._squarify)&&c.ratio===t)for(var l=-1,s=c.length,f=e.value,c,p,u,g,i;++l<s;){for(p=c[l],u=p.children,(g=p.value=0,i=u.length);g<i;++g)p.value+=u[g].value;p.dice?Fu(p,a,d,r,d+=(o-d)*p.value/f):Zu(p,a,d,a+=(r-a)*p.value/f,o),f-=p.value}else e._squarify=c=Ku(t,e,a,d,r,o),c.ratio=t}return n.ratio=function(t){return e(1<(t=+t)?t:1)},n}(KA),tO=ee(eg,jd);tO.transform=function(e,t){t.source||F('Nest transform requires an upstream data source.');var n=e.key||gd,a,i,d,r;return(!this.value||(r=e.modified())||t.changed())&&(a=H(e.keys).reduce(function(e,t){return e.key(t),e},xe()).entries(t.source),i=cu({values:a},tg),d=i.lookup={},i.each(function(e){null!=gd(e.data)&&(d[n(e.data)]=e)}),this.value=i),t.source.root=this.value,r?t.fork(t.ALL):t};var nO=ee(ng,jd);nO.transform=function(e,t){t.source||F('Stratify transform requires an upstream data source.');var n=e.modified(),a=!this.value||n||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields),i,d;return a&&(i=Nu().id(e.key).parentId(e.parentKey)(t.source),d=i.lookup={},i.each(function(t){d[e.key(t.data)]=t}),this.value=i),t.source.root=this.value,n?t.fork(t.ALL):t};var aO=ee(ag,jd);aO.transform=function(e,t){function a(e){var t=i[e];t&&(o[e]=1,l.mod.push(t))}t.source&&t.source.root||F('TreeLinks transform requires a backing tree data source.');var n=t.source.root,d=n.lookup,i=this.value,r=e.key||gd,o={},l=t.fork();return t.visit(t.REM,function(e){var t=r(e),n=i[t];n&&(delete i[t],l.rem.push(n))}),t.visit(t.ADD,function(e){var n=r(e),a;(a=ig(d[n]))&&(l.add.push(i[n]=md({source:a,target:e})),o[n]=1)}),t.visit(t.MOD,function(e){var t=r(e),l=d[t],s=l.children;if(a(t),s)for(var f=0,i=s.length;f<i;++f)o[t=r(s[f].data)]||a(t)}),l};var iO={binary:function(e,t,a,d,r){function o(e,t,a,i,d,r,s){if(e>=t-1){var f=l[e];return f.x0=i,f.y0=d,f.x1=r,void(f.y1=s)}for(var c=n[e],p=a/2+c,u=e+1,g=t-1;u<g;){var h=u+g>>>1;n[h]<p?u=h+1:g=h}p-n[u-1]<n[u]-p&&e+1<u&&--u;var m=n[u]-c,y=a-m;if(r-i>s-d){var b=(i*y+r*m)/a;o(e,u,m,i,d,b,s),o(u,t,y,b,d,r,s)}else{var _=(d*y+s*m)/a;o(e,u,m,i,d,r,_),o(u,t,y,i,_,r,s)}}var l=e.children,s=l.length,n=Array(s+1),f,i;for(n[0]=i=f=0;f<s;++f)n[f+1]=i+=l[f].value;o(0,s,e.value,t,a,d,r)},dice:Fu,slice:Zu,slicedice:function(e,t,n,a,i){(1&e.depth?Zu:Fu)(e,t,n,a,i)},squarify:QA,resquarify:eO},dO={tidy:Ju,cluster:lu},rO=ee(dg,jd);rO.transform=function(e,t){t.source&&t.source.root||F(this.constructor.name+' transform requires a backing tree data source.');var n=this.layout(e.method),a=this.fields,i=t.source.root,d=e.as||a;e.field&&i.sum(e.field),e.sort&&i.sort(e.sort),rg(n,this.params,e);try{this.value=n(i)}catch(e){F(e)}return i.each(function(e){og(e,a,d)}),t.reflow(e.modified()).modifies(d).modifies('leaf')},ee(lg,dg),lg.prototype.layout=function(e){var t=e||'tidy';return dO.hasOwnProperty(t)?dO[t]():void F('Unrecognized Tree layout method: '+t)},lg.prototype.params=['size','nodeSize','separation'],lg.prototype.fields=['x','y','depth','children'],ee(sg,dg),sg.prototype.layout=function(){var e=Qu();return e.ratio=function(n){var a=e.tile();a.ratio&&e.tile(a.ratio(n))},e.method=function(t){iO.hasOwnProperty(t)?e.tile(iO[t]):F('Unrecognized Treemap layout method: '+t)},e},sg.prototype.params=['method','ratio','size','round','padding','paddingInner','paddingOuter','paddingTop','paddingRight','paddingBottom','paddingLeft'],sg.prototype.fields=['x0','y0','x1','y1','depth','children'],ee(fg,dg),fg.prototype.layout=function(){function e(e){var o=e.height+1;return e.x0=e.y0=d,e.x1=a,e.y1=i/o,e.eachBefore(t(i,o)),r&&e.eachBefore(Uu),e}function t(e,t){return function(n){n.children&&Fu(n,n.x0,e*(n.depth+1)/t,n.x1,e*(n.depth+2)/t);var a=n.x0,i=n.y0,r=n.x1-d,o=n.y1-d;r<a&&(a=r=(a+r)/2),o<i&&(i=o=(i+o)/2),n.x0=a,n.y0=i,n.x1=r,n.y1=o}}var a=1,i=1,d=0,r=!1;return e.round=function(t){return arguments.length?(r=!!t,e):r},e.size=function(t){return arguments.length?(a=+t[0],i=+t[1],e):[a,i]},e.padding=function(t){return arguments.length?(d=+t,e):d},e},fg.prototype.params=['size','round','padding'],fg.prototype.fields=sg.prototype.fields,ee(cg,dg),cg.prototype.layout=function(){function e(e){return e.x=n/2,e.y=a/2,t?e.eachBefore(Du(t)).eachAfter(Lu(i,0.5)).eachBefore(qu(1)):e.eachBefore(Du(Mu)).eachAfter(Lu(Ou,1)).eachAfter(Lu(i,e.r/Zx(n,a))).eachBefore(qu(Zx(n,a)/(2*e.r))),e}var t=null,n=1,a=1,i=Ou;return e.radius=function(n){return arguments.length?(t=Ru(n),e):t},e.size=function(t){return arguments.length?(n=+t[0],a=+t[1],e):[n,a]},e.padding=function(t){return arguments.length?(i='function'===typeof t?t:Pu(+t),e):i},e},cg.prototype.params=['size','padding'],cg.prototype.fields=['x','y','r','depth','children'];$d({type:'Nest',metadata:{treesource:!0},params:[{name:'keys',type:'field',array:!0},{name:'key',type:'field'}]},eg),$d({type:'Stratify',metadata:{treesource:!0},params:[{name:'key',type:'field',required:!0},{name:'parentKey',type:'field',required:!0}]},ng),$d({type:'TreeLinks',metadata:{tree:!0,generates:!0,changes:!0},params:[{name:'key',type:'field'}]},ag),$d({type:'Pack',metadata:{tree:!0,modifies:!0},params:[{name:'field',type:'field'},{name:'sort',type:'compare'},{name:'padding',type:'number',default:0},{name:'radius',type:'field',default:null},{name:'size',type:'number',array:!0,length:2},{name:'as',type:'string',array:!0,length:3,default:['x','y','r','depth','children']}]},cg),$d({type:'Partition',metadata:{tree:!0,modifies:!0},params:[{name:'field',type:'field'},{name:'sort',type:'compare'},{name:'padding',type:'number',default:0},{name:'round',type:'boolean',default:!1},{name:'size',type:'number',array:!0,length:2},{name:'as',type:'string',array:!0,length:4,default:['x0','y0','x1','y1','depth','children']}]},fg),$d({type:'Tree',metadata:{tree:!0,modifies:!0},params:[{name:'field',type:'field'},{name:'sort',type:'compare'},{name:'method',type:'enum',default:'tidy',values:['tidy','cluster']},{name:'size',type:'number',array:!0,length:2},{name:'nodeSize',type:'number',array:!0,length:2},{name:'as',type:'string',array:!0,length:4,default:['x','y','depth','children']}]},lg),$d({type:'Treemap',metadata:{tree:!0,modifies:!0},params:[{name:'field',type:'field'},{name:'sort',type:'compare'},{name:'method',type:'enum',default:'squarify',values:['squarify','resquarify','binary','dice','slice','slicedice']},{name:'padding',type:'number',default:0},{name:'paddingInner',type:'number',default:0},{name:'paddingOuter',type:'number',default:0},{name:'paddingTop',type:'number',default:0},{name:'paddingRight',type:'number',default:0},{name:'paddingBottom',type:'number',default:0},{name:'paddingLeft',type:'number',default:0},{name:'ratio',type:'number',default:1.618033988749895},{name:'round',type:'boolean',default:!1},{name:'size',type:'number',array:!0,length:2},{name:'as',type:'string',array:!0,length:4,default:['x0','y0','x1','y1','depth','children']}]},sg),hg.prototype={constructor:hg,insert:function(e,t){var n,a,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=_g(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)a=n.U,n===a.L?(i=a.R,i&&i.C?(n.C=i.C=!1,a.C=!0,e=a):(e===n.R&&(yg(this,n),e=n,n=e.U),n.C=!1,a.C=!0,bg(this,a))):(i=a.L,i&&i.C?(n.C=i.C=!1,a.C=!0,e=a):(e===n.L&&(bg(this,n),e=n,n=e.U),n.C=!1,a.C=!0,yg(this,a))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n=e.L,a=e.R,i,d,r;if(d=n?a?_g(a):n:a,t?t.L===e?t.L=d:t.R=d:this._=d,n&&a?(r=d.C,d.C=e.C,d.L=n,n.U=d,d===a?(d.U=t,t=d,e=d.R):(t=d.U,d.U=e.U,e=d.R,t.L=e,d.R=a,a.U=d)):(r=e.C,e=d),e&&(e.U=t),!r){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===t.L){if(i=t.R,i.C&&(i.C=!1,t.C=!0,yg(this,t),i=t.R),i.L&&i.L.C||i.R&&i.R.C){i.R&&i.R.C||(i.L.C=!1,i.C=!0,bg(this,i),i=t.R),i.C=t.C,t.C=i.R.C=!1,yg(this,t),e=this._;break}}else if(i=t.L,i.C&&(i.C=!1,t.C=!0,bg(this,t),i=t.L),i.L&&i.L.C||i.R&&i.R.C){i.L&&i.L.C||(i.R.C=!1,i.C=!0,yg(this,i),i=t.L),i.C=t.C,t.C=i.L.C=!1,bg(this,t),e=this._;break}i.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};var oO=[],lO=[],sO=1e-6,fO=1e-12,cO,pO,uO,gO,hO;Yg.prototype={constructor:Yg,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(n){return Tg(t,e[n])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,a){if(s=(l=n.halfedges).length)for(var i=n.site,d=-1,r=t[l[s-1]],o=r.left===i?r.right:r.left,l,s,f;++d<s;)f=o,r=t[l[d]],o=r.left===i?r.right:r.left,f&&o&&a<f.index&&a<o.index&&0>Ig(i,f,o)&&e.push([i.data,f.data,o.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,a){for(var i=this,d=i._found||0,r=i.cells.length,n,o;!(o=i.cells[d]);)if(++d>=r)return null;var l=e-o.site[0],s=t-o.site[1],f=l*l+s*s;do o=i.cells[n=d],d=null,o.halfedges.forEach(function(n){var a=i.edges[n],r=a.left;if(r!==o.site&&r||(r=a.right)){var l=e-r[0],s=t-r[1],c=l*l+s*s;c<f&&(f=c,d=r.index)}});while(null!==d);return i._found=n,null==a||f<=a*a?o.site:null}};var mO=ee(Wg,jd),yO=[[-100000,-100000],[100000,100000]];mO.transform=function(e,t){var a=e.as||'path',d=t.source,r,o,l,i;for(r=Gg().x(e.x).y(e.y),e.size?r.size(e.size):r.extent(e.extent||yO),this.value=r=r(d),o=r.polygons(),(l=0,i=d.length);l<i;++l)d[l][a]=o[l]?'M'+o[l].join('L')+'Z':null;return t.reflow(e.modified()).modifies(a)};$d({type:'Voronoi',metadata:{modifies:!0},params:[{name:'x',type:'field',required:!0},{name:'y',type:'field',required:!0},{name:'size',type:'number',array:!0,length:2},{name:'extent',type:'array',array:!0,length:2,default:[[-100000,-100000],[100000,100000]],content:{type:'number',array:!0,length:2}},{name:'as',type:'string',default:'path'}]},Wg);var bO=Gx/180,_O=64,cw=2048,ch={archimedean:Kg,rectangular:function(e){var n=4,a=n*e[0]/e[1],i=0,d=0;return function(e){var t=0>e?-1:1;switch(3&Hx(1+4*t*e)-t){case 0:i+=a;break;case 1:d+=n;break;case 2:i-=a;break;default:d-=n;}return[i,d]}}},xO=['x','y','font','fontSize','fontStyle','fontWeight','angle'],vO=['text','font','rotate','fontSize','fontStyle','fontWeight'],kO=ee(nh,jd);kO.transform=function(e,a){var d=e.modified();if(d||a.changed(a.ADD_REM)||vO.some(function(t){var n=e[t];return V(n)&&a.modified(n.fields)})){var r=this.value,o=e.as||xO,l=e.fontSize||14,s;if(V(l)?s=e.fontSizeRange:l=J(l),s){var f=l,c=Bl('sqrt')().domain(ah(f,a)).range(s);l=function(e){return c(f(e))}}var p=a.materialize(a.SOURCE).source;p.forEach(function(e){e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0});for(var u=r.words(p).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||'archimedean').rotate(e.rotate||0).font(e.font||'sans-serif').fontStyle(e.fontStyle||'normal').fontWeight(e.fontWeight||'normal').fontSize(l).layout(),g=r.size(),h=g[0]>>1,m=g[1]>>1,y=0,i=u.length,n,b;y<i;++y)n=u[y],b=n.datum,b[o[0]]=n.x+h,b[o[1]]=n.y+m,b[o[2]]=n.font,b[o[3]]=n.size,b[o[4]]=n.style,b[o[5]]=n.weight,b[o[6]]=n.rotate;return a.reflow(d).modifies(o)}};$d({type:'Wordcloud',metadata:{modifies:!0},params:[{name:'size',type:'number',array:!0,length:2},{name:'font',type:'string',expr:!0,default:'sans-serif'},{name:'fontStyle',type:'string',expr:!0,default:'normal'},{name:'fontWeight',type:'string',expr:!0,default:'normal'},{name:'fontSize',type:'number',expr:!0,default:14},{name:'fontSizeRange',type:'number',array:!0,null:!0,default:[10,50]},{name:'rotate',type:'number',expr:!0,default:0},{name:'text',type:'field'},{name:'spiral',type:'string',values:['archimedean','rectangular']},{name:'padding',type:'number',expr:!0},{name:'as',type:'string',array:!0,length:7,default:['x','y','font','fontSize','fontStyle','fontWeight','angle']}]},nh);var wO=ee(hh,jd);wO.transform=function(e,t){if(!this._dims)return this.init(e,t);var n=e.modified('fields')||e.fields.some(function(e){return t.modified(e.fields)});return n?this.reinit(e,t):this.eval(e,t)},wO.init=function(e,t){for(var n=e.fields,a=e.query,d=this._indices={},r=this._dims=[],o=a.length,l=0,i,s;l<o;++l)i=n[l].fname,s=d[i]||(d[i]=ph()),r.push(fh(s,l,a[l]));return this.eval(e,t)},wO.reinit=function(e,t){var a=t.materialize().fork(),d=e.fields,r=e.query,o=this._indices,l=this._dims,s=this.value,c=s.curr(),p=s.prev(),u=s.all(),g=a.rem=a.add,h=a.mod,y=r.length,m={},b,_,x,v,k,w,S,i,n;if(p.set(c),t.rem.length&&(k=this.remove(e,t,a)),t.add.length&&s.add(t.add),t.mod.length)for(w={},v=t.mod,S=0,i=v.length;S<i;++S)w[v[S]._index]=1;for(S=0;S<y;++S)n=d[S],(!l[S]||e.modified('fields',S)||t.modified(n.fields))&&(x=n.fname,!(b=m[x])&&(o[x]=_=ph(),m[x]=b=_.insert(n,t.source,0)),l[S]=fh(_,S,r[S]).onAdd(b,c));for(S=0,i=s.data().length;S<i;++S)if(k[S])continue;else p[S]===c[S]?w[S]&&c[S]!==u&&h.push(S):g.push(S);return s.mask=(1<<y)-1,a},wO.eval=function(e,t){var n=t.materialize().fork(),a=this._dims.length,i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<a)-1),e.modified('query')&&!e.modified('fields')&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<a)-1),t.mod.length&&(this.modify(t,n),i|=(1<<a)-1),this.value.mask=i,n},wO.insert=function(e,t,a){var i=t.add,d=this.value,r=this._dims,o=this._indices,l=e.fields,s={},f=a.add,c=d.size(),p=c+i.length,n=r.length,u,g,h;d.resize(p,n),d.add(i);var m=d.curr(),y=d.prev(),b=d.all();for(u=0;u<n;++u)g=l[u].fname,h=s[g]||(s[g]=o[g].insert(l[u],i,c)),r[u].onAdd(h,m);for(;c<p;++c)y[c]=b,m[c]!==b&&f.push(c)},wO.modify=function(e,t){var a=t.mod,d=this.value,r=d.curr(),o=d.all(),l=e.mod,s,i,n;for(s=0,i=l.length;s<i;++s)n=l[s]._index,r[n]!==o&&a.push(n)},wO.remove=function(e,t,a){var d=this._indices,r=this.value,o=r.curr(),l=r.prev(),s=r.all(),c={},p=a.rem,u=t.rem,g,i,n,h;for(g=0,i=u.length;g<i;++g)n=u[g]._index,c[n]=1,l[n]=h=o[n],o[n]=s,h!==s&&p.push(n);for(n in d)d[n].remove(i,c);return this.reindex(t,i,c),c},wO.reindex=function(e,t,n){var a=this._indices,i=this.value;e.runAfter(function(){var e=i.remove(t,n);for(var d in a)a[d].reindex(e)})},wO.update=function(e,t,n){var a=this._dims,d=e.query,r=t.stamp,o=a.length,l=0,s,i;for(n.filters=0,i=0;i<o;++i)e.modified('query',i)&&(s=i,++l);if(1===l)l=a[s].one,this.incrementOne(a[s],d[s],n.add,n.rem);else for(i=0,l=0;i<o;++i)e.modified('query',i)&&(l|=a[i].one,this.incrementAll(a[i],d[i],r,n.add),n.rem=n.add);return l},wO.incrementAll=function(e,t,n,a){var d=this.value,r=d.seen(),o=d.curr(),l=d.prev(),s=e.index(),f=e.bisect(e.range),c=e.bisect(t),p=c[0],u=c[1],g=f[0],h=f[1],m=e.one,y,i,b;if(p<g)for(y=p,i=Zx(g,u);y<i;++y)b=s[y],r[b]!==n&&(l[b]=o[b],r[b]=n,a.push(b)),o[b]^=m;else if(p>g)for(y=g,i=Zx(p,h);y<i;++y)b=s[y],r[b]!==n&&(l[b]=o[b],r[b]=n,a.push(b)),o[b]^=m;if(u>h)for(y=nv(p,h),i=u;y<i;++y)b=s[y],r[b]!==n&&(l[b]=o[b],r[b]=n,a.push(b)),o[b]^=m;else if(u<h)for(y=nv(g,u),i=h;y<i;++y)b=s[y],r[b]!==n&&(l[b]=o[b],r[b]=n,a.push(b)),o[b]^=m;e.range=t.slice()},wO.incrementOne=function(e,t,n,a){var d=this.value,r=d.curr(),o=e.index(),l=e.bisect(e.range),s=e.bisect(t),f=s[0],c=s[1],p=l[0],u=l[1],g=e.one,h,i,m;if(f<p)for(h=f,i=Zx(p,c);h<i;++h)m=o[h],r[m]^=g,n.push(m);else if(f>p)for(h=p,i=Zx(f,u);h<i;++h)m=o[h],r[m]^=g,a.push(m);if(c>u)for(h=nv(f,u),i=c;h<i;++h)m=o[h],r[m]^=g,n.push(m);else if(c<u)for(h=nv(p,c),i=u;h<i;++h)m=o[h],r[m]^=g,a.push(m);e.range=t.slice()};var SO=ee(mh,jd);SO.transform=function(e,t){var n=~(e.ignore||0),a=e.filter,i=a.mask;if(0===(i&n))return t.StopPropagation;var d=t.fork(t.ALL),r=a.data(),o=a.curr(),l=a.prev(),s=function(e){return o[e]&n?null:r[e]};return d.filter(d.MOD,s),i&i-1?(d.filter(d.ADD,function(e){var t=o[e]&n,a=!t&&t^l[e]&n;return a?r[e]:null}),d.filter(d.REM,function(e){var t=o[e]&n,a=t&&!(t^(t^l[e]&n));return a?r[e]:null})):(d.filter(d.ADD,s),d.filter(d.REM,function(e){return(o[e]&n)===i?r[e]:null})),d.filter(d.SOURCE,function(e){return s(e._index)})};$d({type:'CrossFilter',metadata:{},params:[{name:'fields',type:'field',array:!0,required:!0},{name:'query',type:'array',array:!0,required:!0,content:{type:'number',array:!0,length:2}}]},hh),$d({type:'ResolveFilter',metadata:{},params:[{name:'ignore',type:'number',required:!0,description:'A bit mask indicating which filters to ignore.'},{name:'filter',type:'object',required:!0,description:'Per-tuple filter bitmaps from a CrossFilter transform.'}]},mh);var EO=ee(yh,jd),CO=new gn;EO.transform=function(e,t){var n=e.mark,a=n.marktype,i=zw[a],d=i.bound,r=n.clip,o=n.bounds,l;return n.bounds_prev.clear().union(o),i.nested?(o=bh(n,d),n.items.forEach(function(e){e.bounds_prev.clear().union(e.bounds),e.bounds.clear().union(o)})):'group'===a||e.modified()?(o.clear(),n.items.forEach(function(e){o.union(bh(e,d))})):(l=t.changed(t.REM),t.visit(t.ADD,function(e){o.union(bh(e,d))}),t.visit(t.MOD,function(e){l=l||o.alignsWith(e.bounds),o.union(bh(e,d))}),l&&!r&&(o.clear(),n.items.forEach(function(e){o.union(e.bounds)}))),r&&o.intersect(CO.set(0,0,n.group.width,n.group.height)),t.modifies('bounds')};var zO=ee(_h,jd);zO.transform=function(e,t){var n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,xh(e),e.index),n.group.context=e.context,!e.context.group&&(e.context.group=n.group),n.source=this,this.value=n);var a='group'===n.marktype?yn:mn;return t.visit(t.ADD,function(e){a.call(e,n)}),n.items=t.source,t};var TO=ee(vh,jd);TO.transform=function(e,t){var n=t.dataflow;if(t.changed(t.REM)&&n.enqueue(t.materialize(t.REM).rem),t.changed(t.ADD)&&n.enqueue(t.materialize(t.ADD).add),t.changed(t.MOD)&&n.enqueue(t.materialize(t.MOD).mod),t.fields&&t.fields.zindex){var a=t.source&&t.source[0];a&&(a.mark.zdirty=!0)}};var RO='axis',AO='legend',OO='row-header',PO='row-footer',MO='row-title',DO='column-header',LO='column-footer',qO='column-title',UO='fit',FO='pad',jO='none',$O='axis',NO='title',IO='frame',BO='legend',YO='scope',GO='row-header',WO='row-footer',HO='column-header',XO='column-footer',VO=ee(Ph,jd);VO.transform=function(e,t){var n=t.dataflow;return e.mark.items.forEach(function(t){e.layout&&Rh(n,t,e.layout),Mh(n,t,e)}),t};var JO='default',ZO='view',KO='vega-bind',QO='vega-bind-name',eP='vega-bind-radio',tP='vega-option-',nP='outer',aP=['value','update','react','bind'];bm.prototype.visit=function(e){var t=this,a,d,i;if(e(t))return 1;for(a=_m(t),d=0,i=a.length;d<i;++d)if(a[d].visit(e))return 1};var iP=1,dP=2,rP=3,oP=4,lP=5,sP=6,fP=7,cP=8,pP='ArrayExpression',uP='BinaryExpression',gP='CallExpression',hP='ConditionalExpression',mP='Identifier',yP='Literal',bP='LogicalExpression',_P='MemberExpression',xP='ObjectExpression',vP='Property',kP='UnaryExpression',wP='Unexpected token %0',SP='Unexpected number',EP='Unexpected string',CP='Unexpected identifier',zP='Unexpected reserved word',TP='Unexpected end of input',RP='Invalid regular expression',AP='Invalid regular expression: missing /',OP='Octal literals are not allowed in strict mode.',PP='Duplicate data property in object literal not allowed in strict mode',MP='ILLEGAL',DP='Disabled.',LP=/[--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,qP=/[--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,UP={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1},FP={if:1,this:1},jP={NaN:'NaN',E:'Math.E',LN2:'Math.LN2',LN10:'Math.LN10',LOG2E:'Math.LOG2E',LOG10E:'Math.LOG10E',PI:'Math.PI',SQRT1_2:'Math.SQRT1_2',SQRT2:'Math.SQRT2'},$P=Ry(lC),NP=Ry(fk),IP=Ry(lk),BP=Ry(ck),YP=Ry(sk),GP=new Date(2e3,0,1),WP='undefined'!==typeof window&&window||null,HP='Literal',XP='Identifier',VP='%',JP=':',ZP=Ly('area'),KP=Ly('bounds'),QP=Ly('centroid'),eM={},tM='union',nM='unit',aM='others',iM={isArray:fv,isBoolean:te,isDate:ne,isNumber:ae,isObject:N,isRegExp:ie,isString:I,toBoolean:ce,toDate:pe,toNumber:ue,toString:ge,pad:se,truncate:me,rgb:Kr,lab:oo,hcl:go,hsl:no,sequence:f,format:$P,utcFormat:NP,utcParse:BP,timeFormat:IP,timeParse:YP,monthFormat:function(e){return Ay(e,1,'%B')},monthAbbrevFormat:function(e){return Ay(e,1,'%b')},dayFormat:function(e){return Ay(0,2+e,'%A')},dayAbbrevFormat:function(e){return Ay(0,2+e,'%a')},quarter:function(e){return 1+~~(new Date(e).getMonth()/3)},utcquarter:function(e){return 1+~~(new Date(e).getUTCMonth()/3)},warn:function(){return Oy(this.context.dataflow,'warn',arguments)},info:function(){return Oy(this.context.dataflow,'info',arguments)},debug:function(){return Oy(this.context.dataflow,'debug',arguments)},inScope:function(e){var t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},clampRange:function(e,t,n){var a=e[0],i=e[1],d;return i<a&&(d=i,i=a,a=d),d=i-a,d>=n-t?[t,n]:[Zx(nv(a,t),n-d),Zx(nv(i,d),n)]},pinchDistance:function(){return'Math.sqrt(Math.pow(event.touches[0].clientX - event.touches[1].clientX, 2) + Math.pow(event.touches[0].clientY - event.touches[1].clientY, 2))'},pinchAngle:function(){return'Math.atan2(event.touches[1].clientY - event.touches[0].clientY,event.touches[1].clientX - event.touches[0].clientX)'},open:function(e,t){var n=this.context.dataflow;WP&&WP.open?n.loader().sanitize(e,{context:'open',name:t}).then(function(e){WP.open(e,t)}).catch(function(t){n.warn('Open url failed: '+t)}):n.warn('Open function can only be invoked in a browser.')},screen:function(){return WP?WP.screen:{}},windowsize:function(){return WP?[WP.innerWidth,WP.innerHeight]:[void 0,void 0]},span:function(e){return e[e.length-1]-e[0]||0},bandspace:function(e,t,n){return Br(e||0,t||0,n||0)},inrange:$y,encode:function(e,t,n){if(e){var a=this.context.dataflow,i=e.mark.source;a.pulse(i,a.changeset().encode(e,t))}return n===void 0?e:n},modify:Iy},dM=['view','item','group','xy','x','y'],rM='this.',oM={},lM,sM,fM,cM;Xy('bandwidth',function(e,t){var n=Py(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0},Dy),Xy('copy',function(e,t){var n=Py(e,(t||this).context);return n?n.copy():void 0},Dy),Xy('domain',function(e,t){var n=Py(e,(t||this).context);return n?n.domain():[]},Dy),Xy('range',function(e,t){var n=Py(e,(t||this).context);return n&&n.range?n.range():[]},Dy),Xy('invert',function(e,t,n){var a=Py(e,(n||this).context);return a?fv(t)?(a.invertRange||a.invert)(t):(a.invert||a.invertExtent)(t):void 0},Dy),Xy('scale',function(e,t,n){var a=Py(e,(n||this).context);return a?a(t):void 0},Dy),Xy('gradient',function(e,t,a,d){var r=hn(t,a),o=e.domain(),l=o[0],s=o[o.length-1],f=Jl(e,l,s);e.ticks&&(o=e.ticks(+d||15),l!==o[0]&&o.unshift(l),s!==o[o.length-1]&&o.push(s));for(var c=0,i=o.length;c<i;++c)r.stop(f(o[c]),e(o[c]));return r},Dy),Xy('geoArea',ZP,Dy),Xy('geoBounds',KP,Dy),Xy('geoCentroid',QP,Dy),Xy('indata',function(e,t,n){var a=this.context.data[e]['index:'+t],i=a?a.value.get(n):void 0;return i?i.count:i},function(e,t,n,a){t[0].type!==HP&&F('First argument to indata must be a string literal.'),t[1].type!==HP&&F('Second argument to indata must be a string literal.');var i=t[0].value,d=t[1].value,r='@'+d;a.hasOwnProperty(r)||(a[r]=n.getData(i).indataRef(n,d))}),Xy('data',qy,Uy),Xy('vlPoint',function(e,t,n,a,i){return Gy.call(this,e,t,n,a,i,By)},Uy),Xy('vlInterval',function(e,t,n,a,i){return Gy.call(this,e,t,n,a,i,Yy)},Uy),Xy('vlPointDomain',function(e,t,a,d){for(var r=this.context.data[e],o=r?r.values.value:[],l={},s=0,f={},c=[],p=0,i=o.length,n,u,g,h;p<i;++p)n=o[p],u=n.unit,h=n.values[0],l[u]||(l[u]=++s),(t&&n.encodings[0]===t||a&&n.fields[0]===a)&&(!(g=f[h])&&(f[h]=g={value:h,units:{},count:0}),!g.units[u]&&(g.units[u]=++g.count));for(h in f)(d===tM||(g=f[h]).count===s)&&c.push(g.value);return c.length?c:void 0},Uy),Xy('vlIntervalDomain',function(e,t,a,d){for(var r=d===tM?Wy:Hy,o=this.context.data[e],l=o?o.values.value:[],s=0,i=l.length,n,f,c,p,u,g,h,m;s<i;++s)for(n=l[s].intervals,c=0,f=n.length;c<f;++c)p=n[c],(t&&p.encoding===t||a&&p.field===a)&&(u=p.extent,h=u[0],m=u[1],h>m&&(m=u[1],h=u[0]),g=g?r(g,h,m):[h,m]);return g&&g.length&&+g[0]!==+g[1]?g:void 0},Uy),Xy('treePath',function(e,n,a){var i=jy(e,this),d=i[n],r=i[a];return d&&r?d.path(r).map(Fy):void 0},Uy),Xy('treeAncestors',function(e,t){var a=jy(e,this)[t];return a?a.ancestors().map(Fy):void 0},Uy);var pM={blacklist:['_'],whitelist:['datum','event','item'],fieldvar:'datum',globalvar:function(e){return'_['+Y('$'+e)+']'},functions:function(e){var t=zy(e);for(var n in dM.forEach(function(e){t[e]='event.vega.'+e}),iM)t[n]=rM+n;return t},constants:jP,visitors:oM},uM=Ty(pM),gM='$',hM='view',mM='scope',yM='view',bM='[',_M=']',xM='{',vM='}',kM=':',wM=',',SM='@',EM='>',GT=/[\[\]\{\}]/,CM={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},zM='var datum=event.item&&event.item.datum;',TM=he(['rule']),RM=he(['group','image','rect']),AM='mark',OM='frame',PM='scope',MM='axis',DM='axis-domain',LM='axis-grid',qM='axis-label',UM='axis-tick',FM='axis-title',jM='legend',$M='legend-entry',NM='legend-gradient',IM='legend-label',BM='legend-symbol',YM='legend-title',GM='title',WM={name:1,interactive:1},HM='group',XM='rect',VM='rule',JM='symbol',ZM='text',KM='top',QM='left',eD='right',tD='bottom',nD='index',aD='label',iD='offset',dD='perc',rD='size',oD='total',lD='value',sD=['shape','size','fill','stroke','strokeDash','opacity'],fD='datum.'+dD+'<=0?"left":datum.'+dD+'>=1?"right":"center"',cD=Jb('key'),pD='descending',uD=n_('Aggregate'),gD=n_('AxisTicks'),hD=n_('Bound'),mD=n_('Collect'),yD=n_('Compare'),bD=n_('DataJoin'),_D=n_('Encode'),xD=n_('Facet'),vD=n_('Field'),kD=n_('Key'),wD=n_('LegendEntries'),SD=n_('Mark'),ED=n_('MultiExtent'),CD=n_('MultiValues'),zD=n_('Params'),TD=n_('PreFacet'),RD=n_('Projection'),AD=n_('Proxy'),OD=n_('Relay'),PD=n_('Render'),MD=n_('Scale'),DD=n_('Sieve'),LD=n_('SortItems'),qD=n_('ViewLayout'),UD=n_('Values'),FD,jD;y_.fromEntries=function(e,t){var a=t.length,n=1,i=t[0],d=t[a-1],r=t[a-2],o=null;for(e.add(t[0]);n<a;++n)t[n].params.pulse=Vb(t[n-1]),e.add(t[n]),'Aggregate'===t[n].type&&(o=t[n]);return new y_(e,i,r,d,o)};var $D=y_.prototype;$D.countsRef=function(e,t,n){var i=this,d=i.counts||(i.counts={}),r=b_(t),o,l,s;return null!=r&&(e=i.scope,o=d[r]),o?n&&n.field&&__(e,o.agg.params,n):(s={groupby:e.fieldRef(t,'key'),pulse:Vb(i.output)},n&&n.field&&__(e,s,n),l=e.add(uD(s)),o=e.add(mD({pulse:Vb(l)})),o={agg:l,ref:Vb(o)},null!=r&&(d[r]=o)),o.ref},$D.tuplesRef=function(){return Vb(this.values)},$D.extentRef=function(e,t){return x_(e,this,'extent','Extent',t,!1)},$D.domainRef=function(e,t){return x_(e,this,'domain','Values',t,!1)},$D.valuesRef=function(e,t,n){return x_(e,this,'vals','Values',t,n||!0)},$D.lookupRef=function(e,t){return x_(e,this,'lookup','TupleIndex',t,!1)},$D.indataRef=function(e,t){return x_(e,this,'indata','TupleIndex',t,!0,!0)};var ND=0,ID=['identity','ordinal','band','point','bin-linear','bin-ordinal','linear','pow','sqrt','log','sequential','time','utc','quantize','quantile','threshold'],BD=he(ID),YD=he(ID.slice(1,6)),GD=he(['width','height','padding']),WD=ox.prototype=lx.prototype;WD.fork=function(){return new lx(this)},WD.toRuntime=function(){return this.finish(),{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings}},WD.id=function(){return(this._subid?this._subid+':':0)+this._id++},WD.add=function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(function(t){t.$ref=e.id}),e.refs=null),e},WD.proxy=function(e){var t=e instanceof Wb?Vb(e):e;return this.add(AD({value:t}))},WD.addStream=function(e){return this.streams.push(e),e.id=this.id(),e},WD.addUpdate=function(e){return this.updates.push(e),e},WD.finish=function(){function e(e,t,n){var a,i;e&&(a=e.data||(e.data={}),i=a[t]||(a[t]=[]),i.push(n))}var t,n;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;for(t in this.data)for(var a in n=this.data[t],e(n.input,t,'input'),e(n.output,t,'output'),e(n.values,t,'values'),n.index)e(n.index[a],t,'index:'+a);return this},WD.pushState=function(e,t,n){this._encode.push(Vb(this.add(DD({pulse:e})))),this._parent.push(t),this._lookup.push(n?Vb(this.proxy(n)):null),this._markpath.push(-1)},WD.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},WD.parent=function(){return fe(this._parent)},WD.encode=function(){return fe(this._encode)},WD.lookup=function(){return fe(this._lookup)},WD.markpath=function(){var e=this._markpath;return++e[e.length-1]},WD.fieldRef=function(e,t){if(I(e))return Jb(e,t);e.signal||F('Unsupported field reference: '+Y(e));var n=e.signal,a=this.field[n],i;return a||(i={name:this.signalRef(n)},t&&(i.as=t),this.field[n]=a=Vb(this.add(vD(i)))),a},WD.compareRef=function(e){function t(e){return t_(e)?(a=!0,Vb(n[e.signal])):e}var n=this.signals,a=!1,i=H(e.field).map(t),d=H(e.order).map(t);return a?Vb(this.add(yD({fields:i,orders:d}))):Zb(i,d)},WD.keyRef=function(e){var t=this.signals,n=!1;return e=H(e).map(function(e){return t_(e)?(n=!0,Vb(t[e.signal])):e}),n?Vb(this.add(kD({fields:e}))):Kb(e)},WD.sortRef=function(e){if(!e)return e;var t=[e_(e.op,e.field),'_id'],n=e.order||'ascending';return n.signal?Vb(this.add(yD({fields:t,orders:[n=this.signalRef(n.signal),n]}))):Zb(t,[n,n])},WD.event=function(e,t){var n=e+':'+t;if(!this.events[n]){var a=this.id();this.streams.push({id:a,source:e,type:t}),this.events[n]=a}return this.events[n]},WD.addSignal=function(e,t){this.signals.hasOwnProperty(e)&&F('Duplicate signal name: '+Y(e));var n=t instanceof Wb?t:this.add(Xb(t));return this.signals[e]=n},WD.getSignal=function(e){return this.signals[e]||F('Unrecognized signal name: '+Y(e)),this.signals[e]},WD.signalRef=function(e){return this.signals[e]?Vb(this.signals[e]):(this.lambdas[e]||(this.lambdas[e]=this.add(Xb(null))),Vb(this.lambdas[e]))},WD.parseLambdas=function(){for(var t=Object.keys(this.lambdas),a=0,i=t.length;a<i;++a){var n=t[a],d=Vy(n,this),e=this.lambdas[n];e.params=d.$params,e.update=d.$expr}},WD.property=function(e){return e&&e.signal?this.signalRef(e.signal):e},WD.objectProperty=function(e){return e&&N(e)?this.signalRef(e.signal||sx(e)):e},WD.addBinding=function(e,t){this.bindings||F('Nested signals do not support binding: '+Y(e)),this.bindings.push(Z({signal:e},t))},WD.addScaleProj=function(e,t){this.scales.hasOwnProperty(e)&&F('Duplicate scale or projection name: '+Y(e)),this.scales[e]=this.add(t)},WD.addScale=function(e,t){this.addScaleProj(e,MD(t))},WD.addProjection=function(e,t){this.addScaleProj(e,RD(t))},WD.getScale=function(e){return this.scales[e]||F('Unrecognized scale name: '+Y(e)),this.scales[e]},WD.projectionRef=WD.scaleRef=function(e){return Vb(this.getScale(e))},WD.projectionType=WD.scaleType=function(e){return this.getScale(e).params.type},WD.addData=function(e,t){return this.data.hasOwnProperty(e)&&F('Duplicate data set name: '+Y(e)),this.data[e]=t},WD.getData=function(e){return this.data[e]||F('Undefined data set name: '+Y(e)),this.data[e]},WD.addDataPipeline=function(e,t){return this.data.hasOwnProperty(e)&&F('Duplicate data set name: '+Y(e)),this.addData(e,y_.fromEntries(this,t))};var HD=30,XD=2,VD='#4c78a8',JD='#000',ZD='#888',KD='#ddd',QD=[{key:'$ref',parse:function(e,t){return t.get(e.$ref)||F('Operator not defined: '+e.$ref)}},{key:'$key',parse:function(e,t){var n='k:'+e.$key;return t.fn[n]||(t.fn[n]=de(e.$key))}},{key:'$expr',parse:function(e,t){var n='e:'+e.$expr;return t.fn[n]||(t.fn[n]=L(gx(e.$expr,t),e.$fields,e.$name))}},{key:'$field',parse:function(e,t){var n='f:'+e.$field+'_'+e.$name;return t.fn[n]||(t.fn[n]=$(e.$field,e.$name))}},{key:'$encode',parse:function(e,t){var n=e.$encode,a={},i,d;for(i in n)d=n[i],a[i]=L(yx(d.$expr,t),d.$fields),a[i].output=d.$output;return a}},{key:'$compare',parse:function(e,t){var n='c:'+e.$compare+'_'+e.$order;return t.fn[n]||(t.fn[n]=X(e.$compare,e.$order))}},{key:'$context',parse:function(e,t){return t}},{key:'$subflow',parse:function(e,t){var n=e.$subflow;return function(e,a,i){var d=Ex(n,t.fork()),r=d.get(n.operators[0].id),o=d.signals.parent;return o&&o.set(i),r}}}],eL={skip:!0};zx.prototype=Tx.prototype={fork:function(){var e=new Tx(this);return(this.subcontext||(this.subcontext=[])).push(e),e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,a=n.dataflow,i;if(n.set(e.id,t),'Collect'===e.type&&(i=e.value)&&(i.$ingest?a.ingest(t,i.$ingest,i.$format):i.$request?a.request(t,i.$request,i.$format):a.pulse(t,a.changeset().insert(i))),e.root&&(n.root=t),e.parent){var d=n.get(e.parent.$ref);d?(a.connect(d,[t]),t.targets().add(d)):(n.unresolved=n.unresolved||[]).push(function(){d=n.get(e.parent.$ref),a.connect(d,[t]),t.targets().add(d)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(var r in e.data)i=n.data[r]||(n.data[r]={}),e.data[r].forEach(function(e){i[e]=t})},resolve:function(){return(this.unresolved||[]).forEach(function(e){e()}),delete this.unresolved,this},operator:function(e,t,n){this.add(e,this.dataflow.add(e.value,t,n,e.react))},transform:function(e,t,n){this.add(e,this.dataflow.add(this.transforms[t],n))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,a,i){this.dataflow.on(t,n,a,i,e.options)},getState:function(e){var t=this,n={};if(e.signals){var a=n.signals={};Object.keys(t.signals).forEach(function(n){var i=t.signals[n];e.signals(n,i)&&(a[n]=i.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(function(n){var a=t.data[n];e.data(n,a)&&(i[n]=a.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(function(t){return t.getState(e)})),n},setState:function(e){var t=this,n=t.dataflow,a=e.data,i=e.signals;Object.keys(i||{}).forEach(function(e){n.update(t.signals[e],i[e],eL)}),Object.keys(a||{}).forEach(function(e){n.pulse(t.data[e].input,n.changeset().remove(hv).insert(a[e]))}),(e.subcontext||[]).forEach(function(e,t){var n=n.subcontext[t];n&&n.setState(e)})}};var tL=ee(Mx,Ud);tL.run=function(e){Ud.prototype.run.call(this,e);var t=this._queue;return(this._resize||!t||t.length)&&(this.render(t),this._queue=[]),this},tL.render=function(e){return this._renderer&&(this._resize&&(this._resize=0,Xh(this)),this._renderer.render(this._scenegraph.root,e)),this},tL.enqueue=function(e){this._queue&&e&&e.length&&(this._queue=this._queue.concat(e))},tL.signal=function(e,t,n){var a=Dx(this,e);return 1===arguments.length?a.value:this.update(a,t,n)},tL.scenegraph=function(){return this._scenegraph},tL.background=function(e){return arguments.length?(this._background=e,this._resize=1,this):this._background},tL.width=function(e){return arguments.length?this.signal('width',e):this.signal('width')},tL.height=function(e){return arguments.length?this.signal('height',e):this.signal('height')},tL.padding=function(e){return arguments.length?this.signal('padding',e):this.signal('padding')},tL.renderer=function(e){return arguments.length?(sd(e)||this.error('Unrecognized renderer type: '+e),e!==this._renderType&&(this._renderType=e,this._renderer&&(this._renderer=this._queue=null,this.initialize(this._el))),this):this._renderType},tL.loader=function(e){return arguments.length?(e!==this._loader&&(Ud.prototype.loader.call(this,e),this._renderer&&(this._renderer=this._queue=null,this.initialize(this._el))),this):this._loader},tL.addEventListener=function(e,t){this._handler.on(e,t)},tL.removeEventListener=function(e,t){this._handler.off(e,t)},tL.addSignalListener=function(e,t){var n=Dx(this,e),a=function(){t(e,n.value)};this.on(n,null,(a.handler=t,a))},tL.removeSignalListener=function(e,n){var a=Dx(this,e),i=a._targets||[],t=i.filter(function(e){var t=e._update;return t&&t.handler===n});t.length&&i.remove(t[0])},tL.preventDefault=function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},tL.tooltipHandler=function(e){var t=this._handler;return arguments.length?(t.handleTooltip=e||Li.prototype.handleTooltip,this):t.handleTooltip},tL.events=function(t,e,a){var d=this,r=new Ed(a),o=function(n,e){d.preventDefault()&&t===ZO&&n.preventDefault(),r.receive(Vh(d,n,e)),d.run()},l;if(t===ZO)return d.addEventListener(e,o),r;if(t==='window'?'undefined'!==typeof window&&(l=[window]):'undefined'!==typeof document&&(l=document.querySelectorAll(t)),!l)return d.warn('Can not resolve event source: '+t),r;for(var s=0,i=l.length;s<i;++s)l[s].addEventListener(e,o);return d._eventListeners.push({type:e,sources:l,handler:o}),r},tL.finalize=function(){for(var t=this._eventListeners,a=t.length,n,i;0<=--a;)for(i=t[a],n=i.sources.length;0<=--n;)i.sources[n].removeEventListener(i.type,i.handler)},tL.hover=function(e,t){return this.on(this.events('view','mouseover',Zh),Kh,Qh(e||'hover')),this.on(this.events('view','mouseout',Zh),Kh,Qh(t||'update')),this},tL.autosize=function(e,t,n,a,i,d){this.runAfter(function(r){var o=0;r._autosize=0,r.width()!==n&&(o=1,r.width(n),r._resizeWidth.skip(!0)),r.height()!==a&&(o=1,r.height(a),r._resizeHeight.skip(!0)),r._width!==e&&(r._resize=1,r._width=e),r._height!==t&&(r._resize=1,r._height=t),(r._origin[0]!==i[0]||r._origin[1]!==i[1])&&(r._resize=1,r._origin=i),o&&r.run('enter'),d&&r.runAfter(function(){r._autosize=1})})},tL.data=function(e){return Bh(this,e).values.value},tL.change=Yh,tL.insert=function(e,t){return Yh.call(this,e,vd().insert(t))},tL.remove=function(e,t){return Yh.call(this,e,vd().remove(t))},tL.initialize=function(e,t){var n=this,a=n._renderType,i=sd(a),d,r;return e=n._el=e?cm(n,e):null,i||n.error('Unrecognized renderer type: '+a),d=i.handler||Fi,r=e?i.renderer:i.headless,n._renderer=r?sm(n,n._renderer,e,r):null,n._handler=fm(n,n._handler,e,d),e&&(t=t?cm(n,t):e.appendChild(em('div',{class:'vega-bindings'})),n._bind.forEach(function(e){e.param.element&&cm(n,e.param.element)}),n._bind.forEach(function(e){tm(n,e.param.element||t,e)})),n},tL.toImageURL=function(e){return e!==eS.Canvas&&e!==eS.SVG&&e!==eS.PNG?Promise.reject('Unrecognized image type: '+e):pm(this,e).then(function(t){return e===eS.SVG?um(t.svg(),'image/svg+xml'):t.canvas().toDataURL('image/png')})},tL.toCanvas=function(){return pm(this,eS.Canvas).then(function(e){return e.canvas()})},tL.toSVG=function(){return pm(this,eS.SVG).then(function(e){return e.svg()})},tL.getState=function(e){return this._runtime.getState(e||{data:Ox,signals:Px,recurse:!0})},tL.setState=function(e){var t=this;return t._trigger=!1,t._runtime.setState(e),t.run().runAfter(function(){t._trigger=!0}),this},Id('Bound',yh),Id('Mark',_h),Id('Render',vh),Id('ViewLayout',Ph),e.version='3.0.0-beta.31',e.Dataflow=Ud,e.EventStream=Ed,e.Parameters=kd,e.Pulse=Rd,e.MultiPulse=Md,e.Operator=wd,e.Transform=jd,e.changeset=vd,e.ingest=md,e.register=$d,e.definition=Nd,e.definitions=RS,e.transform=Id,e.transforms=TS,e.tupleid=gd,e.scale=Bl,e.scheme=Xl,e.interpolate=Kl,e.interpolateRange=Vl,e.projection=Ec,e.View=Mx,e.parse=function(e,t){return rx(e,new ox(fx(t||e.config))).toRuntime()},e.expressionFunction=Xy,e.formatLocale=fl,e.timeFormatLocale=cn,e.runtime=Ex,e.runtimeContext=Cx,e.bin=t,e.bootstrapCI=S,e.randomInteger=function(e,t){null==t&&(t=e,e=0);var n={},i,a,r;return n.min=function(e){return arguments.length?(i=e||0,r=a-i,n):i},n.max=function(e){return arguments.length?(a=e||0,r=a-i,n):a},n.sample=function(){return i+Kx(r*Math.random())},n.pdf=function(e){return e===Kx(e)&&e>=i&&e<a?1/r:0},n.cdf=function(e){var t=Kx(e);return t<i?0:t>=a?1:(t-i+1)/r},n.icdf=function(e){return 0<=e&&1>=e?i-1+Kx(e*r):NaN},n.min(e).max(t)},e.randomKDE=R,e.randomMixture=P,e.randomNormal=z,e.randomUniform=M,e.quartiles=T,e.accessor=L,e.accessorName=q,e.accessorFields=U,e.id=pv,e.identity=id,e.zero=uv,e.one=gv,e.truthy=hv,e.falsy=mv,e.logger=W,e.None=yv,e.Warn=bv,e.Info=_v,e.Debug=xv,e.array=H,e.compare=X,e.constant=J,e.error=F,e.extend=Z,e.extentIndex=K,e.fastmap=Q,e.field=$,e.inherits=ee,e.isArray=fv,e.isBoolean=te,e.isDate=ne,e.isFunction=V,e.isNumber=ae,e.isObject=N,e.isRegExp=ie,e.isString=I,e.key=de,e.merge=oe,e.pad=se,e.peek=fe,e.repeat=le,e.splitAccessPath=j,e.stringValue=Y,e.toBoolean=ce,e.toDate=pe,e.toNumber=ue,e.toString=ge,e.toSet=he,e.truncate=me,e.visitArray=ye,e.loader=Ue,e.read=pn,e.inferType=Ge,e.inferTypes=We,e.typeParsers=Av,e.formats=st,e.Bounds=gn,e.Gradient=hn,e.GroupItem=yn,e.ResourceLoader=Sn,e.Item=mn,e.Scenegraph=Mi,e.Handler=Li,e.Renderer=qi,e.CanvasHandler=Fi,e.CanvasRenderer=Bi,e.SVGHandler=Wi,e.SVGRenderer=Ji,e.SVGStringRenderer=dd,e.RenderType=eS,e.renderModule=sd,e.Marks=zw,e.boundContext=Na,e.boundStroke=$a,e.boundItem=Ti,e.boundMark=Ri,e.pathCurves=xa,e.pathSymbols=za,e.pathRectangle=Da,e.pathTrail=La,e.pathParse=va,e.pathRender=Ea,e.point=Ui,e.canvas=wn,e.domCreate=bn,e.domFind=_n,e.domChild=xn,e.domClear=vn,e.openTag=Xi,e.closeTag=Vi,e.font=Ei,e.textMetrics=xw,e.sceneEqual=fd,e.pathEqual=cd,e.sceneToJSON=Ai,e.sceneFromJSON=Oi,e.sceneZOrder=Va,e.sceneVisit=Ja,e.scenePickVisit=Za,Object.defineProperty(e,'__esModule',{value:!0})});