<html><head><link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../polymer/lib/utils/debounce.html">
<link rel="import" href="../polymer/lib/utils/flattened-nodes-observer.html">

<script src="./node_modules/monaco-editor/min/vs/loader.js"></script>

</head><body><dom-module id="monaco-editor">
<template>
  <style>:host{display:block;width:320px;height:200px;}#hidden{display:none;}</style>
  <div id="hidden">
    <slot id="codes" name="monaco-value"></slot>
  </div>
  <slot></slot>
</template>

<script>class MonacoEditor extends Polymer.Element{static get is(){return'monaco-editor'}static get properties(){return{folding:{type:Boolean,value:!1},wordWrap:{type:String,value:'off'},wordWrapColumn:{type:Number,value:80},wrappingIndent:{type:String,value:'same'},renderLineHighlight:{type:String,value:'gutter'},minimap:{type:Boolean,value:!1},readOnly:{type:Boolean,value:!1},ariaLabel:{type:String,value:'textarea'},autoIndent:{type:Boolean,value:!1},language:{type:String,value:'javascript'},value:{type:String,notify:!0,observer:'_valueChanged'},theme:{type:String,value:'vs'},fontFamily:{type:String,value:'monospace'},fontSize:{type:Number,value:14},lineHeight:{type:Number,value:20},lineNumbers:{type:String,value:'on'},fontWeight:{type:String,value:'normal'},parameterHints:{type:Boolean,value:!1},snippetSuggestions:{type:String,value:'bottom'},options:{type:Object,value:function(){return{acceptSuggestionOnCommitCharacter:!0,acceptSuggestionOnEnter:'on',accessibilityHelpUrl:'https://go.microsoft.com/fwlink/?linkid=852450',accessibilitySupport:'auto',autoClosingBrackets:!0,automaticLayout:!1,codeLens:!0,contextmenu:!0,cursorBlinking:'blink',cursorStyle:'line',disableLayerHinting:!1,disableMonospaceOptimizations:!1,dragAndDrop:!1,emptySelectionClipboard:!1,fixedOverflowWidgets:!1,fontLigatures:!1,formatOnPaste:!1,formatOnType:!1,glyphMargin:!0,hideCursorInOverviewRuler:!1,hover:!0,iconsInSuggestions:!0,lineDecorationsWidth:10,lineNumbersMinChars:5,links:!0,matchBrackets:!0,mouseWheelScrollSensitivity:1,mouseWheelZoom:!1,multiCursorModifier:'alt',occurrencesHighlight:!0,overviewRulerBorder:!0,overviewRulerLanes:2,quickSuggestions:!0,quickSuggestionsDelay:500,renderControlCharacters:!1,renderIndentGuides:!1,renderLineHighlight:'all',renderWhitespace:'none',revealHorizontalRightPadding:30,roundedSelection:!0,rulers:[],scrollBeyondLastLine:!0,selectOnLineNumbers:!0,selectionClipboard:!0,selectionHighlight:!0,showFoldingControls:'mouseover',stopRenderingLineAfter:1e4,suggestOnTriggerCharacters:!0,wordBasedSuggestions:!0}}},jsonSchemas:{type:Array,value:function(){return[]}},jsonAllowComments:{type:Boolean,value:!1},jsonValidate:{type:Boolean,value:!1},editor:{type:Object,readOnly:!0,notify:!0},monaco:{type:Object,readOnly:!0,notify:!0},_incomingValue:{type:Boolean},_syncValue:{type:Boolean},_observer:{type:Object},_syncSchemaListener:{type:Function},_disposables:{type:Array,value:function(){return[]}}}}static get observers(){return['_init(monaco)','setTheme(theme,monaco)','setModelLanguage(language,monaco)','_updateDiagnosticsOptions(monaco,language,jsonValidate,jsonAllowComments,jsonSchemas)','_optionsChanged(editor,options,readOnly,autoIndent,minimap,renderLineHighlight,wordWrap,wordWrapColumn,wrappingIndent,fontFamily,fontSize,fontWeight,lineHeight,parameterHints,lineNumbers,snippetSuggestions,folding)']}ready(){super.ready(),require.config({paths:{vs:this.resolveUrl('./node_modules/monaco-editor/min/vs')}}),require(['vs/editor/editor.main'],()=>{this._setMonaco(monaco)})}connectedCallback(){super.connectedCallback();var a=this.$.codes.assignedNodes().map((a)=>a.textContent).join('\n');0<a.length&&this.set('value',a),this._syncSchemaListener=this._syncSchema.bind(this),this.addEventListener('mouseenter',this._syncSchemaListener),this._init()}disconnectedCallback(){super.disconnectedCallback(),this.editor&&(this.editor.dispose(),this._setEditor(null)),Array.isArray(this._disposables)&&(this._disposables.forEach((a)=>a.dispose()),this._disposables=[]),this._syncSchemaListener&&this.removeEventListener(this._syncSchemaListener)}setTheme(a){return this.monaco&&a&&this.monaco.editor.setTheme(a),this}setModelLanguage(a){return this.monaco&&this.editor&&a&&this.monaco.editor.setModelLanguage(this.editor.getModel(),a),this}_valueChanged(a){return this._syncValue?this.set('_syncValue',!1):void(this.set('_incomingValue',!0),this.editor&&this.editor.getModel().setValue(a),this.dispatchEvent(new CustomEvent('value-changed',{detail:{value:a}})))}_getOptions(a={}){return Object.assign({},{folding:this.folding,snippetSuggestions:this.snippetSuggestions,fontSize:this.fontSize,fontFamily:this.fontFamily,fontWeight:this.fontWeight,lineHeight:this.lineHeight,lineNumbers:this.lineNumbers,parameterHints:this.parameterHints,ariaLabel:this.ariaLabel,wordWrap:this.wordWrap,wordWrapColumn:this.wordWrapColumn,wrappingIndent:this.wrappingIndent,renderLineHighlight:this.renderLineHighlight,minimap:{enabled:this.minimap},readOnly:this.readOnly,autoIndent:this.autoIndent},this.options,a)}_optionsChanged(){this.editor&&this.editor.updateOptions(this._getOptions())}_updateDiagnosticsOptions(){this.monaco&&('json'!==this.language||monaco.languages.json.jsonDefaults.setDiagnosticsOptions({validate:this.jsonValidate,allowComments:this.jsonAllowComments,schemas:this.jsonSchemas}))}_arrayEqual(a,b){return a&&b&&a.length==b.length&&a.every((a,c)=>a===b[c])}_syncSchema(){this.monaco&&this.jsonSchemas&&(this._arrayEqual(this.monaco.languages.json.jsonDefaults.diagnosticsOptions.schemas,this.jsonSchemas)||this._updateDiagnosticsOptions())}_init(){if(this.monaco&&!this.editor){var a={value:this.value,language:this.language},b=this.monaco.editor.create(this,this._getOptions(a)),c=b.onDidFocusEditor(()=>{this._syncSchema()});this._disposables.push(c);var d=b.getModel();d.onDidChangeContent(()=>{this._incomingValue?this.set('_incomingValue',!1):(this.set('_syncValue',!0),this.set('value',d.getValue()))}),this._setEditor(b),this.dispatchEvent(new CustomEvent('monaco-ready'))}}}window.customElements.define(MonacoEditor.is,MonacoEditor);</script>
</dom-module>
</body></html>